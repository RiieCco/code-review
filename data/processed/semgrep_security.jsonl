{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eqeq-is-bad\nPattern:\n$X == $X", "output": "Vulnerability rule: eqeq-is-bad\nMessage: $X == $X is a useless equality check\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: template.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: deprecated-pervasives\nPattern:\nPervasives.$X", "output": "Vulnerability rule: deprecated-pervasives\nMessage: Pervasives is deprecated and will not be available after 4.10. Use Stdlib.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/compatibility/deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-marshal\nPattern:\ninput_value", "output": "Vulnerability rule: ocamllint-marshal\nMessage: Marshaling is currently not type-safe and can lead to insecure behaviour when untrusted data is marshalled. Marshalling can lead to out-of-bound reads as well.\nSeverity: WARNING\nCWE: CWE-502: Deserialization of Untrusted Data\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-marshal\nPattern:\nMarshal.from_channel", "output": "Vulnerability rule: ocamllint-marshal\nMessage: Marshaling is currently not type-safe and can lead to insecure behaviour when untrusted data is marshalled. Marshalling can lead to out-of-bound reads as well.\nSeverity: WARNING\nCWE: CWE-502: Deserialization of Untrusted Data\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-marshal\nPattern:\nMarshal.from_bytes", "output": "Vulnerability rule: ocamllint-marshal\nMessage: Marshaling is currently not type-safe and can lead to insecure behaviour when untrusted data is marshalled. Marshalling can lead to out-of-bound reads as well.\nSeverity: WARNING\nCWE: CWE-502: Deserialization of Untrusted Data\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-marshal\nPattern:\nMarshal.from_string", "output": "Vulnerability rule: ocamllint-marshal\nMessage: Marshaling is currently not type-safe and can lead to insecure behaviour when untrusted data is marshalled. Marshalling can lead to out-of-bound reads as well.\nSeverity: WARNING\nCWE: CWE-502: Deserialization of Untrusted Data\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_get", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_to_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_of_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_blit", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_blit_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_fill", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_to_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_getenv", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_environment", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_chr", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_of_int", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_output", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_output_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_read", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_recv", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_recvfrom", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_send", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_sendto", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_int16", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_int32", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_int64", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_int8", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_uint16_ne", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_set_uint8", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_single_write", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_string", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_sub", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-unsafe\nPattern:\n$X.unsafe_write", "output": "Vulnerability rule: ocamllint-unsafe\nMessage: Unsafe functions do not perform boundary checks or have other side effects, use with care.\nSeverity: WARNING\nCWE: CWE-242: Use of Inherently Dangerous Function (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-tempfile\nPattern:\nFilename.temp_file", "output": "Vulnerability rule: ocamllint-tempfile\nMessage: Filename.temp_file might lead to race conditions, since the file could be altered or replaced by a symlink before being opened.\nSeverity: WARNING\nCWE: CWE-367: Time-of-check Time-of-use (TOCTOU) Race Condition\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/tempfile.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-hashtable-dos\nPattern:\nHashtbl.create $Y", "output": "Vulnerability rule: ocamllint-hashtable-dos\nMessage: Creating a Hashtbl without the optional random number parameter makes it prone to DoS attacks when attackers are able to fill the table with malicious content. Hashtbl.randomize or the R flag in the OCAMLRUNPARAM are other ways to randomize it.\nSeverity: WARNING\nCWE: CWE-399: Resource Management Errors (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/hashtable-dos.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-filenameconcat\nPattern:\nFilename.concat", "output": "Vulnerability rule: ocamllint-filenameconcat\nMessage: When attacker supplied data is passed to Filename.concat directory traversal attacks might be possible.\nSeverity: WARNING\nCWE: CWE-35: Path Traversal\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/filenameconcat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.string", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.bytes", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.substring", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.subbytes", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.channel", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-digest\nPattern:\nDigest.file", "output": "Vulnerability rule: ocamllint-digest\nMessage: Digest uses MD5 and should not be used for security purposes. Consider using SHA256 instead.\nSeverity: WARNING\nCWE: CWE-328: Use of Weak Hash (4.12)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/security/digest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: broken-input-line\nPattern:\ninput_line\n", "output": "Vulnerability rule: broken-input-line\nMessage: 'input_line' leaves a '\\r' (CR) character when reading lines from a Windows text file, whose lines end in \"\\r\\n\" (CRLF). This is a problem for any Windows file that is being read either on a Unix-like platform or on Windows in binary mode. If the code already takes care of removing any trailing '\\r' after reading the line, add a '(* nosemgrep *)' comment to disable this warning.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/portability/crlf-support.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: prefer-read-in-binary-mode\nPattern:\nopen_in", "output": "Vulnerability rule: prefer-read-in-binary-mode\nMessage: 'open_in' behaves differently on Windows and on Unix-like systems with respect to line endings. To get the same behavior everywhere, use 'open_in_bin' or 'open_in_gen [Open_binary]'. If you really want CRLF-to-LF translations to take place when running on Windows, use 'open_in_gen [Open_text]'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/portability/crlf-support.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: prefer-write-in-binary-mode\nPattern:\nopen_out", "output": "Vulnerability rule: prefer-write-in-binary-mode\nMessage: 'open_out' behaves differently on Windows and on Unix-like systems with respect to line endings. To get the same behavior everywhere, use 'open_out_bin' or 'open_out_gen [Open_binary]'. If you really want LF-to-CRLF translations to take place when running on Windows, use 'open_out_gen [Open_text]'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/portability/crlf-support.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: not-portable-tmp-string\nPattern:\n\"=~/\\/tmp/\"\n", "output": "Vulnerability rule: not-portable-tmp-string\nMessage: You should probably use Filename.get_temp_dirname().\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/portability/slash-tmp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: useless-let\nPattern:\nlet $X = $E in $X", "output": "Vulnerability rule: useless-let\nMessage: Useless let\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/correctness/useless-let.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: useless-equal\nPattern:\n$X = $X", "output": "Vulnerability rule: useless-equal\nMessage: This is always true. If testing for floating point NaN, use `Float.is_nan` instead.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/correctness/useless-eq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-useless-if\nPattern:\nif $X then $E else $E", "output": "Vulnerability rule: ocamllint-useless-if\nMessage: Useless if. Both branches are equal.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/correctness/useless-if.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: physical-equal\nPattern:\n$X == $Y", "output": "Vulnerability rule: physical-equal\nMessage: You probably want the structural equality operator =\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/correctness/physical-vs-structural.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: physical-not-equal\nPattern:\n$X != $Y", "output": "Vulnerability rule: physical-not-equal\nMessage: You probably want the structural inequality operator <>\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/correctness/physical-vs-structural.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-length-list-zero\nPattern:\nList.length $X = 0", "output": "Vulnerability rule: ocamllint-length-list-zero\nMessage: You probably want $X = [], which is faster.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/performance/list.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-length-more-than-zero\nPattern:\nList.length $X > 0", "output": "Vulnerability rule: ocamllint-length-more-than-zero\nMessage: You probably want $X <> [], which is faster.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/performance/list.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-true\nPattern:\n$X = true", "output": "Vulnerability rule: ocamllint-bool-true\nMessage: Comparison to boolean. Just use `$X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-true\nPattern:\n$X == true", "output": "Vulnerability rule: ocamllint-bool-true\nMessage: Comparison to boolean. Just use `$X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-true\nPattern:\n$X != false", "output": "Vulnerability rule: ocamllint-bool-true\nMessage: Comparison to boolean. Just use `$X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-false\nPattern:\n$X = false", "output": "Vulnerability rule: ocamllint-bool-false\nMessage: Comparison to boolean. Just use `not $X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-false\nPattern:\n$X == false", "output": "Vulnerability rule: ocamllint-bool-false\nMessage: Comparison to boolean. Just use `not $X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-bool-false\nPattern:\n$X <> true", "output": "Vulnerability rule: ocamllint-bool-false\nMessage: Comparison to boolean. Just use `not $X`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/bool.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-useless-else\nPattern:\nif $E then $E1 else ()", "output": "Vulnerability rule: ocamllint-useless-else\nMessage: Useless else. Just remove the else branch;\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/ifs.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-backwards-if\nPattern:\nif $E then () else $E2", "output": "Vulnerability rule: ocamllint-backwards-if\nMessage: Backwards if. Rewrite the code as 'if not $E then $E2'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/ifs.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: hashtbl-find-outside-try\nPattern:\nHashtbl.find ...\n", "output": "Vulnerability rule: hashtbl-find-outside-try\nMessage: 'Hashtbl.find' raises the 'Not_found' exception. Handle the exception or use 'Hashtbl.find_opt' instead. If you have proof that the key exists in the table, use 'assert false' as the exception handler to demonstrate awareness of the issue. If your code uses the syntax 'match Hashtbl.find ... with exception Not_found -> ...', it's fine and we apologize for not detecting it. Consider using 'Hashtbl.find_opt' to please Semgrep and stay safe.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/hashtbl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: list-find-outside-try\nPattern:\nList.find ...\n", "output": "Vulnerability rule: list-find-outside-try\nMessage: You should not use List.find outside of a try, or you should use List.find_opt\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/list.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-str-first-chars\nPattern:\nString.sub $S 0 $N", "output": "Vulnerability rule: ocamllint-str-first-chars\nMessage: Use instead `Str.first_chars`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-str-string-after\nPattern:\nString.sub $S $N (String.length $S - $N)", "output": "Vulnerability rule: ocamllint-str-string-after\nMessage: Use instead `Str.string_after`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-str-last-chars\nPattern:\nString.sub $S (String.length $S - $N) $N", "output": "Vulnerability rule: ocamllint-str-last-chars\nMessage: Use instead `Str.last_chars`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-useless-sprintf\nPattern:\nPrintf.sprintf \"...\"", "output": "Vulnerability rule: ocamllint-useless-sprintf\nMessage: Useless sprintf\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-useless-sprintf\nPattern:\nPrintf.sprintf \"%s\" $S", "output": "Vulnerability rule: ocamllint-useless-sprintf\nMessage: Useless sprintf\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-ref-incr\nPattern:\n$X := ! $X + 1", "output": "Vulnerability rule: ocamllint-ref-incr\nMessage: You should use `incr`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/ref.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: ocamllint-ref-decr\nPattern:\n$X := ! $X - 1", "output": "Vulnerability rule: ocamllint-ref-decr\nMessage: You should use `decr`\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/ref.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ocaml\nSemgrep rule id: bad-reraise\nPattern:\nraise $EXN\n", "output": "Vulnerability rule: bad-reraise\nMessage: You should not re-raise exceptions using 'raise' because it loses track of where the exception was raised originally, leading to a useless and possibly confusing stack trace. Instead, you should obtain a stack backtrace as soon as the exception is caught using 'try ... with exn -> let trace = Printexc.get_raw_backtrace () in ...', and keep it around until you re-raise the exception using 'Printexc.raise_with_backtrace exn trace'. You must collect the stack backtrace before calling another function which might internally raise and catch exceptions. To avoid false positives from Semgrep, write 'raise (Foo args)' instead of 'let e = Foo args in raise e'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ocaml/lang/best-practice/exception.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mariadb-public-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mariadb-public-access-disabled\nMessage: Ensure public network access enabled is set to False for MariaDB servers\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-mariadb-public-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-dataexplorer-uses-disk-encryption\nPattern:\nresource", "output": "Vulnerability rule: azure-dataexplorer-uses-disk-encryption\nMessage: Ensure that Azure Data Explorer uses disk encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-dataexplorer-uses-disk-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-sqlserver-no-public-access\nPattern:\nresource", "output": "Vulnerability rule: azure-sqlserver-no-public-access\nMessage: Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-sqlserver-no-public-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-scale-set-password\nPattern:\nresource", "output": "Vulnerability rule: azure-scale-set-password\nMessage: Ensure that Virtual machine does not enable password authentication\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-scale-set-password.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-cosmosdb-accounts-restricted-access\nPattern:\nresource", "output": "Vulnerability rule: azure-cosmosdb-accounts-restricted-access\nMessage: Ensure Cosmos DB accounts have restricted access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-cosmosdb-accounts-restricted-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-iot-no-public-network-access\nPattern:\nresource", "output": "Vulnerability rule: azure-iot-no-public-network-access\nMessage: Ensure that Azure IoT Hub disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-iot-no-public-network-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-functionapp-disallow-cors\nPattern:\n[\"*\"]\n", "output": "Vulnerability rule: azure-functionapp-disallow-cors\nMessage: ensure that CORS disallows all resources to access Function app\nSeverity: WARNING\nCWE: ['CWE-942: Permissive Cross-domain Policy with Untrusted Domains']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-functionapp-disallow-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-managed-disk-encryption\nPattern:\nresource", "output": "Vulnerability rule: azure-managed-disk-encryption\nMessage: Ensure Azure managed disk has encryption enabled\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-managed-disk-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-containergroup-deployed-into-virtualnetwork\nPattern:\nresource", "output": "Vulnerability rule: azure-containergroup-deployed-into-virtualnetwork\nMessage: Ensure that Azure Container group is deployed into virtual network\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-containergroup-deployed-into-virtualnetwork.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-storage-blob-service-container-private-access\nPattern:\nresource", "output": "Vulnerability rule: azure-storage-blob-service-container-private-access\nMessage: Ensure that Public access level is set to Private for blob containers\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-storage-blob-service-container-private-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mysql-encryption-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mysql-encryption-enabled\nMessage: Ensure that MySQL server enables infrastructure encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-mysql-encryption-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-network-watcher-flowlog-period\nPattern:\nresource", "output": "Vulnerability rule: azure-network-watcher-flowlog-period\nMessage: Ensure that Network Security Group Flow Log retention period is 90 days or greater\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-network-watcher-flowlog-period.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-storage-sync-public-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-storage-sync-public-access-disabled\nMessage: Ensure that Azure File Sync disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-storage-sync-public-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-functionapps-enable-auth\nPattern:\nresource", "output": "Vulnerability rule: azure-functionapps-enable-auth\nMessage: Ensure that function apps enables Authentication\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-functionapps-enable-auth.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-encryption-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-encryption-enabled\nMessage: Ensure that PostgreSQL server enables infrastructure encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-postgresql-encryption-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-managed-disk-encryption-set\nPattern:\nresource", "output": "Vulnerability rule: azure-managed-disk-encryption-set\nMessage: Ensure that managed disks use a specific set of disk encryption sets for the customer-managed key encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-managed-disk-encryption-set.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-redis-cache-enable-non-ssl-port\nPattern:\nresource", "output": "Vulnerability rule: azure-redis-cache-enable-non-ssl-port\nMessage: Ensure that only SSL are enabled for Cache for Redis\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-redis-cache-enable-non-ssl-port.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-storage-account-disable-public-access\nPattern:\nresource", "output": "Vulnerability rule: azure-storage-account-disable-public-access\nMessage: Ensure default network access rule for Storage Accounts is set to deny\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-storage-account-disable-public-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-redis-cache-public-network-access-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-redis-cache-public-network-access-enabled\nMessage: Ensure that Azure Cache for Redis disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-redis-cache-public-network-access-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-cosmosdb-have-cmk\nPattern:\nresource", "output": "Vulnerability rule: azure-cosmosdb-have-cmk\nMessage: Ensure that Cosmos DB accounts have customer-managed keys to encrypt data at rest\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-cosmosdb-have-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-cosmosdb-disables-public-network\nPattern:\nresource", "output": "Vulnerability rule: azure-cosmosdb-disables-public-network\nMessage: Ensure that Azure Cosmos DB disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-cosmosdb-disables-public-network.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mysql-public-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mysql-public-access-disabled\nMessage: Ensure public network access enabled is set to False for MySQL servers\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-mysql-public-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-batchaccount-uses-keyvault-encrpytion\nPattern:\nresource", "output": "Vulnerability rule: azure-batchaccount-uses-keyvault-encrpytion\nMessage: Ensure that Azure Batch account uses key vault to encrypt data\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-batchaccount-uses-keyvault-encrpytion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-server-public-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-server-public-access-disabled\nMessage: Ensure public network access enabled is set to False for PostgreSQL servers\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-postgresql-server-public-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-key-no-expiration-date\nPattern:\nresource", "output": "Vulnerability rule: azure-key-no-expiration-date\nMessage: Ensure that the expiration date is set on all keys\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-key-no-expiration-date.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-cognitiveservices-disables-public-network\nPattern:\nresource", "output": "Vulnerability rule: azure-cognitiveservices-disables-public-network\nMessage: Ensure that Cognitive Services accounts disable public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-cognitiveservices-disables-public-network.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-sqlserver-public-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-sqlserver-public-access-disabled\nMessage: Ensure that SQL server disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-sqlserver-public-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-instance-extensions\nPattern:\nresource", "output": "Vulnerability rule: azure-instance-extensions\nMessage: Ensure Virtual Machine Extensions are not Installed\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-instance-extensions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-datalake-store-encryption\nPattern:\nresource", "output": "Vulnerability rule: azure-datalake-store-encryption\nMessage: Ensure that Data Lake Store accounts enables encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-datalake-store-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-customrole-definition-subscription-owner\nPattern:\n[\"*\"]\n", "output": "Vulnerability rule: azure-customrole-definition-subscription-owner\nMessage: Ensure that no custom subscription owner roles are created\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-customrole-definition-subscription-owner.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-key-backedby-hsm\nPattern:\nresource", "output": "Vulnerability rule: azure-key-backedby-hsm\nMessage: Ensure that key vault key is backed by HSM\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-key-backedby-hsm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-datafactory-uses-git-repository\nPattern:\nresource", "output": "Vulnerability rule: azure-datafactory-uses-git-repository\nMessage: Ensure that Azure Data Factory uses Git repository for source control\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-datafactory-uses-git-repository.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-remote-debugging-not-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-remote-debugging-not-enabled\nMessage: Ensure that remote debugging is not enabled for app services\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-remote-debugging-not-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-dataexplorer-double-encryption-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-dataexplorer-double-encryption-enabled\nMessage: Ensure that Azure Data Explorer uses double encryption\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-dataexplorer-double-encryption-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-vmencryption-at-host-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-vmencryption-at-host-enabled\nMessage: Ensure that Virtual machine scale sets have encryption at host enabled\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-vmencryption-at-host-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-service-fabric-cluster-protection-level\nPattern:\nresource", "output": "Vulnerability rule: azure-service-fabric-cluster-protection-level\nMessage: Ensure that Service Fabric use three levels of protection available\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-service-fabric-cluster-protection-level.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-storage-account-minimum-tlsversion\nPattern:\nresource", "output": "Vulnerability rule: azure-storage-account-minimum-tlsversion\nMessage: Ensure Storage Account is using the latest version of TLS encryption\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-storage-account-minimum-tlsversion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-cosmosdb-disable-access-key-write\nPattern:\nresource", "output": "Vulnerability rule: azure-cosmosdb-disable-access-key-write\nMessage: Ensure that Cosmos DB accounts have access key write capability disabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-cosmosdb-disable-access-key-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-monitor-log-profile-retention-days\nPattern:\nresource", "output": "Vulnerability rule: azure-monitor-log-profile-retention-days\nMessage: Ensure that Activity Log Retention is set 365 days or greater\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-monitor-log-profile-retention-days.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-eventgrid-domain-network-access\nPattern:\nresource", "output": "Vulnerability rule: azure-eventgrid-domain-network-access\nMessage: Ensure that Azure Event Grid Domain public network access is disabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-eventgrid-domain-network-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-search-publicnetwork-access-disabled\nPattern:\nresource", "output": "Vulnerability rule: azure-search-publicnetwork-access-disabled\nMessage: Ensure that Azure Cognitive Search disables public network access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-search-publicnetwork-access-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-datafactory-no-public-network-access\nPattern:\nresource", "output": "Vulnerability rule: azure-datafactory-no-public-network-access\nMessage: Ensure that Azure Data factory public network access is disabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/azure-datafactory-no-public-network-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: keyvault-ensure-secret-expires\nPattern:\nresource", "output": "Vulnerability rule: keyvault-ensure-secret-expires\nMessage: Ensure that the expiration date is set on all secrets\nSeverity: INFO\nCWE: ['CWE-262: Not Using Password Aging']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/keyvault/keyvault-ensure-secret-expires.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: keyvault-content-type-for-secret\nPattern:\nresource", "output": "Vulnerability rule: keyvault-content-type-for-secret\nMessage: Key vault Secret should have a content type set\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/keyvault/keyvault-content-type-for-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: keyvault-purge-enabled\nPattern:\nresource", "output": "Vulnerability rule: keyvault-purge-enabled\nMessage: Key vault should have purge protection enabled\nSeverity: WARNING\nCWE: ['CWE-693: Protection Mechanism Failure']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/keyvault/keyvault-purge-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: keyvault-specify-network-acl\nPattern:\nresource", "output": "Vulnerability rule: keyvault-specify-network-acl\nMessage: Network ACLs allow you to reduce your exposure to risk by limiting what can access your key vault. The default action of the Network ACL should be set to deny for when IPs are not matched. Azure services can be allowed to bypass.\nSeverity: ERROR\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/keyvault/keyvault-specify-network-acl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: keyvault-ensure-key-expires\nPattern:\nresource", "output": "Vulnerability rule: keyvault-ensure-key-expires\nMessage: Ensure that the expiration date is set on all keys\nSeverity: INFO\nCWE: ['CWE-262: Not Using Password Aging']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/keyvault/keyvault-ensure-key-expires.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-http-logging-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-http-logging-enabled\nMessage: Ensure that App service enables HTTP logging\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A10:2017 - Insufficient Logging & Monitoring', 'A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-http-logging-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-client-certificate\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-client-certificate\nMessage: Ensure the web app has Client Certificates\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-client-certificate.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-use-secure-tls-policy\nPattern:\nmin_tls_version = $ANYTHING", "output": "Vulnerability rule: appservice-use-secure-tls-policy\nMessage: Detected an AppService that was not configured to use TLS 1.2. Add `site_config.min_tls_version = \"1.2\"` in your resource block.\nSeverity: ERROR\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-use-secure-tls-policy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-identityprovider-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-identityprovider-enabled\nMessage: Ensure that Managed identity provider is enabled for app services\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-identityprovider-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-enabled-failed-request\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-enabled-failed-request\nMessage: Ensure that App service enables failed request tracing\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A10:2017 - Insufficient Logging & Monitoring', 'A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-enabled-failed-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-enable-http2\nPattern:\nresource", "output": "Vulnerability rule: appservice-enable-http2\nMessage: Use the latest version of HTTP to ensure you are benefiting from security fixes. Add `http2_enabled = true` to your appservice resource block\nSeverity: INFO\nCWE: [\"CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')\"]\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-enable-http2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-https-only\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-https-only\nMessage: Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service Slot\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-https-only.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-require-client-cert\nPattern:\nresource", "output": "Vulnerability rule: appservice-require-client-cert\nMessage: Detected an AppService that was not configured to use a client certificate. Add `client_cert_enabled = true` in your resource block.\nSeverity: INFO\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-require-client-cert.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-auth\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-auth\nMessage: Ensure App Service Authentication is set on Azure App Service\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-auth.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-enable-https-only\nPattern:\nresource", "output": "Vulnerability rule: appservice-enable-https-only\nMessage: By default, clients can connect to App Service by using both HTTP or HTTPS. HTTP should be disabled enabling the HTTPS Only setting.\nSeverity: ERROR\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-enable-https-only.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-account-identity-registered\nPattern:\nresource", "output": "Vulnerability rule: appservice-account-identity-registered\nMessage: Registering the identity used by an App with AD allows it to interact with other services without using username and password. Set the `identity` block in your appservice.\nSeverity: INFO\nCWE: ['CWE-287: Improper Authentication']\nOWASP: ['A02:2017 - Broken Authentication', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-account-identity-registered.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-identity\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-identity\nMessage: Ensure App Service Authentication is set on Azure App Service\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-identity.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-detailed-errormessages-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-detailed-errormessages-enabled\nMessage: Ensure that App service enables detailed error messages\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A10:2017 - Insufficient Logging & Monitoring', 'A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-detailed-errormessages-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: appservice-authentication-enabled\nPattern:\nresource", "output": "Vulnerability rule: appservice-authentication-enabled\nMessage: Enabling authentication ensures that all communications in the application are authenticated. The `auth_settings` block needs to be filled out with the appropriate auth backend settings\nSeverity: ERROR\nCWE: ['CWE-287: Improper Authentication']\nOWASP: ['A02:2017 - Broken Authentication', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/appservice-authentication-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-disallowed-cors\nPattern:\n[\"*\"]\n", "output": "Vulnerability rule: azure-appservice-disallowed-cors\nMessage: Ensure that CORS disallows every resource to access app services\nSeverity: WARNING\nCWE: ['CWE-942: Permissive Cross-domain Policy with Untrusted Domains']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/appservice/azure-appservice-disallowed-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: storage-default-action-deny\nPattern:\nresource", "output": "Vulnerability rule: storage-default-action-deny\nMessage: Detected a Storage that was not configured to deny action by default. Add `default_action = \"Deny\"` in your resource block.\nSeverity: ERROR\nCWE: ['CWE-16: CWE CATEGORY: Configuration']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/storage/storage-default-action-deny.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-aks-apiserver-auth-ip-ranges\nPattern:\nresource", "output": "Vulnerability rule: azure-aks-apiserver-auth-ip-ranges\nMessage: Ensure AKS has an API Server Authorized IP Ranges enabled\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/aks/azure-aks-apiserver-auth-ip-ranges.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-aks-private-clusters-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-aks-private-clusters-enabled\nMessage: Ensure that AKS enables private clusters\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/aks/azure-aks-private-clusters-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-aks-uses-disk-encryptionset\nPattern:\nresource", "output": "Vulnerability rule: azure-aks-uses-disk-encryptionset\nMessage: Ensure that AKS uses disk encryption set\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/aks/azure-aks-uses-disk-encryptionset.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: functionapp-enable-http2\nPattern:\nresource", "output": "Vulnerability rule: functionapp-enable-http2\nMessage: Use the latest version of HTTP to ensure you are benefiting from security fixes. Add `http2_enabled = true` to your function app resource block\nSeverity: INFO\nCWE: [\"CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')\"]\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/functionapp/functionapp-enable-http2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: functionapp-authentication-enabled\nPattern:\nresource", "output": "Vulnerability rule: functionapp-authentication-enabled\nMessage: Enabling authentication ensures that all communications in the application are authenticated. The `auth_settings` block needs to be filled out with the appropriate auth backend settings\nSeverity: INFO\nCWE: ['CWE-287: Improper Authentication']\nOWASP: ['A02:2017 - Broken Authentication', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/functionapp/functionapp-authentication-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-apiservices-use-virtualnetwork\nPattern:\nresource", "output": "Vulnerability rule: azure-apiservices-use-virtualnetwork\nMessage: Ensure that API management services use virtual networks\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/security/apiservice/azure-apiservices-use-virtualnetwork.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mysql-geo-backup-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mysql-geo-backup-enabled\nMessage: Ensure that MySQL server enables geo-redundant backups\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-mysql-geo-backup-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-kubernetes\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-kubernetes\nMessage: Ensure that Azure Defender is set to On for Kubernetes\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-kubernetes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-servers\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-servers\nMessage: Ensure that Azure Defender is set to On for Servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-servers.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-ssl-enforcement-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-ssl-enforcement-enabled\nMessage: Ensure Enforce SSL connection is set to Enabled for PostgreSQL servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-ssl-enforcement-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-ftps-state\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-ftps-state\nMessage: Ensure FTP deployments are disabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-ftps-state.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-secret-content-type\nPattern:\nresource", "output": "Vulnerability rule: azure-secret-content-type\nMessage: Ensure that key vault secrets have content_type set\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-secret-content-type.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-securitycenter-contact-phone\nPattern:\nresource", "output": "Vulnerability rule: azure-securitycenter-contact-phone\nMessage: Ensure that Security contact Phone number is set\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-securitycenter-contact-phone.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mysql-threat-detection-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mysql-threat-detection-enabled\nMessage: Ensure that MySQL server enables Threat detection policy\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-mysql-threat-detection-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-securitycenter-standard-pricing\nPattern:\nresource", "output": "Vulnerability rule: azure-securitycenter-standard-pricing\nMessage: Ensure that standard pricing tier is selected\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-securitycenter-standard-pricing.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-java-version\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-java-version\nMessage: Ensure that Java version is the latest, if used to run the web app\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-java-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-server-connection-throttling-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-server-connection-throttling-enabled\nMessage: Ensure server parameter connection_throttling is set to ON for PostgreSQL Database Server\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-server-connection-throttling-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-functionapps-accessible-over-https\nPattern:\nresource", "output": "Vulnerability rule: azure-functionapps-accessible-over-https\nMessage: Ensure that HTTP Version is the latest if used to run the Function app\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-functionapps-accessible-over-https.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-synapse-workscape-enables-managed-virtual-network\nPattern:\nresource", "output": "Vulnerability rule: azure-synapse-workscape-enables-managed-virtual-network\nMessage: Ensure that Azure Synapse workspaces enables managed virtual networks\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-synapse-workscape-enables-managed-virtual-network.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-securitycenter-email-alert-admins\nPattern:\nresource", "output": "Vulnerability rule: azure-securitycenter-email-alert-admins\nMessage: Ensure that Send email notification for high severity alerts is set to On\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-securitycenter-email-alert-admins.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-frontdoor-enables-waf\nPattern:\nresource", "output": "Vulnerability rule: azure-frontdoor-enables-waf\nMessage: Ensure that Azure Front Door enables WAF\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-frontdoor-enables-waf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-https-20-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-https-20-enabled\nMessage: Ensure that HTTP Version is the latest if used to run the web app\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-https-20-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-ad-used-auth-service-fabric\nPattern:\nresource", "output": "Vulnerability rule: azure-ad-used-auth-service-fabric\nMessage: Ensures that Active Directory is used for authentication for Service Fabric\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-ad-used-auth-service-fabric.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-waf-specificed-mode-app-gw\nPattern:\nresource", "output": "Vulnerability rule: azure-waf-specificed-mode-app-gw\nMessage: Ensure that Application Gateway uses WAF in Detection or Prevention modes\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-waf-specificed-mode-app-gw.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-sqlserver-threat-detection-types\nPattern:\nresource", "output": "Vulnerability rule: azure-sqlserver-threat-detection-types\nMessage: Ensure that Threat Detection types is set to All\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-sqlserver-threat-detection-types.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mysql-server-tlsenforcement-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mysql-server-tlsenforcement-enabled\nMessage: Ensure Enforce SSL connection is set to Enabled for MySQL servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-mysql-server-tlsenforcement-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-geo-backup-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-geo-backup-enabled\nMessage: Ensure that PostgreSQL server enables geo-redundant backups\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-geo-backup-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-functionapp-http-version-latest\nPattern:\nresource", "output": "Vulnerability rule: azure-functionapp-http-version-latest\nMessage: Ensure that HTTP Version is the latest if used to run the Function app\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-functionapp-http-version-latest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-php-version\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-php-version\nMessage: Ensure that PHP version is the latest, if used to run the web app\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-php-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-used-azure-files\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-used-azure-files\nMessage: Ensure that app services use Azure Files\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-used-azure-files.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appgateway-enables-waf\nPattern:\nresource", "output": "Vulnerability rule: azure-appgateway-enables-waf\nMessage: Ensure that Application Gateway enables WAF\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appgateway-enables-waf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-aks-uses-azure-policies-addon\nPattern:\nresource", "output": "Vulnerability rule: azure-aks-uses-azure-policies-addon\nMessage: Ensure that AKS uses Azure Policies Add-on\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-aks-uses-azure-policies-addon.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-sqlserver-email-alerts-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-sqlserver-email-alerts-enabled\nMessage: Ensure that Send Alerts To is enabled for MSSQL servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-sqlserver-email-alerts-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-container-registry\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-container-registry\nMessage: Ensure that Azure Defender is set to On for Container\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-container-registry.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-server-log-checkpoint-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-server-log-checkpoint-enabled\nMessage: Ensure server parameter log_checkpoints is set to ON for PostgreSQL Database Server\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-server-log-checkpoint-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-securitcenter-email-alert\nPattern:\nresource", "output": "Vulnerability rule: azure-securitcenter-email-alert\nMessage: Ensure that Send email notification for high severity alerts is set to On\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-securitcenter-email-alert.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-storage\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-storage\nMessage: Ensure that Azure Defender is set to On for Storage\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-storage.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-securitycenter-contact-emails\nPattern:\nresource", "output": "Vulnerability rule: azure-securitycenter-contact-emails\nMessage: Ensure that Security contact emails is set\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-securitycenter-contact-emails.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-monitor-log-profile-categories\nPattern:\nresource", "output": "Vulnerability rule: azure-monitor-log-profile-categories\nMessage: Ensure audit profile captures all the activities\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-monitor-log-profile-categories.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-keyvault-recovery-enabled\nPattern:\nresource \"azurerm_key_vault\" \"...\" {\n...\n}\n", "output": "Vulnerability rule: azure-keyvault-recovery-enabled\nMessage: Ensure the key vault is recoverable https://docs.bridgecrew.io/docs/ensure-the-key-vault-is-recoverable\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-keyvault-recovery-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-keyvault-enables-firewall-rules-settings\nPattern:\nresource", "output": "Vulnerability rule: azure-keyvault-enables-firewall-rules-settings\nMessage: Ensure that key vault allows firewall rules settings\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-keyvault-enables-firewall-rules-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mariadb-sslenforcement-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mariadb-sslenforcement-enabled\nMessage: Ensure Enforce SSL connection is set to Enabled for MariaDB servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-mariadb-sslenforcement-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-secret-expiration-date\nPattern:\nresource", "output": "Vulnerability rule: azure-secret-expiration-date\nMessage: Ensure that the expiration date is set on all secrets\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-secret-expiration-date.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-dotnet-framework-version\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-dotnet-framework-version\nMessage: Ensure that Net Framework version is the latest, if used as a part of the web app\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-dotnet-framework-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-appservices\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-appservices\nMessage: Ensure that Azure Defender is set to On for App Service\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-appservices.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-keyvault-enables-purge-protection\nPattern:\nresource", "output": "Vulnerability rule: azure-keyvault-enables-purge-protection\nMessage: Ensure that key vault enables purge protection\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-keyvault-enables-purge-protection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-threat-detection-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-threat-detection-enabled\nMessage: Ensure that PostgreSQL server enables Threat detection policy\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-threat-detection-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-storage-account-enables-secure-transfer\nPattern:\nresource", "output": "Vulnerability rule: azure-storage-account-enables-secure-transfer\nMessage: Ensure that storage account enables secure transfer\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-storage-account-enables-secure-transfer.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-keyvault-enables-soft-delete\nPattern:\nresource", "output": "Vulnerability rule: azure-keyvault-enables-soft-delete\nMessage: Ensure that key vault enables soft delete\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-keyvault-enables-soft-delete.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-networkinterface-enable-ip-forwarding\nPattern:\nresource", "output": "Vulnerability rule: azure-networkinterface-enable-ip-forwarding\nMessage: Ensure that Network Interfaces disable IP forwarding\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-networkinterface-enable-ip-forwarding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-sqlservers-vms\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-sqlservers-vms\nMessage: Ensure that Azure Defender is set to On for SQL servers on machines\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-sqlservers-vms.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-server-log-connections-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-server-log-connections-enabled\nMessage: Ensure server parameter log_connections is set to ON for PostgreSQL Database Server\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-server-log-connections-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-vmscale-sets-auto-os-image-patching-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-vmscale-sets-auto-os-image-patching-enabled\nMessage: Ensure that automatic OS image patching is enabled for Virtual Machine Scale Sets\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-vmscale-sets-auto-os-image-patching-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-mariadb-geo-backup-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-mariadb-geo-backup-enabled\nMessage: Ensure that MariaDB server enables geo-redundant backups\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-mariadb-geo-backup-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-postgresql-flexi-server-geo-backup-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-postgresql-flexi-server-geo-backup-enabled\nMessage: Ensure that PostgreSQL Flexible server enables geo-redundant backups\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-postgresql-flexi-server-geo-backup-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-appservice-python-version\nPattern:\nresource", "output": "Vulnerability rule: azure-appservice-python-version\nMessage: Ensure that Python version is the latest, if used to run the web app\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-appservice-python-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-frontdoor-use-wafmode\nPattern:\nresource", "output": "Vulnerability rule: azure-frontdoor-use-wafmode\nMessage: Ensure that Azure Front Door uses WAF and configured in Detection or Prevention modes\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-frontdoor-use-wafmode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-monitor-log-profile-retention-days\nPattern:\nresource", "output": "Vulnerability rule: azure-monitor-log-profile-retention-days\nMessage: Ensure that Activity Log Retention is set 365 days or greater\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-monitor-log-profile-retention-days.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-sqlserver-email-alerts-toadmins-enabled\nPattern:\nresource", "output": "Vulnerability rule: azure-sqlserver-email-alerts-toadmins-enabled\nMessage: Ensure that Email service and co-administrators is Enabled for MSSQL servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-sqlserver-email-alerts-toadmins-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-sqlservers\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-sqlservers\nMessage: Ensure that Azure Defender is set to On for SQL servers\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-sqlservers.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: azure-defenderon-keyvaults\nPattern:\nresource", "output": "Vulnerability rule: azure-defenderon-keyvaults\nMessage: Ensure that Azure Defender is set to On for Key Vault\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/azure/best-practice/azure-defenderon-keyvaults.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataflow-job-encrypted-with-cmk\nPattern:\nresource \"google_dataflow_job\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-dataflow-job-encrypted-with-cmk\nMessage: Ensure data flow jobs are encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataflow-job-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-os-login\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-os-login\nMessage: Ensure that no instance in the project overrides the project setting for enabling OSLogin (OSLogin needs to be enabled in project metadata for all instances)\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-os-login.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-project-member-default-service-account-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-project-member-default-service-account-iam-member\nMessage: Ensure Default Service account is not used at a project level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-project-member-default-service-account-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-boot-disk-encryption\nPattern:\nresource \"google_compute_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-compute-boot-disk-encryption\nMessage: Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-boot-disk-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataflow-private-job\nPattern:\nresource", "output": "Vulnerability rule: gcp-dataflow-private-job\nMessage: Ensure Dataflow jobs are private\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataflow-private-job.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-21\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-21\nMessage: Ensure Google compute firewall ingress does not allow unrestricted FTP access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-21.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-legacy-auth-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-legacy-auth-enabled\nMessage: Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-legacy-auth-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-template-ip-forward\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-template-ip-forward\nMessage: Ensure that IP forwarding is not enabled on Instances. This lets the instance act as a traffic router and receive traffic not intended for it, which may route traffic through unintended passages.\nSeverity: INFO\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-template-ip-forward.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-datafusion-private-instance\nPattern:\nresource", "output": "Vulnerability rule: gcp-datafusion-private-instance\nMessage: Ensure Data fusion instances are private\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-datafusion-private-instance.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-folder-impersonation-roles-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-folder-impersonation-roles-iam-binding\nMessage: Ensure no roles that enable to impersonate and manage all service accounts are used at a folder level\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-folder-impersonation-roles-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-folder-impersonation-roles-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-folder-impersonation-roles-iam-member\nMessage: Ensure no roles that enable to impersonate and manage all service accounts are used at a folder level\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-folder-impersonation-roles-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-20\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-20\nMessage: Ensure Google compute firewall ingress does not allow unrestricted FTP access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-20.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-pubsub-encrypted-with-cmk\nPattern:\nresource \"google_pubsub_topic\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-pubsub-encrypted-with-cmk\nMessage: Ensure PubSub Topics are encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-pubsub-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-cluster-logging\nPattern:\nresource \"google_container_cluster\" $ANYTHING {\n  ...\n  logging_service = \"none\"\n  ...\n}\n", "output": "Vulnerability rule: gcp-gke-cluster-logging\nMessage: Ensure logging is set to Enabled on Kubernetes Engine Clusters\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-cluster-logging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-sqlserver-no-public-ip\nPattern:\nresource", "output": "Vulnerability rule: gcp-sqlserver-no-public-ip\nMessage: Ensure Cloud SQL database does not have public IP\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-sqlserver-no-public-ip.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-disk-encryption\nPattern:\nresource \"google_compute_disk\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-compute-disk-encryption\nMessage: Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-disk-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-project-service-account-user-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-project-service-account-user-iam-member\nMessage: Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-project-service-account-user-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-kubernetes-rbac-google-groups\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-kubernetes-rbac-google-groups\nMessage: Manage Kubernetes RBAC users with Google Groups for GKE\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-kubernetes-rbac-google-groups.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-bigtable-instance-encrypted-with-cmk\nPattern:\nresource \"google_bigtable_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-bigtable-instance-encrypted-with-cmk\nMessage: Ensure Big Table Instances are encrypted with Customer Supplied Encryption Keys (CSEK)\t\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-bigtable-instance-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataproc-cluster-encrypted-with-cmk\nPattern:\nresource \"google_dataproc_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-dataproc-cluster-encrypted-with-cmk\nMessage: Ensure Dataproc cluster is encrypted with Customer Supplied Encryption Keys (CSEK)\t\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataproc-cluster-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-private-cluster-config\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-private-cluster-config\nMessage: Ensure Kubernetes Cluster is created with Private cluster enabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-private-cluster-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-artifact-registry-private-repo-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-artifact-registry-private-repo-iam-binding\nMessage: Ensure that Artifact Registry repositories are not anonymously or publicly accessible\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-artifact-registry-private-repo-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-master-authz-networks-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-master-authz-networks-enabled\nMessage: Ensure master authorized networks is set to enabled in GKE clusters\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-master-authz-networks-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-vertexai-metadata-store-encrypted-with-cmk\nPattern:\nresource \"google_vertex_ai_metadata_store\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-vertexai-metadata-store-encrypted-with-cmk\nMessage: Ensure Vertex AI Metadata Store uses a CMK (Customer Manager Key)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-vertexai-metadata-store-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-storage-bucket-uniform-access\nPattern:\nresource", "output": "Vulnerability rule: gcp-storage-bucket-uniform-access\nMessage: Ensure that Cloud Storage buckets have uniform bucket-level access enabled. Setting `uniform_bucket_level_access` to `true` ensures that access is managed uniformly at the bucket level, which improves security by disabling object-level ACLs.\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-storage-bucket-uniform-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-sub-network-logging-enabled\nPattern:\nresource \"google_compute_subnetwork\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-sub-network-logging-enabled\nMessage: Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-sub-network-logging-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-memory-store-for-redis-intransit-encryption\nPattern:\nresource \"google_redis_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-memory-store-for-redis-intransit-encryption\nMessage: Ensure Memorystore for Redis uses intransit encryption\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-memory-store-for-redis-intransit-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-artifact-registry-private-repo-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-artifact-registry-private-repo-iam-member\nMessage: Ensure that Artifact Registry repositories are not anonymously or publicly accessible\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-artifact-registry-private-repo-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-project-member-default-service-account-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-project-member-default-service-account-iam-binding\nMessage: Ensure Default Service account is not used at a project level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-project-member-default-service-account-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-ssl-policy\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-ssl-policy\nMessage: Ensure no HTTPS or SSL proxy load balancers permit SSL policies with weak cipher suites\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-ssl-policy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-org-impersonation-roles-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-org-impersonation-roles-iam-member\nMessage: Ensure no roles that enable to impersonate and manage all service accounts are used at an organization level\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-org-impersonation-roles-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-project-service-account-user-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-project-service-account-user-iam-binding\nMessage: Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-project-service-account-user-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataproc-private-cluster-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-dataproc-private-cluster-iam-member\nMessage: Ensure that Dataproc clusters are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataproc-private-cluster-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-run-private-service-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-run-private-service-iam-member\nMessage: Ensure that GCP Cloud Run services are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-run-private-service-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-pod-security-policy-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-pod-security-policy-enabled\nMessage: Ensure PodSecurityPolicy controller is enabled on the Kubernetes Engine Clusters\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-pod-security-policy-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-vertexai-private-instance\nPattern:\nresource", "output": "Vulnerability rule: gcp-vertexai-private-instance\nMessage: Ensure Vertex AI instances are private\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-vertexai-private-instance.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-artifact-registry-encrypted-with-cmk\nPattern:\nresource \"google_artifact_registry_repository\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-artifact-registry-encrypted-with-cmk\nMessage: Ensure Artifact Registry Repositories are encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-artifact-registry-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-org-member-default-service-account-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-org-member-default-service-account-iam-binding\nMessage: Ensure default service account is not used at an organization level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-org-member-default-service-account-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-public-control-plane\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-public-control-plane\nMessage: Ensure GKE Control Plane is not public\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-public-control-plane.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-bigquery-dataset-encrypted-with-cmk\nPattern:\nresource \"google_bigquery_dataset\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-bigquery-dataset-encrypted-with-cmk\nMessage: Ensure that BigQuery datasets are not anonymously or publicly accessible\t\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-bigquery-dataset-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-network-policy-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-network-policy-enabled\nMessage: Ensure Network Policy is enabled on Kubernetes Engine Clusters\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-network-policy-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataproc-private-cluster-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-dataproc-private-cluster-iam-binding\nMessage: Ensure that Dataproc clusters are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataproc-private-cluster-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-org-member-default-service-account-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-org-member-default-service-account-iam-member\nMessage: Ensure default service account is not used at an organization level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-org-member-default-service-account-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-pubsub-private-topic-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-pubsub-private-topic-iam-binding\nMessage: Ensure that Pub/Sub Topics are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-pubsub-private-topic-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-pubsub-private-topic-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-pubsub-private-topic-iam-member\nMessage: Ensure that Pub/Sub Topics are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-pubsub-private-topic-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dataproc-cluster-public-ip\nPattern:\nresource", "output": "Vulnerability rule: gcp-dataproc-cluster-public-ip\nMessage: Ensure Dataproc Clusters do not have public IPs\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dataproc-cluster-public-ip.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): terraform\nSemgrep rule id: gcp-insecure-load-balancer-tls-version\nPattern:\nresource \"google_compute_ssl_policy\" $ANYTHING {\n  ...\n  min_tls_version = \"...\"\n  ...\n}\n", "output": "Vulnerability rule: gcp-insecure-load-balancer-tls-version\nMessage: Detected GCP Load Balancer to be using an insecure version of TLS. To fix this set your \"min_tls_version\" to \"TLS_1_2\"\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-insecure-load-balancer-tls-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-legacy-instance-metadata-disabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-legacy-instance-metadata-disabled\nMessage: Ensure legacy Compute Engine instance metadata APIs are Disabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-legacy-instance-metadata-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-memory-store-for-redis-auth-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-memory-store-for-redis-auth-enabled\nMessage: Ensure Memorystore for Redis has AUTH enabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-memory-store-for-redis-auth-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-bigquery-private-table-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-bigquery-private-table-iam-member\nMessage: Ensure that BigQuery Tables are not anonymously or publicly accessible\t\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-bigquery-private-table-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-public-ip\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-public-ip\nMessage: Ensure that Compute instances do not have public IP addresses\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-public-ip.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-folder-member-default-service-account-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-folder-member-default-service-account-iam-member\nMessage: Ensure Default Service account is not used at a folder level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-folder-member-default-service-account-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-cloud-storage-logging\nPattern:\nresource \"google_storage_bucket\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-cloud-storage-logging\nMessage: Ensure bucket logs access.\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A10:2017 - Insufficient Logging & Monitoring', 'A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-cloud-storage-logging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-kms-prevent-destroy\nPattern:\nresource", "output": "Vulnerability rule: gcp-kms-prevent-destroy\nMessage: Ensure KMS keys are protected from deletion\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-kms-prevent-destroy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-org-impersonation-roles-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-org-impersonation-roles-iam-binding\nMessage: Ensure no roles that enable to impersonate and manage all service accounts are used at an organization level\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-org-impersonation-roles-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-build-workers-private\nPattern:\nresource", "output": "Vulnerability rule: gcp-build-workers-private\nMessage: Ensure Cloud build workers are private\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-build-workers-private.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-secure-boot-for-shielded-nodes\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-secure-boot-for-shielded-nodes\nMessage: Ensure Secure Boot for Shielded GKE Nodes is Enabled\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-secure-boot-for-shielded-nodes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-sql-public-database\nPattern:\nresource", "output": "Vulnerability rule: gcp-sql-public-database\nMessage: Ensure that Cloud SQL database Instances are not open to the world\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-sql-public-database.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-bigquery-private-table-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-bigquery-private-table-iam-binding\nMessage: Ensure that BigQuery Tables are not anonymously or publicly accessible\t\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-bigquery-private-table-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-run-private-service-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-run-private-service-iam-binding\nMessage: Ensure that GCP Cloud Run services are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-run-private-service-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-3306\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-3306\nMessage: Ensure Google compute firewall ingress does not allow unrestricted MySQL access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-3306.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-project-default-network\nPattern:\nresource", "output": "Vulnerability rule: gcp-project-default-network\nMessage: Ensure that the default network does not exist in a project. Set auto_create_network to `false`.\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-project-default-network.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-template-public-ip\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-template-public-ip\nMessage: Ensure that Compute instances do not have public IP addresses\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-template-public-ip.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-folder-member-default-service-account-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-folder-member-default-service-account-iam-binding\nMessage: Ensure Default Service account is not used at a folder level\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-folder-member-default-service-account-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-ip-forward\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-ip-forward\nMessage: Ensure that IP forwarding is not enabled on Instances. This lets the instance act as a traffic router and receive traffic not intended for it, which may route traffic through unintended passages.\t\nSeverity: INFO\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-ip-forward.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-project-os-login\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-project-os-login\nMessage: Ensure oslogin is enabled for a Project\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-project-os-login.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-basic-auth\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-basic-auth\nMessage: Ensure GKE basic auth is disabled\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-basic-auth.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-serial-ports\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-serial-ports\nMessage: Ensure 'Enable connecting to serial ports' is not enabled for VM Instance\t\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-serial-ports.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-bigquery-table-encrypted-with-cmk\nPattern:\nresource \"google_bigquery_table\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-bigquery-table-encrypted-with-cmk\nMessage: Ensure Big Query Tables are encrypted with Customer Supplied Encryption Keys (CSEK)\t\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-bigquery-table-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-80\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-80\nMessage: Ensure Google compute firewall ingress does not allow unrestricted HTTP access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-80.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-sub-network-private-google-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-sub-network-private-google-enabled\nMessage: Ensure that private_ip_google_access is enabled for Subnet\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-sub-network-private-google-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dns-key-specs-rsasha1\nPattern:\nresource", "output": "Vulnerability rule: gcp-dns-key-specs-rsasha1\nMessage: Ensure that RSASHA1 is not used for the zone-signing and key-signing keys in Cloud DNS DNSSEC\t\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-dns-key-specs-rsasha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-sql-database-require-ssl\nPattern:\nresource", "output": "Vulnerability rule: gcp-sql-database-require-ssl\nMessage: Ensure all Cloud SQL database instance requires all incoming connections to use SSL\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-sql-database-require-ssl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-vertexai-dataset-encrypted-with-cmk\nPattern:\nresource \"google_vertex_ai_dataset\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-vertexai-dataset-encrypted-with-cmk\nMessage: Ensure Vertex AI datasets uses a CMK (Customer Manager Key)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-vertexai-dataset-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-3389\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-3389\nMessage: Ensure Google compute firewall ingress does not allow unrestricted RDP access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-3389.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-storage-bucket-not-public-iam-member\nPattern:\nresource", "output": "Vulnerability rule: gcp-storage-bucket-not-public-iam-member\nMessage: Ensure that Container Registry repositories are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-storage-bucket-not-public-iam-member.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-spanner-database-encrypted-with-cmk\nPattern:\nresource \"google_spanner_database\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: gcp-spanner-database-encrypted-with-cmk\nMessage: Ensure Spanner Database is encrypted with Customer Supplied Encryption Keys (CSEK)\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-spanner-database-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-client-certificate-disabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-client-certificate-disabled\nMessage: Ensure client certificate authentication to Kubernetes Engine Clusters is disabled\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-gke-client-certificate-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-storage-bucket-not-public-iam-binding\nPattern:\nresource", "output": "Vulnerability rule: gcp-storage-bucket-not-public-iam-binding\nMessage: Ensure that Container Registry repositories are not anonymously or publicly accessible\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-storage-bucket-not-public-iam-binding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-firewall-unrestricted-ingress-22\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-firewall-unrestricted-ingress-22\nMessage: Ensure Google compute firewall ingress does not allow unrestricted SSH access\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/security/gcp-compute-firewall-unrestricted-ingress-22.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-connection\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-connection\nMessage: Ensure PostgreSQL database 'log_connections' flag is set to 'on'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-disconnection\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-disconnection\nMessage: Ensure PostgreSQL database 'log_disconnections' flag is set to 'on'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-disconnection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-nodepool-auto-repair-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-nodepool-auto-repair-enabled\nMessage: Ensure 'Automatic node repair' is enabled for Kubernetes Clusters\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-nodepool-auto-repair-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-enable-shielded-nodes\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-enable-shielded-nodes\nMessage: Ensure Shielded GKE Nodes are Enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-enable-shielded-nodes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-min-message\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-min-message\nMessage: Ensure PostgreSQL database 'log_min_messages' flag is set to a valid value\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-min-message.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-alias-ip-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-alias-ip-enabled\nMessage: Ensure Kubernetes Cluster is created with Alias IP ranges enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-alias-ip-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-min-duration\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-min-duration\nMessage: Ensure PostgreSQL database 'log_min_duration_statement' flag is set to '-1'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-min-duration.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-template-shielded-vm\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-template-shielded-vm\nMessage: Ensure Compute instances are launched with Shielded VM enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-compute-template-shielded-vm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-use-cos-image\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-use-cos-image\nMessage: Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-use-cos-image.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-sql-backup-configuration-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-sql-backup-configuration-enabled\nMessage: Ensure all Cloud SQL database instance have backup configuration enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-sql-backup-configuration-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-has-labels\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-has-labels\nMessage: Ensure Kubernetes Clusters are configured with Labels\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-has-labels.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-nodepool-metadata-server-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-nodepool-metadata-server-enabled\nMessage: Ensure the GKE Metadata Server is Enabled\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-nodepool-metadata-server-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-compute-shielded-vm\nPattern:\nresource", "output": "Vulnerability rule: gcp-compute-shielded-vm\nMessage: Ensure Compute instances are launched with Shielded VM enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-compute-shielded-vm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-ipv6-private-google-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-ipv6-private-google-enabled\nMessage: Ensure that Private google access is enabled for IPV6\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-ipv6-private-google-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-storage-versioning-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-storage-versioning-enabled\nMessage: Ensure Cloud storage has versioning enabled\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-storage-versioning-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-dnssec-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-dnssec-enabled\nMessage: Ensure that RSASHA1 is not used for the zone-signing and key-signing keys in Cloud DNS DNSSEC\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-dnssec-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-nodepool-secure-boot-for-shielded-nodes\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-nodepool-secure-boot-for-shielded-nodes\nMessage: Ensure Secure Boot for Shielded GKE Nodes is Enabled\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-nodepool-secure-boot-for-shielded-nodes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-metadata-server-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-metadata-server-enabled\nMessage: Ensure the GKE Metadata Server is Enabled\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-metadata-server-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-lock-waits\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-lock-waits\nMessage: Ensure PostgreSQL database 'log_lock_waits' flag is set to 'on'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-lock-waits.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-temp\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-temp\nMessage: Ensure PostgreSQL database 'log_temp_files' flag is set to '0'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-temp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-postgresql-log-checkpoints\nPattern:\nresource", "output": "Vulnerability rule: gcp-postgresql-log-checkpoints\nMessage: Ensure PostgreSQL database 'log_checkpoints' flag is set to 'on'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-postgresql-log-checkpoints.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-mysql-local-in-file-off\nPattern:\nresource", "output": "Vulnerability rule: gcp-mysql-local-in-file-off\nMessage: Ensure MySQL database 'local_infile' flag is set to 'off'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-mysql-local-in-file-off.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-binary-authorization\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-binary-authorization\nMessage: Ensure use of Binary Authorization\t\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-binary-authorization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: gcp-gke-nodepool-auto-upgrade-enabled\nPattern:\nresource", "output": "Vulnerability rule: gcp-gke-nodepool-auto-upgrade-enabled\nMessage: Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/gcp/best-practice/gcp-gke-nodepool-auto-upgrade-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: s3-public-rw-bucket\nPattern:\nacl = \"public-read-write\"", "output": "Vulnerability rule: s3-public-rw-bucket\nMessage: S3 bucket with public read-write access detected.\nSeverity: ERROR\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/s3-public-rw-bucket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: all-origins-allowed\nPattern:\nallowed_origins = [\"*\"]", "output": "Vulnerability rule: all-origins-allowed\nMessage: CORS rule on bucket permits any origin\nSeverity: WARNING\nCWE: ['CWE-942: Permissive Cross-domain Policy with Untrusted Domains']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/s3-cors-all-origins.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: eks-insufficient-control-plane-logging\nPattern:\nname = ...\n", "output": "Vulnerability rule: eks-insufficient-control-plane-logging\nMessage: Missing EKS control plane logging. It is recommended to enable at least Kubernetes API server component logs (\"api\") and audit logs (\"audit\") of the EKS control plane through the enabled_cluster_log_types attribute.\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A10:2017 - Insufficient Logging & Monitoring', 'A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/eks-insufficient-control-plane-logging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: ecr-image-scan-on-push\nPattern:\nresource", "output": "Vulnerability rule: ecr-image-scan-on-push\nMessage: The ECR Repository isn't configured to scan images on push\nSeverity: WARNING\nCWE: ['CWE-1104: Use of Unmaintained Third Party Components']\nOWASP: ['A06:2021 - Vulnerable and Outdated Components']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/ecr-image-scan-on-push.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: rds-public-access\nPattern:\npublicly_accessible = true", "output": "Vulnerability rule: rds-public-access\nMessage: RDS instance accessible from the Internet detected.\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/rds-public-access.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: elastic-search-encryption-at-rest\nPattern:\nresource\n", "output": "Vulnerability rule: elastic-search-encryption-at-rest\nMessage: Encryption at rest is not enabled for the elastic search domain resource\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/elastic-search-encryption-at-rest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: s3-unencrypted-bucket\nPattern:\na", "output": "Vulnerability rule: s3-unencrypted-bucket\nMessage: This rule has been deprecated, as all s3 buckets are encrypted by default with no way to disable it. See https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_server_side_encryption_configuration for more info.\nSeverity: INFO\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/s3-unencrypted-bucket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: s3-unencrypted-bucket\nPattern:\nb", "output": "Vulnerability rule: s3-unencrypted-bucket\nMessage: This rule has been deprecated, as all s3 buckets are encrypted by default with no way to disable it. See https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_server_side_encryption_configuration for more info.\nSeverity: INFO\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/s3-unencrypted-bucket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: eks-public-endpoint-enabled\nPattern:\nresource\n", "output": "Vulnerability rule: eks-public-endpoint-enabled\nMessage: The vpc_config resource inside the eks cluster has not explicitly disabled public endpoint access\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/lang/security/eks-public-endpoint-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-fsx-lustre-filesystem-encrypted-with-cmk\nPattern:\nresource \"aws_fsx_lustre_file_system\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-fsx-lustre-filesystem-encrypted-with-cmk\nMessage: Ensure FSX Lustre file system is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-fsx-lustre-files-ystem.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): terraform\nSemgrep rule id: aws-elasticsearch-insecure-tls-version\nPattern:\nresource \"aws_elasticsearch_domain\" $ANYTHING {\n  ...\n  domain_endpoint_options {\n    ...\n    enforce_https = true\n    tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-elasticsearch-insecure-tls-version\nMessage: Detected an AWS Elasticsearch domain using an insecure version of TLS. To fix this, set \"tls_security_policy\" equal to \"Policy-Min-TLS-1-2-2019-07\".\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-elasticsearch-insecure-tls-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-config-aggregator-not-all-regions\nPattern:\nresource \"aws_config_configuration_aggregator\" $ANYTHING {\n  ...\n  account_aggregation_source {\n    ...\n    regions = ...\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-config-aggregator-not-all-regions\nMessage: The AWS configuration aggregator does not aggregate all AWS Config region. This may result in unmonitored configuration in regions that are thought to be unused. Configure the aggregator with all_regions for the source.\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-config-aggregator-not-all-regions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-config-aggregator-not-all-regions\nPattern:\nresource \"aws_config_configuration_aggregator\" $ANYTHING {\n  ...\n  organization_aggregation_source {\n    ...\n    regions = ...\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-config-aggregator-not-all-regions\nMessage: The AWS configuration aggregator does not aggregate all AWS Config region. This may result in unmonitored configuration in regions that are thought to be unused. Configure the aggregator with all_regions for the source.\nSeverity: WARNING\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-config-aggregator-not-all-regions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-emr-encrypted-with-cmk\nPattern:\nconfiguration = \"$STATEMENT\"", "output": "Vulnerability rule: aws-emr-encrypted-with-cmk\nMessage: Ensure EMR is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-emr-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-documentdb-auditing-disabled\nPattern:\nresource \"aws_docdb_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-documentdb-auditing-disabled\nMessage: Auditing is not enabled for DocumentDB. To ensure that you are able to accurately audit the usage of your DocumentDB cluster, you should enable auditing and export logs to CloudWatch.\nSeverity: INFO\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-documentdb-auditing-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-insecure-redshift-ssl-configuration\nPattern:\nresource \"aws_redshift_parameter_group\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-insecure-redshift-ssl-configuration\nMessage: Detected an AWS Redshift configuration with a SSL disabled. To fix this, set your `require_ssl` to `\"true\"`.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-insecure-redshift-ssl-configuration.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-transfer-server-is-public\nPattern:\nresource \"aws_transfer_server\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-transfer-server-is-public\nMessage: Transfer Server endpoint type should not have public or null configured in order to block public access. To fix this, set your `endpoint_type` to `\"VPC\"`.\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-transfer-server-is-public.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-redshift-cluster-encrypted-with-cmk\nPattern:\nresource \"aws_redshift_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-redshift-cluster-encrypted-with-cmk\nMessage: Ensure AWS Redshift cluster is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-1220: Insufficient Granularity of Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-redshift-cluster-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-sqs-queue-unencrypted\nPattern:\nresource \"aws_sqs_queue\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-sqs-queue-unencrypted\nMessage: The AWS SQS queue contents are unencrypted. The data could be read if compromised. Enable server-side encryption for your queue using SQS-managed encryption keys (SSE-SQS), or using your own AWS KMS key (SSE-KMS).\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-sqs-queue-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: wildcard-assume-role\nPattern:\nassume_role_policy = \"$STATEMENT\"", "output": "Vulnerability rule: wildcard-assume-role\nMessage: Detected wildcard access granted to sts:AssumeRole. This means anyone with your AWS account ID and the name of the role can assume the role. Instead, limit to a specific identity in your account, like this: `arn:aws:iam::<account_id>:root`.\nSeverity: ERROR\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/wildcard-assume-role.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-dynamodb-table-unencrypted\nPattern:\nresource \"aws_dynamodb_table\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-dynamodb-table-unencrypted\nMessage: By default, AWS DynamoDB Table is encrypted using AWS-managed keys. However, for added security, it's recommended to configure your own AWS KMS encryption key to protect your data in the DynamoDB table. You can either create a new aws_kms_key resource or use the ARN of an existing key in your AWS account to do so.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-dynamodb-table-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ebs-volume-encrypted-with-cmk\nPattern:\nresource \"aws_ebs_volume\" $ANYTHING {\n  ...\n  encrypted = true\n  ...\n}\n", "output": "Vulnerability rule: aws-ebs-volume-encrypted-with-cmk\nMessage: Ensure EBS Volume is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ebs-volume-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-codebuild-artifacts-unencrypted\nPattern:\n$ARTIFACTS {\n  ...\n  type = \"$TYPE\"\n  encryption_disabled = true\n  ...\n}\n", "output": "Vulnerability rule: aws-codebuild-artifacts-unencrypted\nMessage: The CodeBuild project artifacts are unencrypted. All artifacts produced by your CodeBuild project pipeline should be encrypted to prevent them from being read if compromised.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-codebuild-artifacts-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-insecure-cloudfront-distribution-tls-version\nPattern:\nresource \"aws_cloudfront_distribution\" $ANYTHING {\n  ...\n  viewer_certificate {\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-insecure-cloudfront-distribution-tls-version\nMessage: Detected an AWS CloudFront Distribution with an insecure TLS version. TLS versions less than 1.2 are considered insecure because they can be broken. To fix this, set your `minimum_protocol_version` to `\"TLSv1.2_2018\", \"TLSv1.2_2019\", \"TLSv1.2_2021\", \"TLSv1.2_2025\" or \"TLSv1.3_2025\"`.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-cloudfront-insecure-tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-docdb-encrypted-with-cmk\nPattern:\nresource \"aws_docdb_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-docdb-encrypted-with-cmk\nMessage: Ensure DocDB is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-docdb-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-workspaces-user-volume-unencrypted\nPattern:\nresource \"aws_workspaces_workspace\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-workspaces-user-volume-unencrypted\nMessage: The AWS Workspace user volume is unencrypted. The AWS KMS encryption key protects user volume. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-workspaces-user-volume-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-cloudtrail-encrypted-with-cmk\nPattern:\nresource \"aws_cloudtrail\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-cloudtrail-encrypted-with-cmk\nMessage: Ensure CloudTrail logs are encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-cloudtrail-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-s3-bucket-object-encrypted-with-cmk\nPattern:\nresource \"aws_s3_bucket_object\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-s3-bucket-object-encrypted-with-cmk\nMessage: Ensure S3 bucket object is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-s3-bucket-object-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-backup-vault-unencrypted\nPattern:\nresource \"aws_backup_vault\" $BACKUP {...}", "output": "Vulnerability rule: aws-backup-vault-unencrypted\nMessage: The AWS Backup vault is unencrypted. The AWS KMS encryption key protects backups in the Backup vault. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-backup-vault-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-athena-client-can-disable-workgroup-encryption\nPattern:\nresource \"aws_athena_workgroup\" $ANYTHING {\n  ...\n  configuration {\n    ...\n    enforce_workgroup_configuration = false\n    ...\n    result_configuration {\n      ...\n      encryption_configuration {\n        ...\n      }\n      ...\n    }\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-athena-client-can-disable-workgroup-encryption\nMessage: The Athena workgroup configuration can be overriden by client-side settings. The client can make changes to disable encryption settings. Enforce the configuration to prevent client overrides.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-athena-client-can-disable-workgroup-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-codebuild-project-unencrypted\nPattern:\nresource \"aws_codebuild_project\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-codebuild-project-unencrypted\nMessage: The AWS CodeBuild Project is unencrypted. The AWS KMS encryption key protects projects in the CodeBuild. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-codebuild-project-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-iam-admin-policy-ssoadmin\nPattern:\ninline_policy = \"$STATEMENT\"", "output": "Vulnerability rule: aws-iam-admin-policy-ssoadmin\nMessage: Detected admin access granted in your policy. This means anyone with this policy can perform administrative actions. Instead, limit actions and resources to what you need according to least privilege.\nSeverity: ERROR\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-iam-admin-policy-ssoadmin.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ec2-launch-configuration-ebs-block-device-unencrypted\nPattern:\nebs_block_device {\n  ...\n}\n", "output": "Vulnerability rule: aws-ec2-launch-configuration-ebs-block-device-unencrypted\nMessage: The AWS launch configuration EBS block device is unencrypted. The block device could be read if compromised. Block devices should be encrypted to ensure sensitive data is held securely at rest.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ec2-launch-configuration-ebs-block-device-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-timestream-database-encrypted-with-cmk\nPattern:\nresource \"aws_timestreamwrite_database\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-timestream-database-encrypted-with-cmk\nMessage: Ensure Timestream database is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-timestream-database-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: missing-athena-workgroup-encryption\nPattern:\nresource \"aws_athena_workgroup\" $ANYTHING {...}", "output": "Vulnerability rule: missing-athena-workgroup-encryption\nMessage: The AWS Athena Workgroup is unencrypted. Encryption protects query results in your workgroup. To enable, add: `encryption_configuration { encryption_option = \"SSE_KMS\" kms_key_arn =  aws_kms_key.example.arn }` within `result_configuration { }` in your resource block,  where `encryption_option` is your chosen encryption method and `kms_key_arn`  is your KMS key ARN.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/missing-athena-workgroup-encryption.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-fsx-windows-encrypted-with-cmk\nPattern:\nresource \"aws_fsx_windows_file_system\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-fsx-windows-encrypted-with-cmk\nMessage: Ensure FSX Windows file system is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-fsx-windows-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-secretsmanager-secret-unencrypted\nPattern:\nresource \"aws_secretsmanager_secret\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-secretsmanager-secret-unencrypted\nMessage: By default, AWS SecretManager secrets are encrypted using AWS-managed keys. However, for added security, it's recommended to configure your own AWS KMS encryption key to protect your secrets in the Secret Manager. You can either create a new aws_kms_key resource or use the ARN of an existing key in your AWS account to do so.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-secretsmanager-secret-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ec2-launch-template-metadata-service-v1-enabled\nPattern:\nresource \"aws_launch_template\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-ec2-launch-template-metadata-service-v1-enabled\nMessage: The EC2 launch template has Instance Metadata Service Version 1 (IMDSv1) enabled. IMDSv2 introduced session authentication tokens which improve security when talking to IMDS. You should either disable IMDS or require the use of IMDSv2.\nSeverity: WARNING\nCWE: ['CWE-1390: Weak Authentication']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ec2-launch-template-metadata-service-v1-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-documentdb-storage-unencrypted\nPattern:\nresource \"aws_docdb_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-documentdb-storage-unencrypted\nMessage: The AWS DocumentDB cluster is unencrypted. The data could be read if the underlying disks are compromised. You should enable storage encryption.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-documentdb-storage-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-workspaces-root-volume-unencrypted\nPattern:\nresource \"aws_workspaces_workspace\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-workspaces-root-volume-unencrypted\nMessage: The AWS Workspace root volume is unencrypted. The AWS KMS encryption key protects root volume. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-workspaces-root-volume-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ebs-snapshot-encrypted-with-cmk\nPattern:\nresource \"aws_ebs_snapshot_copy\" $ANYTHING {\n  ...\n  encrypted = true\n  ...\n}\n", "output": "Vulnerability rule: aws-ebs-snapshot-encrypted-with-cmk\nMessage: Ensure EBS Snapshot is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ebs-snapshot-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-cloudwatch-log-group-no-retention\nPattern:\nresource \"aws_cloudwatch_log_group\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-cloudwatch-log-group-no-retention\nMessage: The AWS CloudWatch Log Group has no retention. Missing retention in log groups can cause losing important event information.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-cloudwatch-log-group-no-retention.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ecr-image-scanning-disabled\nPattern:\nresource \"aws_ecr_repository\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-ecr-image-scanning-disabled\nMessage: The ECR repository has image scans disabled. Repository image scans should be enabled to ensure vulnerable software can be discovered and remediated as soon as possible.\nSeverity: WARNING\nCWE: ['CWE-223: Omission of Security-relevant Information']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ecr-image-scanning-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-imagebuilder-component-encrypted-with-cmk\nPattern:\nresource \"aws_imagebuilder_component\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-imagebuilder-component-encrypted-with-cmk\nMessage: Ensure ImageBuilder component is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-imagebuilder-component-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-athena-workgroup-unencrypted\nPattern:\nresource \"aws_athena_workgroup\" $ANYTHING {\n  ...\n  configuration {\n    ...\n    result_configuration {\n      ...\n    }\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-athena-workgroup-unencrypted\nMessage: The AWS Athena Work Group is unencrypted. The AWS KMS encryption key protects backups in the work group. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-athena-workgroup-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-fsx-lustre-filesystem-encrypted-with-cmk\nPattern:\nresource \"aws_fsx_lustre_file_system\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-fsx-lustre-filesystem-encrypted-with-cmk\nMessage: Ensure FSX Lustre file system is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-fsx-lustre-filesystem-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-db-instance-no-logging\nPattern:\nresource \"aws_db_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-db-instance-no-logging\nMessage: Database instance has no logging. Missing logs can cause missing important event information.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-db-instance-no-logging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-dynamodb-point-in-time-recovery-disabled\nPattern:\nresource \"aws_dynamodb_table\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-dynamodb-point-in-time-recovery-disabled\nMessage: Point-in-time recovery is not enabled for the DynamoDB table. DynamoDB tables should be protected against accidental or malicious write/delete actions. By enabling point-in-time-recovery you can restore to a known point in the event of loss of data.\nSeverity: INFO\nCWE: ['CWE-221: Information Loss or Omission']\nOWASP: ['A09:2021  Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-dynamodb-point-in-time-recovery-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-kinesis-stream-unencrypted\nPattern:\nresource \"aws_kinesis_stream\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-kinesis-stream-unencrypted\nMessage: The AWS Kinesis stream does not encrypt data at rest. The data could be read if the Kinesis stream storage layer is compromised. Enable Kinesis stream server-side encryption.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-kinesis-stream-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-fsx-ontapfs-encrypted-with-cmk\nPattern:\nresource \"aws_fsx_ontap_file_system\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-fsx-ontapfs-encrypted-with-cmk\nMessage: Ensure FSX ONTAP file system is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-fsx-ontapfs-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ebs-unencrypted\nPattern:\nresource \"aws_ebs_encryption_by_default\" $ANYTHING {\n  ...\n  enabled = false\n  ...\n}\n", "output": "Vulnerability rule: aws-ebs-unencrypted\nMessage: The AWS EBS is unencrypted. The AWS EBS encryption protects data in the EBS.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ebs-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-s3-object-copy-encrypted-with-cmk\nPattern:\nresource \"aws_s3_object_copy\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-s3-object-copy-encrypted-with-cmk\nMessage: Ensure S3 object copies are encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-s3-object-copy-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ebs-volume-unencrypted\nPattern:\nresource \"aws_ebs_volume\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-ebs-volume-unencrypted\nMessage: The AWS EBS volume is unencrypted. The volume, the disk I/O and any derived snapshots could be read if compromised. Volumes should be encrypted to ensure sensitive data is stored securely.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ebs-volume-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-kinesis-stream-encrypted-with-cmk\nPattern:\nresource \"aws_kinesis_stream\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-kinesis-stream-encrypted-with-cmk\nMessage: Ensure Kinesis stream is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-kinesis-stream-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-sagemaker-domain-encrypted-with-cmk\nPattern:\nresource \"aws_sagemaker_domain\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-sagemaker-domain-encrypted-with-cmk\nMessage: Ensure AWS Sagemaker domains are encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-sagemaker-domain-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-codebuild-project-artifacts-unencrypted\nPattern:\nresource \"aws_codebuild_project\" $ANYTHING {\n  ...\n  artifacts {\n    ...\n    encryption_disabled = true\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: aws-codebuild-project-artifacts-unencrypted\nMessage: The AWS CodeBuild Project Artifacts are unencrypted. The AWS KMS encryption key protects artifacts in the CodeBuild Projects. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-codebuild-project-artifacts-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-ecr-mutable-image-tags\nPattern:\nresource \"aws_ecr_repository\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-ecr-mutable-image-tags\nMessage: The ECR repository allows tag mutability. Image tags could be overwritten with compromised images. ECR images should be set to IMMUTABLE to prevent code injection through image mutation. This can be done by setting `image_tag_mutability` to IMMUTABLE.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-ecr-mutable-image-tags.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-efs-filesystem-encrypted-with-cmk\nPattern:\nresource \"aws_efs_file_system\" $ANYTHING {\n  ...\n  encrypted  = true\n  ...\n}\n", "output": "Vulnerability rule: aws-efs-filesystem-encrypted-with-cmk\nMessage: Ensure EFS filesystem is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-efs-filesystem-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-iam-admin-policy\nPattern:\npolicy = \"$STATEMENT\"", "output": "Vulnerability rule: aws-iam-admin-policy\nMessage: Detected admin access granted in your policy. This means anyone with this policy can perform administrative actions. Instead, limit actions and resources to what you need according to least privilege.\nSeverity: ERROR\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-iam-admin-policy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-lambda-x-ray-tracing-not-active\nPattern:\nresource \"aws_lambda_function\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-lambda-x-ray-tracing-not-active\nMessage: The AWS Lambda function does not have active X-Ray tracing enabled. X-Ray tracing enables end-to-end debugging and analysis of all function activity. This makes it easier to trace the flow of logs and identify bottlenecks, slow downs and timeouts.\nSeverity: INFO\nCWE: ['CWE-778: Insufficient Logging']\nOWASP: ['A09:2021 Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-lambda-x-ray-tracing-not-active.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-sns-topic-unencrypted\nPattern:\nresource \"aws_sns_topic\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-sns-topic-unencrypted\nMessage: The AWS SNS topic is unencrypted. The SNS topic messages could be read if compromised. The AWS KMS encryption key protects topic contents. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-sns-topic-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-kms-key-wildcard-principal\nPattern:\npolicy = \"$STATEMENT\"", "output": "Vulnerability rule: aws-kms-key-wildcard-principal\nMessage: Detected wildcard access granted in your KMS key. This means anyone with this policy can perform administrative actions over the keys. Instead, limit principals, actions and resources to what you need according to least privilege.\nSeverity: ERROR\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-kms-key-wildcard-principal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-kinesis-video-stream-encrypted-with-cmk\nPattern:\nresource \"aws_kinesis_video_stream\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-kinesis-video-stream-encrypted-with-cmk\nMessage: Ensure Kinesis video stream is encrypted at rest using KMS CMKs. CMKs gives you control over the encryption key in terms of access and rotation.\nSeverity: WARNING\nCWE: ['CWE-320: CWE CATEGORY: Key Management Errors']\nOWASP: ['A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-kinesis-video-stream-encrypted-with-cmk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-glacier-vault-any-principal\nPattern:\naccess_policy = \"$STATEMENT\"", "output": "Vulnerability rule: aws-glacier-vault-any-principal\nMessage: Detected wildcard access granted to Glacier Vault. This means anyone within your AWS account ID can perform actions on Glacier resources. Instead, limit to a specific identity in your account, like this: `arn:aws:iam::<account_id>:<identity>`.\nSeverity: ERROR\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-glacier-vault-any-principal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-cloudwatch-log-group-unencrypted\nPattern:\nresource \"aws_cloudwatch_log_group\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-cloudwatch-log-group-unencrypted\nMessage: By default, AWS CloudWatch Log Group is encrypted using AWS-managed keys. However, for added security, it's recommended to configure your own AWS KMS encryption key to protect your log group in CloudWatch. You can either create a new aws_kms_key resource or use the ARN of an existing key in your AWS account to do so.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-cloudwatch-log-group-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-lambda-permission-unrestricted-source-arn\nPattern:\nresource \"aws_lambda_permission\" $ANYTHING {\n  ...\n  principal = \"$PRINCIPAL\"\n  ...\n}\n", "output": "Vulnerability rule: aws-lambda-permission-unrestricted-source-arn\nMessage: The AWS Lambda permission has an AWS service principal but does not specify a source ARN. If you grant permission to a service principal without specifying the source, other accounts could potentially configure resources in their account to invoke your Lambda function. Set the source_arn value to the ARN of the AWS resource that invokes the function, eg. an S3 bucket, CloudWatch Events Rule, API Gateway, or SNS topic.\nSeverity: ERROR\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-lambda-permission-unrestricted-source-arn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-athena-database-unencrypted\nPattern:\nresource \"aws_athena_database\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-athena-database-unencrypted\nMessage: The Athena database is unencrypted at rest. These databases are generally derived from data in S3 buckets and should have the same level of at rest protection. The AWS KMS encryption key protects database contents. To create your own, create a aws_kms_key resource or use the ARN string of a key in your account.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/security/aws-athena-database-unencrypted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: lambda-permission-logs-missing-arn-asterisk\nPattern:\nsource_arn = $ARN\n", "output": "Vulnerability rule: lambda-permission-logs-missing-arn-asterisk\nMessage: The `source_arn` field needs to end with an asterisk, like this: `<log-group-arn>:*` Without this, the `aws_lambda_permission` resource '$NAME' will not be created. Add the asterisk to the end of the arn. x $ARN\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/correctness/lambda-permission-logs-missing-arn-asterisk.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: reserved-aws-lambda-environment-variable\nPattern:\n$VARIABLE = ...\n", "output": "Vulnerability rule: reserved-aws-lambda-environment-variable\nMessage: `terraform apply` will fail because the environment variable \"$VARIABLE\" is a reserved by AWS. Use another name for \"$VARIABLE\".\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/correctness/reserved-aws-lambda-environment-variable.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: subscription-filter-missing-depends\nPattern:\nresource \"aws_cloudwatch_log_subscription_filter\" $NAME {\n  ...\n  destination_arn = aws_lambda_function.$LAMBDA_NAME.arn\n}\n", "output": "Vulnerability rule: subscription-filter-missing-depends\nMessage: The `aws_cloudwatch_log_subscription_filter` resource \"$NAME\" needs a `depends_on` clause on the `aws_lambda_permission`, otherwise Terraform may try to create these out-of-order and fail.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/correctness/subscription-filter-missing-depends.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-rds-cluster-iam-authentication-not-enabled\nPattern:\nresource \"aws_rds_cluster\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-rds-cluster-iam-authentication-not-enabled\nMessage: The AWS RDS Cluster is not configured to use IAM authentication. Consider using IAM for authentication.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/aws-rds-cluster-iam-authentication-not-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-rds-iam-authentication-not-enabled\nPattern:\nresource \"aws_db_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-rds-iam-authentication-not-enabled\nMessage: The AWS RDS is not configured to use IAM authentication. Consider using IAM for authentication.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/aws-rds-iam-authentication-not-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-s3-bucket-versioning-not-enabled\nPattern:\nresource \"aws_s3_bucket\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-s3-bucket-versioning-not-enabled\nMessage: Ensure that Amazon S3 bucket versioning is not enabled. Consider using versioning if you don't have alternative backup mechanism.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/aws-s3-bucket-versioning-not-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: missing-aws-autoscaling-tags\nPattern:\nresource \"aws_autoscaling_group\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: missing-aws-autoscaling-tags\nMessage: The AWS Autoscaling Group is not tagged.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/missing-aws-autoscaling-tags.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: missing-api-gateway-cache-cluster\nPattern:\nresource \"aws_api_gateway_stage\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: missing-api-gateway-cache-cluster\nMessage: Found a AWS API Gateway Stage without cache cluster enabled. Enabling the cache cluster feature enhances responsiveness of your API. Add `cache_cluster_enabled = true` to your resource block.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/missing-api-gateway-cache-cluster.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: missing-aws-qldb-deletion-protection\nPattern:\nresource \"aws_qldb_ledger\" $ANYTHING {\n  ...\n  deletion_protection = false\n  ...\n}\n", "output": "Vulnerability rule: missing-aws-qldb-deletion-protection\nMessage: The AWS QLDB deletion protection is not enabled.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/missing-aws-qldb-deletion-protection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-rds-multiaz-not-enabled\nPattern:\nresource \"aws_db_instance\" $ANYTHING {\n  ...\n}\n", "output": "Vulnerability rule: aws-rds-multiaz-not-enabled\nMessage: The AWS RDS is not configured to use multi-az. Consider using it if possible.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/aws-rds-multiaz-not-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): hcl\nSemgrep rule id: aws-qldb-inadequate-ledger-permissions-mode\nPattern:\nresource \"aws_qldb_ledger\" $ANYTHING {\n  ...\n  permissions_mode = \"ALLOW_ALL\"\n  ...\n}\n", "output": "Vulnerability rule: aws-qldb-inadequate-ledger-permissions-mode\nMessage: The AWS QLDB ledger permissions are too permissive. Consider using \"'STANDARD'\" permissions mode if possible.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: terraform/aws/best-practice/aws-qldb-inadequate-ledger-permissions-mode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: bad-crypto\nPattern:\nBlob $IV = Blob.valueOf('$STRING');...Crypto.encrypt($ONE, $TWO, $IV, $FOUR);", "output": "Vulnerability rule: bad-crypto\nMessage: The rule makes sure you are using randomly generated IVs and keys for Crypto calls. Hard-coding these values greatly compromises the security of encrypted data.\nSeverity: ERROR\nCWE: ['CWE-321: Use of Hard-coded Cryptographic Key']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/encryption/BadCrypto.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: bad-crypto\nPattern:\nBlob $IV = Blob.valueOf('$STRING');...Crypto.decrypt($ONE, $TWO, $IV, $FOUR);", "output": "Vulnerability rule: bad-crypto\nMessage: The rule makes sure you are using randomly generated IVs and keys for Crypto calls. Hard-coding these values greatly compromises the security of encrypted data.\nSeverity: ERROR\nCWE: ['CWE-321: Use of Hard-coded Cryptographic Key']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/encryption/BadCrypto.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: bad-crypto\nPattern:\nBlob $KEY = Blob.valueOf('$STRING');...Crypto.encrypt($ONE, $KEY, $THREE, $FOUR);", "output": "Vulnerability rule: bad-crypto\nMessage: The rule makes sure you are using randomly generated IVs and keys for Crypto calls. Hard-coding these values greatly compromises the security of encrypted data.\nSeverity: ERROR\nCWE: ['CWE-321: Use of Hard-coded Cryptographic Key']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/encryption/BadCrypto.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: bad-crypto\nPattern:\nBlob $KEY = Blob.valueOf('$STRING');...Crypto.decrypt($ONE, $KEY, $THREE, $FOUR);", "output": "Vulnerability rule: bad-crypto\nMessage: The rule makes sure you are using randomly generated IVs and keys for Crypto calls. Hard-coding these values greatly compromises the security of encrypted data.\nSeverity: ERROR\nCWE: ['CWE-321: Use of Hard-coded Cryptographic Key']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/encryption/BadCrypto.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: named-credentials-string-match\nPattern:\n$REQUEST.setHeader('Authorization', $AUTHSTRING);", "output": "Vulnerability rule: named-credentials-string-match\nMessage: Named Credentials (and callout endpoints) should be used instead of hard-coding credentials. 1. Hard-coded credentials are hard to maintain when mixed in with application code. 2. It is particularly hard to update hard-coded credentials when they are used amongst different classes. 3. Granting a developer access to the codebase means granting knowledge of credentials, and thus keeping a two-level access is not possible. 4. Using different credentials for different environments is troublesome and error-prone.\nSeverity: ERROR\nCWE: ['CWE-540: Inclusion of Sensitive Information in Source Code']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/endpoints/NamedCredentialsStringMatch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: system-debug\nPattern:\nSystem.debug(...)", "output": "Vulnerability rule: system-debug\nMessage: In addition to debug statements potentially logging data excessively, debug statements also contribute to longer transactions and consume Apex CPU time even when debug logs are not being captured.\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code', 'CWE-779: Logging of Excessive Data']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/security/ncino/system/SystemDebug.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: avoid-soql-in-loops\nPattern:\n$OBJECTS = [...SELECT...FROM...];\n", "output": "Vulnerability rule: avoid-soql-in-loops\nMessage: Database class methods, DML operations, SOQL queries, SOSL queries, Approval class methods, Email sending, async scheduling or queueing within loops can cause governor limit exceptions. Instead, try to batch up the data into a list and invoke the operation once on that list of data outside the loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/performance/ncino/operationsInLoops/AvoidSoqlInLoops.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: use-assert-class\nPattern:\nSystem\\.assert", "output": "Vulnerability rule: use-assert-class\nMessage: Assert methods in the System class have been replaced with the Assert class: https://developer.salesforce.com/docs/atlas.en-us.apexref.meta/apexref/apex_class_System_Assert.htm\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/best-practice/ncino/tests/UseAssertClass.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): apex\nSemgrep rule id: absolute-urls\nPattern:\n(http|https)://.*(salesforce|force|visualforce)\\.com\\.*", "output": "Vulnerability rule: absolute-urls\nMessage: Using absolute URLs to Salesforce Pages is bug prone. Different sandboxes and production environments will have different instance names (like \"na10\", \"na15\" etc.). Code using absolute URLs will only work when it runs in the corresponding salesforce instances. It will break as soon as it is deployed in another one. Thus only relative URLs, i.e. without the domain and subdomain names, should be used when pointing to a salesforce page.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: apex/lang/best-practice/ncino/urls/AbsoluteUrls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: session-cookie-missing-secure\nPattern:\n&sessions.Options{\n  ...,\n}\n", "output": "Vulnerability rule: session-cookie-missing-secure\nMessage: A session cookie was detected without setting the 'Secure' flag. The 'secure' flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 'Secure' flag by setting 'Secure' to 'true' in the Options struct.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/gorilla/security/audit/session-cookie-missing-secure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: session-cookie-missing-httponly\nPattern:\n&sessions.Options{\n  ...,\n}\n", "output": "Vulnerability rule: session-cookie-missing-httponly\nMessage: A session cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts from reading the cookie which mitigates XSS attacks. Set the 'HttpOnly' flag by setting 'HttpOnly' to 'true' in the Options struct.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/gorilla/security/audit/session-cookie-missing-httponly.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: session-cookie-samesitenone\nPattern:\n&sessions.Options{\n  ...,\n}\n", "output": "Vulnerability rule: session-cookie-samesitenone\nMessage: Found SameSiteNoneMode setting in Gorilla session options. Consider setting SameSite to Lax, Strict or Default for enhanced security.\nSeverity: WARNING\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/gorilla/security/audit/session-cookie-samesitenone.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: grpc-client-insecure-connection\nPattern:\n$GRPC.Dial($ADDR, ..., $GRPC.WithInsecure(...), ...)", "output": "Vulnerability rule: grpc-client-insecure-connection\nMessage: Found an insecure gRPC connection using 'grpc.WithInsecure()'. This creates a connection without encryption to a gRPC server. A malicious attacker could tamper with the gRPC message, which could compromise the machine. Instead, establish a secure connection with an SSL certificate using the 'grpc.WithTransportCredentials()' function. You can create a create credentials using a 'tls.Config{}' struct with 'credentials.NewTLS()'. The final fix looks like this: 'grpc.WithTransportCredentials(credentials.NewTLS(<config>))'.\nSeverity: ERROR\nCWE: ['CWE-300: Channel Accessible by Non-Endpoint']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/grpc/security/grpc-client-insecure-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: go-ssti\nPattern:\n$TEMPLATE = fmt.Sprintf(\"...\", $ARG, ...)", "output": "Vulnerability rule: go-ssti\nMessage: A server-side template injection occurs when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side. When using \"html/template\" always check that user inputs are validated and sanitized before included within the template.\nSeverity: ERROR\nCWE: ['CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/template/security/ssti.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: jwt-go-parse-unverified\nPattern:\n$JWT.ParseUnverified(...)\n", "output": "Vulnerability rule: jwt-go-parse-unverified\nMessage: Detected the decoding of a JWT token without a verify step. Don't use `ParseUnverified` unless you know what you're doing This method parses the token but doesn't validate the signature. It's only ever useful in cases where you know the signature is valid (because it has been checked previously in the stack) and you want to extract values from it.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/jwt-go/security/audit/jwt-parse-unverified.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: path-traversal-inside-zip-extraction\nPattern:\nreader, $ERR := zip.OpenReader($ARCHIVE)\n...\nfor _, $FILE := range reader.File {\n  ...\n  path := filepath.Join($TARGET, $FILE.Name)\n  ...\n}\n", "output": "Vulnerability rule: path-traversal-inside-zip-extraction\nMessage: File traversal when extracting zip archive\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/zip.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: bad-tmp-file-creation\nPattern:\nioutil.WriteFile(\"=~//tmp/.*$/\", ...)", "output": "Vulnerability rule: bad-tmp-file-creation\nMessage: File creation in shared tmp directory without using `io.CreateTemp`.\nSeverity: WARNING\nCWE: ['CWE-377: Insecure Temporary File']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/bad_tmp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: bad-tmp-file-creation\nPattern:\nos.Create(\"=~//tmp/.*$/\", ...)", "output": "Vulnerability rule: bad-tmp-file-creation\nMessage: File creation in shared tmp directory without using `io.CreateTemp`.\nSeverity: WARNING\nCWE: ['CWE-377: Insecure Temporary File']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/bad_tmp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: bad-tmp-file-creation\nPattern:\nos.WriteFile(\"=~//tmp/.*$/\", ...)", "output": "Vulnerability rule: bad-tmp-file-creation\nMessage: File creation in shared tmp directory without using `io.CreateTemp`.\nSeverity: WARNING\nCWE: ['CWE-377: Insecure Temporary File']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/bad_tmp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: dangerous-command-write\nPattern:\n$CW.Write($BYTE)\n", "output": "Vulnerability rule: dangerous-command-write\nMessage: Detected non-static command inside Write. Audit the input to '$CW.Write'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/dangerous-command-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: use-of-unsafe-block\nPattern:\nunsafe.$FUNC(...)", "output": "Vulnerability rule: use-of-unsafe-block\nMessage: Using the unsafe package in Go gives you low-level memory management and many of the strengths of the C language, but also steps around the type safety of Go and can lead to buffer overflows and possible arbitrary code execution by an attacker. Only use this package if you absolutely know what you're doing.\nSeverity: WARNING\nCWE: ['CWE-242: Use of Inherently Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: reflect-makefunc\nPattern:\nreflect.MakeFunc(...)", "output": "Vulnerability rule: reflect-makefunc\nMessage: 'reflect.MakeFunc' detected. This will sidestep protections that are normally afforded by Go's type system. Audit this call and be sure that user input cannot be used to affect the code generated by MakeFunc; otherwise, you will have a serious security vulnerability.\nSeverity: ERROR\nCWE: ['CWE-913: Improper Control of Dynamically-Managed Code Resources']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/reflect-makefunc.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_RSA_WITH_RC4_128_SHA, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_RSA_WITH_3DES_EDE_CBC_SHA, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_RSA_WITH_AES_128_CBC_SHA256, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_ECDHE_RSA_WITH_RC4_128_SHA, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.Config{..., CipherSuites: []$TYPE{..., tls.TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256, ...}}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_RSA_WITH_RC4_128_SHA, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_RSA_WITH_3DES_EDE_CBC_SHA, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_RSA_WITH_AES_128_CBC_SHA256, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_ECDHE_RSA_WITH_RC4_128_SHA, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: tls-with-insecure-cipher\nPattern:\ntls.CipherSuite{..., TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256, ...}\n", "output": "Vulnerability rule: tls-with-insecure-cipher\nMessage: Detected an insecure CipherSuite via the 'tls' module. This suite is considered weak. Use the function 'tls.CipherSuites()' to get a list of good cipher suites. See https://golang.org/pkg/crypto/tls/#InsecureCipherSuites for why and what other cipher suites to use.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: avoid-ssh-insecure-ignore-host-key\nPattern:\nssh.InsecureIgnoreHostKey()", "output": "Vulnerability rule: avoid-ssh-insecure-ignore-host-key\nMessage: Disabled host key verification detected. This allows man-in-the-middle attacks. Use the 'golang.org/x/crypto/ssh/knownhosts' package to do host key verification. See https://skarlso.github.io/2019/02/17/go-ssh-with-host-key-verification/ to learn more about the problem and how to fix it.\nSeverity: WARNING\nCWE: ['CWE-322: Key Exchange without Entity Authentication']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/insecure_ssh.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ssl-v3-is-insecure\nPattern:\ntls.Config{..., MinVersion: $TLS.VersionSSL30, ...}", "output": "Vulnerability rule: ssl-v3-is-insecure\nMessage: SSLv3 is insecure because it has known vulnerabilities. Starting with go1.14, SSLv3 will be removed. Instead, use 'tls.VersionTLS13'.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/ssl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: use-of-rc4\nPattern:\nrc4.NewCipher(...)", "output": "Vulnerability rule: use-of-rc4\nMessage: Detected RC4 cipher algorithm which is insecure. The algorithm has many known vulnerabilities. Use AES instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/use_of_weak_crypto.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: missing-ssl-minversion\nPattern:\ntls.Config{ $...CONF }\n", "output": "Vulnerability rule: missing-ssl-minversion\nMessage: `MinVersion` is missing from this TLS configuration.  By default, as of Go 1.22, TLS 1.2 is currently used as the minimum. General purpose web applications should default to TLS 1.3 with all other protocols disabled.  Only where it is known that a web server must support legacy clients with unsupported an insecure browsers (such as Internet Explorer 10), it may be necessary to enable TLS 1.0 to provide support. Add `MinVersion: tls.VersionTLS13' to the TLS configuration to bump the minimum version to TLS 1.3.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/crypto/missing-ssl-minversion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\ntemplate.JS($T + $X, ...)", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\ntemplate.JS(fmt.$P(\"...\", ...), ...)", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\n$T = \"...\"\n...\n$T = $FXN(..., $T, ...)\n...\ntemplate.JS($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\n$T = fmt.$P(\"...\", ...)\n...\ntemplate.JS($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\n$T, $ERR = fmt.$P(\"...\", ...)\n...\ntemplate.JS($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\n$T = $X + $Y\n...\ntemplate.JS($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-js\nPattern:\n$T = \"...\"\n...\n$OTHER, $ERR = fmt.$P(..., $T, ...)\n...\ntemplate.JS($OTHER, ...)\n", "output": "Vulnerability rule: unescaped-data-in-js\nMessage: Found a formatted template string passed to 'template.JS()'. 'template.JS()' does not escape contents. Be absolutely sure there is no user-controlled data in this template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: use-tls\nPattern:\nhttp.ListenAndServe($ADDR, $HANDLER)", "output": "Vulnerability rule: use-tls\nMessage: Found an HTTP server without TLS. Use 'http.ListenAndServeTLS' instead. See https://golang.org/pkg/net/http/#ListenAndServeTLS for more information.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/use-tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: pprof-debug-exposure\nPattern:\nhttp.ListenAndServe(...)", "output": "Vulnerability rule: pprof-debug-exposure\nMessage: The profiling 'pprof' endpoint is automatically exposed on /debug/pprof. This could leak information about the server. Instead, use `import \"net/http/pprof\"`. See https://www.farsightsecurity.com/blog/txt-record/go-remote-profiling-20161028/ for more information and mitigation.\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: A06:2017 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/pprof.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: cookie-missing-secure\nPattern:\nhttp.Cookie{\n  ...,\n}\n", "output": "Vulnerability rule: cookie-missing-secure\nMessage: A session cookie was detected without setting the 'Secure' flag. The 'secure' flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the 'Secure' flag by setting 'Secure' to 'true' in the Options struct.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/cookie-missing-secure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: dynamic-httptrace-clienttrace\nPattern:\nhttptrace.WithClientTrace($ANY, $TRACE)", "output": "Vulnerability rule: dynamic-httptrace-clienttrace\nMessage: Detected a potentially dynamic ClientTrace. This occurred because semgrep could not find a static definition for '$TRACE'. Dynamic ClientTraces are dangerous because they deserialize function code to run when certain Request events occur, which could lead to code being run without your knowledge. Ensure that your ClientTrace is statically defined.\nSeverity: WARNING\nCWE: ['CWE-913: Improper Control of Dynamically-Managed Code Resources']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/dynamic-httptrace-clienttrace.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\ntemplate.HTMLAttr($T + $X, ...)", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\ntemplate.HTMLAttr(fmt.$P(\"...\", ...), ...)", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\n$T = \"...\"\n...\n$T = $FXN(..., $T, ...)\n...\ntemplate.HTMLAttr($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\n$T = fmt.$P(\"...\", ...)\n...\ntemplate.HTMLAttr($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\n$T, $ERR = fmt.$P(\"...\", ...)\n...\ntemplate.HTMLAttr($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\n$T = $X + $Y\n...\ntemplate.HTMLAttr($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-htmlattr\nPattern:\n$T = \"...\"\n...\n$OTHER, $ERR = fmt.$P(..., $T, ...)\n...\ntemplate.HTMLAttr($OTHER, ...)", "output": "Vulnerability rule: unescaped-data-in-htmlattr\nMessage: Found a formatted template string passed to 'template. HTMLAttr()'. 'template.HTMLAttr()' does not escape contents. Be absolutely sure there is no user-controlled data in this template or validate and sanitize the data before passing it into the template.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-htmlattr.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: cookie-missing-httponly\nPattern:\nhttp.Cookie{\n  ...,\n}\n", "output": "Vulnerability rule: cookie-missing-httponly\nMessage: A session cookie was detected without setting the 'HttpOnly' flag. The 'HttpOnly' flag for cookies instructs the browser to forbid client-side scripts from reading the cookie which mitigates XSS attacks. Set the 'HttpOnly' flag by setting 'HttpOnly' to 'true' in the Cookie.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/cookie-missing-httponly.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\ntemplate.URL($T + $X, ...)", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\ntemplate.URL(fmt.$P(\"...\", ...), ...)", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\n$T = \"...\"\n...\n$T = $FXN(..., $T, ...)\n...\ntemplate.URL($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\n$T = fmt.$P(\"...\", ...)\n...\ntemplate.URL($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\n$T, $ERR = fmt.$P(\"...\", ...)\n...\ntemplate.URL($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\n$T = $X + $Y\n...\ntemplate.URL($T, ...)\n", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: unescaped-data-in-url\nPattern:\n$T = \"...\"\n...\n$OTHER, $ERR = fmt.$P(..., $T, ...)\n...\ntemplate.URL($OTHER, ...)", "output": "Vulnerability rule: unescaped-data-in-url\nMessage: Found a formatted template string passed to 'template.URL()'. 'template.URL()' does not escape contents, and this could result in XSS (cross-site scripting) and therefore confidential data being stolen. Sanitize data coming into this function or make sure that no user-controlled input is coming into the function.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/unescaped-data-in-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\ntls.Listen($NETWORK, \"=~/^0.0.0.0:.*$/\", ...)", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Detected a network listener listening on 0.0.0.0 or an empty string. This could unexpectedly expose the server publicly as it binds to all available interfaces. Instead, specify another IP address that is not 0.0.0.0 nor the empty string.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/bind_all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\nnet.Listen($NETWORK, \"=~/^0.0.0.0:.*$/\", ...)", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Detected a network listener listening on 0.0.0.0 or an empty string. This could unexpectedly expose the server publicly as it binds to all available interfaces. Instead, specify another IP address that is not 0.0.0.0 nor the empty string.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/bind_all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\ntls.Listen($NETWORK, \"=~/^:.*$/\", ...)", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Detected a network listener listening on 0.0.0.0 or an empty string. This could unexpectedly expose the server publicly as it binds to all available interfaces. Instead, specify another IP address that is not 0.0.0.0 nor the empty string.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/bind_all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\nnet.Listen($NETWORK, \"=~/^:.*$/\", ...)", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Detected a network listener listening on 0.0.0.0 or an empty string. This could unexpectedly expose the server publicly as it binds to all available interfaces. Instead, specify another IP address that is not 0.0.0.0 nor the empty string.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/net/bind_all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: parsing-external-entities-enabled\nPattern:\n$PARSER := parser.New(parser.XMLParseNoEnt)", "output": "Vulnerability rule: parsing-external-entities-enabled\nMessage: Detected enabling of \"XMLParseNoEnt\", which allows parsing of external entities and can lead to XXE if user controlled data is parsed by the library. Instead, do not enable \"XMLParseNoEnt\" or be sure to adequately sanitize user-controlled data when it is being parsed by this library.\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xxe/parsing-external-entities-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: no-interpolation-in-tag\nPattern:\n<{{ ... }} ... >", "output": "Vulnerability rule: no-interpolation-in-tag\nMessage: Detected template variable interpolation in an HTML tag. This is potentially vulnerable to cross-site scripting (XSS) attacks because a malicious actor has control over HTML but without the need to use escaped characters. Use explicit tags instead.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/no-interpolation-in-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: import-text-template\nPattern:\nimport \"$IMPORT\"\n", "output": "Vulnerability rule: import-text-template\nMessage: When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/import-text-template.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: no-interpolation-js-template-string\nPattern:\n` ... {{ ... }} ...`", "output": "Vulnerability rule: no-interpolation-js-template-string\nMessage: Detected template variable interpolation in a JavaScript template string. This is potentially vulnerable to cross-site scripting (XSS) attacks because a malicious actor has control over JavaScript but without the need to use escaped characters. Instead, obtain this variable outside of the template string and ensure your template is properly escaped.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/no-interpolation-js-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: no-io-writestring-to-responsewriter\nPattern:\nio.WriteString($WRITER, $STRING)", "output": "Vulnerability rule: no-io-writestring-to-responsewriter\nMessage: Detected 'io.WriteString()' writing directly to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/no-io-writestring-to-responsewriter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: no-printf-in-responsewriter\nPattern:\n$WRITER.Write(<... fmt.$PRINTF(...) ...>, ...)\n", "output": "Vulnerability rule: no-printf-in-responsewriter\nMessage: Detected 'printf' or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/no-printf-in-responsewriter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: no-fprintf-to-responsewriter\nPattern:\nfmt.$PRINTF($WRITER, ...)", "output": "Vulnerability rule: no-fprintf-to-responsewriter\nMessage: Detected 'Fprintf' or similar writing to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/security/audit/xss/no-fprintf-to-responsewriter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: useless-if-conditional\nPattern:\nif ($X) {\n    ...\n} else if ($X) {\n    ...\n}\n", "output": "Vulnerability rule: useless-if-conditional\nMessage: Detected an if block that checks for the same condition on both branches (`$X`). The second condition check is useless as it is the same as the first, and therefore can be removed from the code,\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/maintainability/useless-ifelse.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: useless-if-body\nPattern:\nif ($X) {\n    $S\n} else {\n    $S\n}\n", "output": "Vulnerability rule: useless-if-body\nMessage: Detected identical statements in the if body and the else body of an if-statement. This will lead to the same code being executed no matter what the if-expression evaluates to. Instead, remove the if statement.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/maintainability/useless-ifelse.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: exported_loop_pointer\nPattern:\nfor _, $VALUE := range $SOURCE {\n  <... &($VALUE) ...>\n}\n", "output": "Vulnerability rule: exported_loop_pointer\nMessage: `$VALUE` is a loop pointer that may be exported from the loop. This pointer is shared between loop iterations, so the exported reference will always point to the last loop value, which is likely unintentional. To fix, copy the pointer to a new pointer within the loop.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/looppointer.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: exported_loop_pointer\nPattern:\nfor _, $VALUE := range $SOURCE {\n  <... func() { <... &$VALUE ...> } ...>\n}\n", "output": "Vulnerability rule: exported_loop_pointer\nMessage: `$VALUE` is a loop pointer that may be exported from the loop. This pointer is shared between loop iterations, so the exported reference will always point to the last loop value, which is likely unintentional. To fix, copy the pointer to a new pointer within the loop.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/looppointer.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: exported_loop_pointer\nPattern:\nfor _, $VALUE := range $SOURCE {\n  <... $ANYTHING(..., <... &$VALUE ...>, ...) ...>\n}\n", "output": "Vulnerability rule: exported_loop_pointer\nMessage: `$VALUE` is a loop pointer that may be exported from the loop. This pointer is shared between loop iterations, so the exported reference will always point to the last loop value, which is likely unintentional. To fix, copy the pointer to a new pointer within the loop.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/looppointer.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: hardcoded-eq-true-or-false\nPattern:\nif (true) { ... }", "output": "Vulnerability rule: hardcoded-eq-true-or-false\nMessage: Detected useless if statement. 'if (True)' and 'if (False)' always result in the same behavior, and therefore is not necessary in the code. Remove the 'if (False)' expression completely or just the 'if (True)' comparison depending on which expression is in the code.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/useless-eqeq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: hardcoded-eq-true-or-false\nPattern:\nif (false) { ... }", "output": "Vulnerability rule: hardcoded-eq-true-or-false\nMessage: Detected useless if statement. 'if (True)' and 'if (False)' always result in the same behavior, and therefore is not necessary in the code. Remove the 'if (False)' expression completely or just the 'if (True)' comparison depending on which expression is in the code.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/useless-eqeq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: integer-overflow-int16\nPattern:\n$F, $ERR := strconv.Atoi($NUM)\n...\nint16($F)\n", "output": "Vulnerability rule: integer-overflow-int16\nMessage: Detected conversion of the result of a strconv.Atoi command to an int16. This could lead to an integer overflow, which could possibly result in unexpected behavior and even privilege escalation. Instead, use `strconv.ParseInt`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/overflow/overflow.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: integer-overflow-int32\nPattern:\n$F, $ERR := strconv.Atoi($NUM)\n...\nint32($F)\n", "output": "Vulnerability rule: integer-overflow-int32\nMessage: Detected conversion of the result of a strconv.Atoi command to an int32. This could lead to an integer overflow, which could possibly result in unexpected behavior and even privilege escalation. Instead, use `strconv.ParseInt`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/correctness/overflow/overflow.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: channel-guarded-with-mutex\nPattern:\n$MUX.Lock()\n$VALUE <- $CHANNEL\n$MUX.Unlock()\n", "output": "Vulnerability rule: channel-guarded-with-mutex\nMessage: Detected a channel guarded with a mutex. Channels already have an internal mutex, so this is unnecessary. Remove the mutex. See https://hackmongo.com/page/golang-antipatterns/#guarded-channel for more information.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/best-practice/channel-guarded-with-mutex.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: channel-guarded-with-mutex\nPattern:\n$MUX.Lock()\n$VALUE = <- $CHANNEL\n$MUX.Unlock()\n", "output": "Vulnerability rule: channel-guarded-with-mutex\nMessage: Detected a channel guarded with a mutex. Channels already have an internal mutex, so this is unnecessary. Remove the mutex. See https://hackmongo.com/page/golang-antipatterns/#guarded-channel for more information.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/best-practice/channel-guarded-with-mutex.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: hidden-goroutine\nPattern:\nfunc $FUNC(...) {\n  go func() {\n    ...\n  }(...)\n}\n", "output": "Vulnerability rule: hidden-goroutine\nMessage: Detected a hidden goroutine. Function invocations are expected to synchronous, and this function will execute asynchronously because all it does is call a goroutine. Instead, remove the internal goroutine and call the function using 'go'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/lang/best-practice/hidden-goroutine.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: dangerous-execution\nPattern:\n$VM.Run(...)", "output": "Vulnerability rule: dangerous-execution\nMessage: Detected non-static script inside otto VM. Audit the input to 'VM.Run'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: go/otto/security/audit/dangerous-execution.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-exposed-credentials\nPattern:\njwt.encode({...,\"password\":$P,...},...)\n", "output": "Vulnerability rule: jwt-python-exposed-credentials\nMessage: Password is exposed through JWT token payload. This is not encrypted and the password could be compromised. Do not store passwords in JWT tokens.\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/jwt-exposed-credentials.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-exposed-credentials\nPattern:\n$PAYLOAD = {...,\"password\":$P,...}\n...\njwt.encode($PAYLOAD,...)\n", "output": "Vulnerability rule: jwt-python-exposed-credentials\nMessage: Password is exposed through JWT token payload. This is not encrypted and the password could be compromised. Do not store passwords in JWT tokens.\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/jwt-exposed-credentials.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-none-alg\nPattern:\njwt.encode(...,algorithm=\"none\",...)\n", "output": "Vulnerability rule: jwt-python-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-none-alg\nPattern:\njwt.decode(...,algorithms=[...,\"none\",...],...)", "output": "Vulnerability rule: jwt-python-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-hardcoded-secret\nPattern:\njwt.encode($_, \"...\", ...)\n", "output": "Vulnerability rule: jwt-python-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: jwt-python-exposed-data\nPattern:\njwt.encode($INPUT,...)", "output": "Vulnerability rule: jwt-python-exposed-data\nMessage: The object is passed strictly to jwt.encode(...) Make sure that sensitive information is not exposed through JWT token payload.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jwt/security/audit/jwt-exposed-data.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_send_file_without_path_sanitization\nPattern:\nflask.send_file(filename, ...)", "output": "Vulnerability rule: avoid_send_file_without_path_sanitization\nMessage: Detected a user-controlled `filename` that could flow to `flask.send_file()` function. This could lead to an attacker reading arbitrary file from the system, leaking private information. Make sure to properly sanitize filename or use `flask.send_from_directory`\nSeverity: WARNING\nCWE: ['CWE-73: External Control of File Name or Path']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/secure-static-file-serve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: response-contains-unsanitized-input\nPattern:\n$X = flask.request.args.get(...)\n...\nflask.make_response(\"...\".format($X))\n", "output": "Vulnerability rule: response-contains-unsanitized-input\nMessage: Flask response reflects unsanitized user input. This could lead to a cross-site scripting vulnerability (https://owasp.org/www-community/attacks/xss/) in which an attacker causes arbitrary code to be executed in the user's browser. To prevent, please sanitize the user input, e.g. by rendering the response in a Jinja2 template (see considerations in https://flask.palletsprojects.com/en/1.0.x/security/).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/unsanitized-input.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: response-contains-unsanitized-input\nPattern:\n$X = flask.request.args.get(...)\n...\nflask.make_response(f\"...{$X}...\")\n", "output": "Vulnerability rule: response-contains-unsanitized-input\nMessage: Flask response reflects unsanitized user input. This could lead to a cross-site scripting vulnerability (https://owasp.org/www-community/attacks/xss/) in which an attacker causes arbitrary code to be executed in the user's browser. To prevent, please sanitize the user input, e.g. by rendering the response in a Jinja2 template (see considerations in https://flask.palletsprojects.com/en/1.0.x/security/).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/unsanitized-input.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: response-contains-unsanitized-input\nPattern:\n$X = flask.request.args.get(...)\n...\nflask.make_response(f\"...{$X}\")\n", "output": "Vulnerability rule: response-contains-unsanitized-input\nMessage: Flask response reflects unsanitized user input. This could lead to a cross-site scripting vulnerability (https://owasp.org/www-community/attacks/xss/) in which an attacker causes arbitrary code to be executed in the user's browser. To prevent, please sanitize the user input, e.g. by rendering the response in a Jinja2 template (see considerations in https://flask.palletsprojects.com/en/1.0.x/security/).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/unsanitized-input.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: response-contains-unsanitized-input\nPattern:\n$X = flask.request.args.get(...)\n...\nflask.make_response(f\"{$X}...\")\n", "output": "Vulnerability rule: response-contains-unsanitized-input\nMessage: Flask response reflects unsanitized user input. This could lead to a cross-site scripting vulnerability (https://owasp.org/www-community/attacks/xss/) in which an attacker causes arbitrary code to be executed in the user's browser. To prevent, please sanitize the user input, e.g. by rendering the response in a Jinja2 template (see considerations in https://flask.palletsprojects.com/en/1.0.x/security/).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/unsanitized-input.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\".format(...)\n...\nflask.render_template_string($V, ...)\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\".format(...)\n...\nreturn flask.render_template_string($V, ...), $MORE\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\" % $S\n...\nflask.render_template_string($V, ...)\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\" % $S\n...\nreturn flask.render_template_string($V, ...), $MORE\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\"\n...\n$V += $O\n...\nflask.render_template_string($V, ...)\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = \"...\"\n...\n$V += $O\n...\nreturn flask.render_template_string($V, ...), $MORE\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = f\"...{$X}...\"\n...\nflask.render_template_string($V, ...)\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-template-string\nPattern:\n$V = f\"...{$X}...\"\n...\nreturn flask.render_template_string($V, ...), $CODE\n", "output": "Vulnerability rule: dangerous-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/dangerous-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hashids-with-flask-secret\nPattern:\nhashids.Hashids(..., salt=flask.current_app.config['SECRET_KEY'], ...)", "output": "Vulnerability rule: hashids-with-flask-secret\nMessage: The Flask secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Flask secret key can be obtained by attackers, through the HashIDs.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A02:2021  Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/hashids-with-flask-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hashids-with-flask-secret\nPattern:\nhashids.Hashids(flask.current_app.config['SECRET_KEY'], ...)", "output": "Vulnerability rule: hashids-with-flask-secret\nMessage: The Flask secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Flask secret key can be obtained by attackers, through the HashIDs.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A02:2021  Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/hashids-with-flask-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: direct-use-of-jinja2\nPattern:\njinja2.Environment(...)", "output": "Vulnerability rule: direct-use-of-jinja2\nMessage: Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/direct-use-of-jinja2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: direct-use-of-jinja2\nPattern:\njinja2.Template.render(...)", "output": "Vulnerability rule: direct-use-of-jinja2\nMessage: Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/direct-use-of-jinja2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: template-unquoted-attribute-var\nPattern:\n={{$...VAR}}", "output": "Vulnerability rule: template-unquoted-attribute-var\nMessage: Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: \"{{ $...VAR }}\".\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/template-unquoted-attribute-var.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: explicit-unescape-with-markup\nPattern:\nflask.Markup.unescape(...)", "output": "Vulnerability rule: explicit-unescape-with-markup\nMessage: Detected explicitly unescaped content using 'Markup()'. This permits the unescaped data to include unescaped HTML which could result in cross-site scripting. Ensure this data is not externally controlled, or consider rewriting to not use 'Markup()'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/explicit-unescape-with-markup.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: explicit-unescape-with-markup\nPattern:\n$MARKUPOBJ.unescape()", "output": "Vulnerability rule: explicit-unescape-with-markup\nMessage: Detected explicitly unescaped content using 'Markup()'. This permits the unescaped data to include unescaped HTML which could result in cross-site scripting. Ensure this data is not externally controlled, or consider rewriting to not use 'Markup()'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/explicit-unescape-with-markup.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-unescaped-with-safe\nPattern:\n{{.*?\\|\\s*safe(\\s*}})?", "output": "Vulnerability rule: template-unescaped-with-safe\nMessage: Detected a segment of a Flask template where autoescaping is explicitly disabled with '| safe' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/template-unescaped-with-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-autoescape-off\nPattern:\n{%\\s*autoescape\\s+false\\s*%}", "output": "Vulnerability rule: template-autoescape-off\nMessage: Detected a segment of a Flask template where autoescaping is explicitly disabled with '{% autoescape off %}'. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability, or turn autoescape on.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/xss/audit/template-autoescape-off.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: debug-enabled\nPattern:\n$APP.run(..., debug=True, ...)", "output": "Vulnerability rule: debug-enabled\nMessage: Detected Flask app with debug=True. Do not deploy to production with this flag enabled as it will leak sensitive information. Instead, consider using Flask configuration variables or setting 'debug' using system environment variables.\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: A06:2017 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/debug-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_app_run_with_bad_host\nPattern:\napp.run(..., host=\"0.0.0.0\", ...)", "output": "Vulnerability rule: avoid_app_run_with_bad_host\nMessage: Running flask app with host 0.0.0.0 could expose the server publicly.\nSeverity: WARNING\nCWE: ['CWE-668: Exposure of Resource to Wrong Sphere']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/app-run-param-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_app_run_with_bad_host\nPattern:\napp.run(..., \"0.0.0.0\", ...)", "output": "Vulnerability rule: avoid_app_run_with_bad_host\nMessage: Running flask app with host 0.0.0.0 could expose the server publicly.\nSeverity: WARNING\nCWE: ['CWE-668: Exposure of Resource to Wrong Sphere']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/app-run-param-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: secure-set-cookie\nPattern:\n$RESP.set_cookie(...)", "output": "Vulnerability rule: secure-set-cookie\nMessage: Found a Flask cookie with insecurely configured properties.  By default the secure, httponly and samesite ar configured insecurely. cookies should be handled securely by setting `secure=True`, `httponly=True`, and `samesite='Lax'` in response.set_cookie(...). If these parameters are not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker. Include the `secure=True`, `httponly=True`, `samesite='Lax'` arguments or set these to be true in the Flask configuration.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/secure-set-cookie.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_using_app_run_directly\nPattern:\napp.run(...)", "output": "Vulnerability rule: avoid_using_app_run_directly\nMessage: top-level app.run(...) is ignored by flask. Consider putting app.run(...) behind a guard, like inside a function\nSeverity: WARNING\nCWE: ['CWE-668: Exposure of Resource to Wrong Sphere']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/app-run-security-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_TESTING\nPattern:\n$M.config['TESTING'] = True", "output": "Vulnerability rule: avoid_hardcoded_config_TESTING\nMessage: Hardcoded variable `TESTING` detected. Use environment variables or config files instead\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_TESTING\nPattern:\n$M.config['TESTING'] = False", "output": "Vulnerability rule: avoid_hardcoded_config_TESTING\nMessage: Hardcoded variable `TESTING` detected. Use environment variables or config files instead\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_TESTING\nPattern:\n$M.update(TESTING=True, ...)", "output": "Vulnerability rule: avoid_hardcoded_config_TESTING\nMessage: Hardcoded variable `TESTING` detected. Use environment variables or config files instead\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_TESTING\nPattern:\n$M.update(TESTING=False, ...)", "output": "Vulnerability rule: avoid_hardcoded_config_TESTING\nMessage: Hardcoded variable `TESTING` detected. Use environment variables or config files instead\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_SECRET_KEY\nPattern:\n$M.update(SECRET_KEY=\"=~/.*/\")", "output": "Vulnerability rule: avoid_hardcoded_config_SECRET_KEY\nMessage: Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead\nSeverity: ERROR\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_SECRET_KEY\nPattern:\n$M.config['SECRET_KEY'] = \"=~/.*/\"", "output": "Vulnerability rule: avoid_hardcoded_config_SECRET_KEY\nMessage: Hardcoded variable `SECRET_KEY` detected. Use environment variables or config files instead\nSeverity: ERROR\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_ENV\nPattern:\n$M.update(ENV=\"=~/^development|production$/\")", "output": "Vulnerability rule: avoid_hardcoded_config_ENV\nMessage: Hardcoded variable `ENV` detected. Set this by using FLASK_ENV environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_ENV\nPattern:\n$M.config['ENV'] = \"=~/^development|production$/\"", "output": "Vulnerability rule: avoid_hardcoded_config_ENV\nMessage: Hardcoded variable `ENV` detected. Set this by using FLASK_ENV environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_DEBUG\nPattern:\n$M.update(DEBUG=True)", "output": "Vulnerability rule: avoid_hardcoded_config_DEBUG\nMessage: Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_DEBUG\nPattern:\n$M.update(DEBUG=False)", "output": "Vulnerability rule: avoid_hardcoded_config_DEBUG\nMessage: Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_DEBUG\nPattern:\n$M.config['DEBUG'] = True", "output": "Vulnerability rule: avoid_hardcoded_config_DEBUG\nMessage: Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid_hardcoded_config_DEBUG\nPattern:\n$M.config['DEBUG'] = False", "output": "Vulnerability rule: avoid_hardcoded_config_DEBUG\nMessage: Hardcoded variable `DEBUG` detected. Set this by using FLASK_DEBUG environment variable\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/hardcoded-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: render-template-string\nPattern:\nflask.render_template_string(...)", "output": "Vulnerability rule: render-template-string\nMessage: Found a template created with string formatting. This is susceptible to server-side template injection and cross-site scripting attacks.\nSeverity: WARNING\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/render-template-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: make-response-with-unknown-content\nPattern:\nflask.make_response(...)", "output": "Vulnerability rule: make-response-with-unknown-content\nMessage: Be careful with `flask.make_response()`. If this response is rendered onto a webpage, this could create a cross-site scripting (XSS) vulnerability. `flask.make_response()` will not autoescape HTML. If you are rendering HTML, write your HTML in a template file and use `flask.render_template()` which will take care of escaping. If you are returning data from an API, consider using `flask.jsonify()`.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/audit/xss/make-response-with-unknown-content.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: path-traversal-open\nPattern:\nopen(..., <... flask.request.$W.get(...) ...>, ...)", "output": "Vulnerability rule: path-traversal-open\nMessage: Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks.\nSeverity: ERROR\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/path-traversal-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: path-traversal-open\nPattern:\nopen(..., <... flask.request.$W[...] ...>, ...)", "output": "Vulnerability rule: path-traversal-open\nMessage: Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks.\nSeverity: ERROR\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/path-traversal-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: path-traversal-open\nPattern:\nopen(..., <... flask.request.$W(...) ...>, ...)", "output": "Vulnerability rule: path-traversal-open\nMessage: Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks.\nSeverity: ERROR\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/path-traversal-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: path-traversal-open\nPattern:\nopen(..., <... flask.request.$W ...>, ...)", "output": "Vulnerability rule: path-traversal-open\nMessage: Found request data in a call to 'open'. Ensure the request data is validated or sanitized, otherwise it could result in path traversal attacks.\nSeverity: ERROR\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/path-traversal-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: ssrf-requests\nPattern:\nrequests.$FUNC(..., <... flask.request.$W.get(...) ...>, ...)", "output": "Vulnerability rule: ssrf-requests\nMessage: Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.\nSeverity: ERROR\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/ssrf-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: ssrf-requests\nPattern:\nrequests.$FUNC(..., <... flask.request.$W[...] ...>, ...)", "output": "Vulnerability rule: ssrf-requests\nMessage: Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.\nSeverity: ERROR\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/ssrf-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: ssrf-requests\nPattern:\nrequests.$FUNC(..., <... flask.request.$W(...) ...>, ...)", "output": "Vulnerability rule: ssrf-requests\nMessage: Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.\nSeverity: ERROR\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/ssrf-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: ssrf-requests\nPattern:\nrequests.$FUNC(..., <... flask.request.$W ...>, ...)", "output": "Vulnerability rule: ssrf-requests\nMessage: Data from request object is passed to a new server-side request. This could lead to a server-side request forgery (SSRF). To mitigate, ensure that schemes and hosts are validated against an allowlist, do not forward the response to the user, and ensure proper authentication and transport-layer security in the proxied request.\nSeverity: ERROR\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/ssrf-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eval-injection\nPattern:\neval(..., <... flask.request.$W.get(...) ...>, ...)", "output": "Vulnerability rule: eval-injection\nMessage: Detected user data flowing into eval. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eval-injection\nPattern:\neval(..., <... flask.request.$W[...] ...>, ...)", "output": "Vulnerability rule: eval-injection\nMessage: Detected user data flowing into eval. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eval-injection\nPattern:\neval(..., <... flask.request.$W(...) ...>, ...)", "output": "Vulnerability rule: eval-injection\nMessage: Detected user data flowing into eval. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eval-injection\nPattern:\neval(..., <... flask.request.$W ...>, ...)", "output": "Vulnerability rule: eval-injection\nMessage: Detected user data flowing into eval. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: exec-injection\nPattern:\nexec(..., <... flask.request.$W.get(...) ...>, ...)", "output": "Vulnerability rule: exec-injection\nMessage: Detected user data flowing into exec. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-exec.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: exec-injection\nPattern:\nexec(..., <... flask.request.$W[...] ...>, ...)", "output": "Vulnerability rule: exec-injection\nMessage: Detected user data flowing into exec. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-exec.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: exec-injection\nPattern:\nexec(..., <... flask.request.$W(...) ...>, ...)", "output": "Vulnerability rule: exec-injection\nMessage: Detected user data flowing into exec. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-exec.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: exec-injection\nPattern:\nexec(..., <... flask.request.$W ...>, ...)", "output": "Vulnerability rule: exec-injection\nMessage: Detected user data flowing into exec. This is code injection and should be avoided.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/user-exec.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: os-system-injection\nPattern:\nos.system(..., <... flask.request.$W.get(...) ...>, ...)", "output": "Vulnerability rule: os-system-injection\nMessage: User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/os-system-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: os-system-injection\nPattern:\nos.system(..., <... flask.request.$W[...] ...>, ...)", "output": "Vulnerability rule: os-system-injection\nMessage: User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/os-system-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: os-system-injection\nPattern:\nos.system(..., <... flask.request.$W(...) ...>, ...)", "output": "Vulnerability rule: os-system-injection\nMessage: User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/os-system-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: os-system-injection\nPattern:\nos.system(..., <... flask.request.$W ...>, ...)", "output": "Vulnerability rule: os-system-injection\nMessage: User data detected in os.system. This could be vulnerable to a command injection and should be avoided. If this must be done, use the 'subprocess' module instead and pass the arguments as a list.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/security/injection/os-system-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.open_session(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.save_session(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.make_null_session(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.init_jinja_globals(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.request_globals_class(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\n$F = Flask(...)\n...\n$F.static_path(...)\n", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.open_session(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.save_session(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.make_null_session(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.init_jinja_globals(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.request_globals_class(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.static_path(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\napp.config.from_json(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\nflask.json_available", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\nflask.request.module", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-deprecated-apis\nPattern:\nflask.testing.make_test_environ_builder(...)", "output": "Vulnerability rule: flask-deprecated-apis\nMessage: deprecated Flask API\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/maintainability/deprecated/deprecated-apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: flask-duplicate-handler-name\nPattern:\n@app.route(\"...\", ...)\ndef $R(...):\n    ...\n...\n@app.route(\"...\", ...)\ndef $R(...):\n    ...\n", "output": "Vulnerability rule: flask-duplicate-handler-name\nMessage: Looks like `$R` is a flask function handler that registered to two different routes. This will cause a runtime error\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/correctness/same-handler-name.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-jsonify\nPattern:\n$JSONDUMPS", "output": "Vulnerability rule: use-jsonify\nMessage: flask.jsonify() is a Flask helper method which handles the correct  settings for returning JSON from Flask routes\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/flask/best-practice/use-jsonify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md4\nPattern:\nCrypto.Hash.MD4.new(...)", "output": "Vulnerability rule: insecure-hash-algorithm-md4\nMessage: Detected MD4 hash algorithm which is considered insecure. MD4 is not collision resistant and is therefore not suitable as a cryptographic signature. Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md4\nPattern:\nCryptodome.Hash.MD4.new (...)", "output": "Vulnerability rule: insecure-hash-algorithm-md4\nMessage: Detected MD4 hash algorithm which is considered insecure. MD4 is not collision resistant and is therefore not suitable as a cryptographic signature. Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md5\nPattern:\nCrypto.Hash.MD5.new(...)", "output": "Vulnerability rule: insecure-hash-algorithm-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md5\nPattern:\nCryptodome.Hash.MD5.new (...)", "output": "Vulnerability rule: insecure-hash-algorithm-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-rc2\nPattern:\nCryptodome.Cipher.ARC2.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-rc2\nMessage: Detected RC2 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-rc2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-rc2\nPattern:\nCrypto.Cipher.ARC2.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-rc2\nMessage: Detected RC2 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-rc2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-blowfish\nPattern:\nCryptodome.Cipher.Blowfish.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-blowfish\nMessage: Detected Blowfish cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-blowfish.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-blowfish\nPattern:\nCrypto.Cipher.Blowfish.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-blowfish\nMessage: Detected Blowfish cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-blowfish.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md2\nPattern:\nCrypto.Hash.MD2.new(...)", "output": "Vulnerability rule: insecure-hash-algorithm-md2\nMessage: Detected MD2 hash algorithm which is considered insecure. MD2 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md2\nPattern:\nCryptodome.Hash.MD2.new (...)", "output": "Vulnerability rule: insecure-hash-algorithm-md2\nMessage: Detected MD2 hash algorithm which is considered insecure. MD2 is not collision resistant and is therefore not suitable as a cryptographic signature.  Use a modern hash algorithm from the SHA-2, SHA-3, or BLAKE2 family instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm-md2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-xor\nPattern:\nCryptodome.Cipher.XOR.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-xor\nMessage: Detected XOR cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use AES instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-xor\nPattern:\nCrypto.Cipher.XOR.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-xor\nMessage: Detected XOR cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use AES instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-rc4\nPattern:\nCryptodome.Cipher.ARC4.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-rc4\nMessage: Detected ARC4 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-rc4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-rc4\nPattern:\nCrypto.Cipher.ARC4.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-rc4\nMessage: Detected ARC4 cipher algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-rc4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-sha1\nPattern:\nCrypto.Hash.SHA.new(...)", "output": "Vulnerability rule: insecure-hash-algorithm-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-sha1\nPattern:\nCryptodome.Hash.SHA.new (...)", "output": "Vulnerability rule: insecure-hash-algorithm-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-hash-algorithm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-des\nPattern:\nCryptodome.Cipher.DES.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-des\nMessage: Detected DES cipher or Triple DES algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use a secure symmetric cipher from the cryptodome package instead. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-des.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-des\nPattern:\nCrypto.Cipher.DES.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-des\nMessage: Detected DES cipher or Triple DES algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use a secure symmetric cipher from the cryptodome package instead. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-des.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-des\nPattern:\nCryptodome.Cipher.DES3.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-des\nMessage: Detected DES cipher or Triple DES algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use a secure symmetric cipher from the cryptodome package instead. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-des.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-des\nPattern:\nCrypto.Cipher.DES3.new(...)", "output": "Vulnerability rule: insecure-cipher-algorithm-des\nMessage: Detected DES cipher or Triple DES algorithm which is considered insecure. This algorithm is not cryptographically secure and can be reversed easily. Use a secure symmetric cipher from the cryptodome package instead. Use secure stream ciphers such as ChaCha20, XChaCha20 and Salsa20, or a block cipher such as AES with a block size of 128 bits. When using a block cipher, use a modern mode of operation that also provides authentication, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pycryptodome/security/insecure-cipher-algorithm-des.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: bokeh-deprecated-apis\nPattern:\nimport bokeh.layouts.widgetbox\n", "output": "Vulnerability rule: bokeh-deprecated-apis\nMessage: These APIs are deprecated in Bokeh see https://docs.bokeh.org/en/latest/docs/releases.html#api-deprecations\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/bokeh/maintainability/deprecated/deprecated_apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: bokeh-deprecated-apis\nPattern:\nimport bokeh.models.graphs.from_networkx\n", "output": "Vulnerability rule: bokeh-deprecated-apis\nMessage: These APIs are deprecated in Bokeh see https://docs.bokeh.org/en/latest/docs/releases.html#api-deprecations\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/bokeh/maintainability/deprecated/deprecated_apis.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: require-encryption\nPattern:\ndistributed.security.Security(..., require_encryption=$VAL, ...)\n", "output": "Vulnerability rule: require-encryption\nMessage: Initializing a security context for Dask (`distributed`) without \"require_encryption\" keyword argument may silently fail to provide security.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/distributed/security.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: incorrect-autoescape-disabled\nPattern:\njinja2.Environment(... , autoescape=$VAL, ...)", "output": "Vulnerability rule: incorrect-autoescape-disabled\nMessage: Detected a Jinja2 environment with 'autoescaping' disabled. This is dangerous if you are rendering to a browser because this allows for cross-site scripting (XSS) attacks. If you are in a web context, enable 'autoescaping' by setting 'autoescape=True.' You may also consider using 'jinja2.select_autoescape()' to only enable automatic escaping for certain file extensions.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jinja2/security/audit/autoescape-disabled-false.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: missing-autoescape-disabled\nPattern:\njinja2.Environment(...)", "output": "Vulnerability rule: missing-autoescape-disabled\nMessage: Detected a Jinja2 environment without autoescaping. Jinja2 does not autoescape by default. This is dangerous if you are rendering to a browser because this allows for cross-site scripting (XSS) attacks. If you are in a web context, enable autoescaping by setting 'autoescape=True.' You may also consider using 'jinja2.select_autoescape()' to only enable automatic escaping for certain file extensions.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/jinja2/security/audit/missing-autoescape-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insufficient-ec-key-size\nPattern:\ncryptography.hazmat.primitives.asymmetric.ec.$SIZE", "output": "Vulnerability rule: insufficient-ec-key-size\nMessage: Detected an insufficient curve size for EC. NIST recommends a key size of 224 or higher. For example, use 'ec.SECP256R1'.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insufficient-ec-key-size.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-sha1\nPattern:\ncryptography.hazmat.primitives.hashes.$SHA(...)", "output": "Vulnerability rule: insecure-hash-algorithm-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-hash-algorithms.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-mode-ecb\nPattern:\ncryptography.hazmat.primitives.ciphers.modes.ECB($IV)", "output": "Vulnerability rule: insecure-cipher-mode-ecb\nMessage: ECB (Electronic Code Book) is the simplest mode of operation for block ciphers.  Each block of data is encrypted in the same way.  This means identical plaintext blocks will always result in identical ciphertext blocks, which can leave significant patterns in the output. Use a different, cryptographically strong mode instead, such as GCM.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-cipher-mode-ecb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-blowfish\nPattern:\ncryptography.hazmat.primitives.ciphers.algorithms.$BLOWFISH($KEY)", "output": "Vulnerability rule: insecure-cipher-algorithm-blowfish\nMessage: Blowfish is a block cipher developed by Bruce Schneier. It is known to be susceptible to attacks when using weak keys.  The author has recommended that users of Blowfish move to newer algorithms such as AES. With the `cryptography` package it is recommended to use `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-cipher-algorithms-blowfish.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-arc4\nPattern:\ncryptography.hazmat.primitives.ciphers.algorithms.$ARC4($KEY)", "output": "Vulnerability rule: insecure-cipher-algorithm-arc4\nMessage: ARC4 (Alleged RC4) is a stream cipher with serious weaknesses in its initial stream output.  Its use is strongly discouraged. ARC4 does not use mode constructions. Use a strong symmetric cipher such as EAS instead. With the `cryptography` package it is recommended to use the `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-cipher-algorithms-arc4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md5\nPattern:\ncryptography.hazmat.primitives.hashes.$MD5()", "output": "Vulnerability rule: insecure-hash-algorithm-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-hash-algorithms-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: empty-aes-key\nPattern:\nAES.new(\"\",...)", "output": "Vulnerability rule: empty-aes-key\nMessage: Potential empty AES encryption key. Using an empty key in AES encryption can result in weak encryption and may allow attackers to easily decrypt sensitive data. Ensure that a strong, non-empty key is used for AES encryption.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm', 'CWE-310: Cryptographic Issues']\nOWASP: A6:2017 misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/empty-aes-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-cipher-algorithm-idea\nPattern:\ncryptography.hazmat.primitives.ciphers.algorithms.$IDEA($KEY)", "output": "Vulnerability rule: insecure-cipher-algorithm-idea\nMessage: IDEA (International Data Encryption Algorithm) is a block cipher created in 1991.  It is an optional component of the OpenPGP standard. This cipher is susceptible to attacks when using weak keys.  It is recommended that you do not use this cipher for new applications. Use a strong symmetric cipher such as EAS instead. With the `cryptography` package it is recommended to use `Fernet` which is a secure implementation of AES in CBC mode with a 128-bit key.  Alternatively, keep using the `Cipher` class from the hazmat primitives but use the AES algorithm instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/cryptography/security/insecure-cipher-algorithms.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-csrf-check-disabled-globally\nPattern:\n$REQUIRE_CSRF", "output": "Vulnerability rule: pyramid-csrf-check-disabled-globally\nMessage: Automatic check of cross-site request forgery tokens has been explicitly disabled globally, which might leave views unprotected. Use 'pyramid.config.Configurator.set_default_csrf_options(require_csrf=True)' to turn the automatic check for all unsafe methods (per RFC2616).\nSeverity: ERROR\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/security/csrf-check-disabled-globally.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-authtkt-cookie-secure-unsafe-value\nPattern:\n$SECURE", "output": "Vulnerability rule: pyramid-authtkt-cookie-secure-unsafe-value\nMessage: Found a Pyramid Authentication Ticket cookie without the secure option correctly set. Pyramid cookies should be handled securely by setting secure=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/authtkt-cookie-secure-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-samesite-unsafe-value\nPattern:\n$RESPONSE.set_cookie(..., samesite=$SAMESITE, ...)", "output": "Vulnerability rule: pyramid-set-cookie-samesite-unsafe-value\nMessage: Found a Pyramid cookie without the samesite option correctly set. Pyramid cookies should be handled securely by setting samesite='Lax' in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-samesite-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-samesite-unsafe-value\nPattern:\n$SAMESITE", "output": "Vulnerability rule: pyramid-set-cookie-samesite-unsafe-value\nMessage: Found a Pyramid cookie without the samesite option correctly set. Pyramid cookies should be handled securely by setting samesite='Lax' in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-samesite-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-httponly-unsafe-value\nPattern:\n$RESPONSE.set_cookie(..., httponly=$HTTPONLY, ...)", "output": "Vulnerability rule: pyramid-set-cookie-httponly-unsafe-value\nMessage: Found a Pyramid cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-httponly-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-httponly-unsafe-value\nPattern:\n$HTTPONLY", "output": "Vulnerability rule: pyramid-set-cookie-httponly-unsafe-value\nMessage: Found a Pyramid cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-httponly-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-csrf-check-disabled\nPattern:\n$REQUIRE_CSRF", "output": "Vulnerability rule: pyramid-csrf-check-disabled\nMessage: CSRF protection is disabled for this view. This is a security risk.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/csrf-check-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-authtkt-cookie-httponly-unsafe-value\nPattern:\n$HTTPONLY", "output": "Vulnerability rule: pyramid-authtkt-cookie-httponly-unsafe-value\nMessage: Found a Pyramid Authentication Ticket cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/authtkt-cookie-httponly-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-authtkt-cookie-httponly-unsafe-default\nPattern:\npyramid.authentication.$FUNC($...PARAMS)", "output": "Vulnerability rule: pyramid-authtkt-cookie-httponly-unsafe-default\nMessage: Found a Pyramid Authentication Ticket cookie without the httponly option correctly set. Pyramid cookies should be handled securely by setting httponly=True. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/authtkt-cookie-httponly-unsafe-default.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-secure-unsafe-default\nPattern:\n$RESPONSE.set_cookie(...)", "output": "Vulnerability rule: pyramid-set-cookie-secure-unsafe-default\nMessage: Found a Pyramid cookie using an unsafe default for the secure option. Pyramid cookies should be handled securely by setting secure=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-secure-unsafe-default.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-csrf-origin-check-disabled\nPattern:\n$CHECK_ORIGIN", "output": "Vulnerability rule: pyramid-csrf-origin-check-disabled\nMessage: Origin check for the CSRF token is disabled for this view. This might represent a security risk if the CSRF storage policy is not known to be secure.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/csrf-origin-check-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-csrf-origin-check-disabled-globally\nPattern:\n$CHECK_ORIGIN", "output": "Vulnerability rule: pyramid-csrf-origin-check-disabled-globally\nMessage: Automatic check of the referrer for cross-site request forgery tokens has been explicitly disabled globally, which might leave views unprotected when an unsafe CSRF storage policy is used. Use 'pyramid.config.Configurator.set_default_csrf_options(check_origin=True)' to turn the automatic check for all unsafe methods (per RFC2616).\nSeverity: ERROR\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/csrf-origin-check-disabled-globally.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-authtkt-cookie-samesite\nPattern:\n$SAMESITE", "output": "Vulnerability rule: pyramid-authtkt-cookie-samesite\nMessage: Found a Pyramid Authentication Ticket without the samesite option correctly set. Pyramid cookies should be handled securely by setting samesite='Lax'. If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/authtkt-cookie-samesite.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-secure-unsafe-value\nPattern:\n$RESPONSE.set_cookie(..., secure=$SECURE, ...)", "output": "Vulnerability rule: pyramid-set-cookie-secure-unsafe-value\nMessage: Found a Pyramid cookie without the secure option correctly set. Pyramid cookies should be handled securely by setting secure=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-secure-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-secure-unsafe-value\nPattern:\n$SECURE", "output": "Vulnerability rule: pyramid-set-cookie-secure-unsafe-value\nMessage: Found a Pyramid cookie without the secure option correctly set. Pyramid cookies should be handled securely by setting secure=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-secure-unsafe-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-httponly-unsafe-default\nPattern:\n$RESPONSE.set_cookie(...)", "output": "Vulnerability rule: pyramid-set-cookie-httponly-unsafe-default\nMessage: Found a Pyramid cookie using an unsafe default for the httponly option. Pyramid cookies should be handled securely by setting httponly=True in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-httponly-unsafe-default.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pyramid-set-cookie-samesite-unsafe-default\nPattern:\n$RESPONSE.set_cookie(...)", "output": "Vulnerability rule: pyramid-set-cookie-samesite-unsafe-default\nMessage: Found a Pyramid cookie using an unsafe value for the samesite option. Pyramid cookies should be handled securely by setting samesite='Lax' in response.set_cookie(...). If this parameter is not properly set, your cookies are not properly protected and are at risk of being stolen by an attacker.\nSeverity: WARNING\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pyramid/audit/set-cookie-samesite-unsafe-default.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-click-secho\nPattern:\nclick.echo(click.style($X, ...))", "output": "Vulnerability rule: use-click-secho\nMessage: Use `click.secho($X)` instead. It combines click.echo() and click.style().\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/click/best-practice/echo-style.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sqlalchemy-execute-raw-query\nPattern:\n$CONNECTION.execute( $SQL + ..., ... )\n", "output": "Vulnerability rule: sqlalchemy-execute-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/security/sqlalchemy-execute-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sqlalchemy-execute-raw-query\nPattern:\n$CONNECTION.execute( $SQL % (...), ...)\n", "output": "Vulnerability rule: sqlalchemy-execute-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/security/sqlalchemy-execute-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sqlalchemy-execute-raw-query\nPattern:\n$CONNECTION.execute( $SQL.format(...), ... )\n", "output": "Vulnerability rule: sqlalchemy-execute-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/security/sqlalchemy-execute-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sqlalchemy-execute-raw-query\nPattern:\n$CONNECTION.execute(f\"...{...}...\", ...)\n", "output": "Vulnerability rule: sqlalchemy-execute-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. In order to execute raw query safely, prepared statement should be used. SQLAlchemy provides TextualSQL to easily used prepared statement with named parameters. For complex SQL composition, use SQL Expression Language or Schema Definition Language. In most cases, SQLAlchemy ORM will be a better option.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/security/sqlalchemy-execute-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: delete-where-no-execute\nPattern:\n$X.delete().where(...)", "output": "Vulnerability rule: delete-where-no-execute\nMessage: .delete().where(...) results in a no-op in SQLAlchemy unless the command is executed, use .filter(...).delete() instead.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/correctness/delete-where.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: len-all-count\nPattern:\nlen($X.all())", "output": "Vulnerability rule: len-all-count\nMessage: Using QUERY.count() instead of len(QUERY.all()) sends less data to the client since the SQLAlchemy method is performed server-side.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/performance/performance-improvements.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: batch-import\nPattern:\nfor $X in $Y:\n  db.session.add($Z)\n", "output": "Vulnerability rule: batch-import\nMessage: Rather than adding one element at a time, consider batch loading to improve performance.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sqlalchemy/performance/performance-improvements.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: mongo-client-bad-auth\nPattern:\npymongo.MongoClient(..., authMechanism='MONGODB-CR')\n", "output": "Vulnerability rule: mongo-client-bad-auth\nMessage: Warning MONGODB-CR was deprecated with the release of MongoDB 3.6 and is no longer supported by MongoDB 4.0 (see https://api.mongodb.com/python/current/examples/authentication.html for details).\nSeverity: WARNING\nCWE: ['CWE-477: Use of Obsolete Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/pymongo/security/mongodb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.put(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.patch(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.delete(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.head(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.options(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.request(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.get(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: disabled-cert-validation\nPattern:\nrequests.post(..., verify=False, ...)", "output": "Vulnerability rule: disabled-cert-validation\nMessage: Certificate verification has been explicitly disabled. This permits insecure connections to insecure servers. Re-enable certification validation.\nSeverity: ERROR\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-auth-over-http\nPattern:\nrequests.$W(\"=~/http:\\/\\/.*/\", ..., auth=$X, ...)", "output": "Vulnerability rule: no-auth-over-http\nMessage: Authentication detected over HTTP. HTTP does not provide any encryption or protection for these authentication credentials. This may expose these credentials to unauthorized parties. Use 'https://' instead.\nSeverity: ERROR\nCWE: ['CWE-523: Unprotected Transport of Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/no-auth-over-http.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-auth-over-http\nPattern:\n$URL = \"=~/http:\\/\\/.../\"\n...\nrequests.$W($URL, ..., auth=$X, ...)\n", "output": "Vulnerability rule: no-auth-over-http\nMessage: Authentication detected over HTTP. HTTP does not provide any encryption or protection for these authentication credentials. This may expose these credentials to unauthorized parties. Use 'https://' instead.\nSeverity: ERROR\nCWE: ['CWE-523: Unprotected Transport of Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/security/no-auth-over-http.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python.requests.best-practice.use-response-json-shortcut\nPattern:\njson.loads($RESP.text)", "output": "Vulnerability rule: python.requests.best-practice.use-response-json-shortcut\nMessage: The requests library has a convenient shortcut for reading JSON responses, which lets you stop worrying about deserializing the response yourself.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/best-practice/use-response-json-shortcut.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python.requests.best-practice.use-request-json-shortcut\nPattern:\nrequests.$METHOD(..., body=json.dumps($BODY), ...)", "output": "Vulnerability rule: python.requests.best-practice.use-request-json-shortcut\nMessage: The requests library has a convenient shortcut for sending JSON requests, which lets you stop worrying about serializing the body yourself. To use it, replace `body=json.dumps(...)` with `json=...`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/requests/best-practice/use-request-json-shortcut.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\nairflow.operators.bash_operator.BashOperator(..., bash_command=\"...\" + $CONCAT, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\nairflow.operators.bash_operator.BashOperator(..., bash_command=\"...\".format(...), ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\nairflow.operators.bash_operator.BashOperator(..., bash_command=f\"...\", ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\nairflow.operators.bash_operator.BashOperator(..., bash_command=\"...\" % $PARAMS, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\n$CMD = \"...\" % $PARAMS\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\n$CMD = $STR.format(...)\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\n$CMD = f\"...\"\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\n$CMD = \"...\" + $CONCAT\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-string-bashoperator\nPattern:\n$CMD = \"...\"\n...\n$CMD += $CONCAT\n...\nairflow.operators.bash_operator.BashOperator(..., bash_command=$CMD, ...)\n", "output": "Vulnerability rule: formatted-string-bashoperator\nMessage: Found a formatted string in BashOperator: $CMD. This could be vulnerable to injection. Be extra sure your variables are not controllable by external sources.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/airflow/security/audit/formatted-string-bashoperator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-importlib\nPattern:\nimportlib.source_hash()", "output": "Vulnerability rule: python37-compatibility-importlib\nMessage: source_hash' is only available on Python 3.7+. This does not work in lower versions, and therefore is not backwards compatible. Instead, use another hash function.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-importlib2\nPattern:\nimport importlib.resources", "output": "Vulnerability rule: python37-compatibility-importlib2\nMessage: Found 'importlib.resources', which is a module only available on Python 3.7+. This does not work in lower versions, and therefore is not backwards compatible. Use importlib_resources instead for older Python versions.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-httpconn\nPattern:\nhttp.client.HTTPConnection(blocksize=$X,...)", "output": "Vulnerability rule: python37-compatibility-httpconn\nMessage: Found usage of the 'blocksize' argument in a HTTPConnection call. This is only available on Python 3.7+ and is therefore not backwards compatible. Remove this in order for this code to work in Python 3.6 and below.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-httpsconn\nPattern:\nhttp.client.HTTPSConnection(blocksize=$X,...)", "output": "Vulnerability rule: python37-compatibility-httpsconn\nMessage: Found usage of the 'blocksize' argument in a HTTPSConnection call. This is only available on Python 3.7+ and is therefore not backwards compatible. Remove this in order for this code to work in Python 3.6 and below.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-importlib3\nPattern:\nimport importlib.abc.ResourceReader", "output": "Vulnerability rule: python37-compatibility-importlib3\nMessage: Found usage of 'importlib.abc.ResourceReader'. This module is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use another loader.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-textiowrapper\nPattern:\nTextIOWrapper.reconfigure(...)", "output": "Vulnerability rule: python37-compatibility-textiowrapper\nMessage: Found usage of 'importlib.abc.ResourceReader'. This module is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use another loader.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-ipv6network1\nPattern:\nipaddress.IPv6Network.subnet_of($X)", "output": "Vulnerability rule: python37-compatibility-ipv6network1\nMessage: IPv6Network.subnet_of is only available on Python 3.7+ and is therefore not backwards compatible. Instead, check if the subnet is in 'subnets'.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-ipv6network2\nPattern:\nipaddress.IPv6Network.supernet_of($X)", "output": "Vulnerability rule: python37-compatibility-ipv6network2\nMessage: IPv6Network.supernet_of is only available on Python 3.7+ and is therefore not backwards compatible. Instead, check if the supernet is in 'supernet'.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-ipv4network1\nPattern:\nipaddress.IPv4Network.subnet_of($X)", "output": "Vulnerability rule: python37-compatibility-ipv4network1\nMessage: IPv4Network.subnet_of is only available on Python 3.7+ and is therefore not backwards compatible. Instead, check if the subnet is in 'subnets'.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-ipv4network2\nPattern:\nipaddress.IPv4Network.supernet_of($X)", "output": "Vulnerability rule: python37-compatibility-ipv4network2\nMessage: IPv4Network.supernet_of is only available on Python 3.7+ and is therefore not backwards compatible. Instead, check if the supernet is in 'supernet'.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-locale1\nPattern:\nlocale.format_string(monetary=$X, ...)", "output": "Vulnerability rule: python37-compatibility-locale1\nMessage: Found usage of the 'monetary' argument in a function call of 'locale.format_string'. This is only available on Python 3.7+ and is therefore not backwards compatible. Instead, remove the 'monetary' argument.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-math1\nPattern:\nmath.remainder($X, $Y)", "output": "Vulnerability rule: python37-compatibility-math1\nMessage: math.remainder is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use math.fmod() or calculate $X - n* $Y.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-multiprocess1\nPattern:\nmultiprocessing.Process.close()", "output": "Vulnerability rule: python37-compatibility-multiprocess1\nMessage: multiprocessing.Process.close() is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use join().\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-multiprocess2\nPattern:\nmultiprocessing.Process.kill()", "output": "Vulnerability rule: python37-compatibility-multiprocess2\nMessage: multiprocessing.Process.kill() is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use terminate().\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-os1\nPattern:\nos.preadv(...)", "output": "Vulnerability rule: python37-compatibility-os1\nMessage: os.preadv() is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use a combination of os.readv() and os.pread().\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-os2-ok2\nPattern:\nos.pwritev(...)", "output": "Vulnerability rule: python37-compatibility-os2-ok2\nMessage: os.pwritev() is only available on Python 3.3+ and is therefore not backwards compatible. Instead, use a combination of pwrite() and writev().\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python37-compatibility-pdb\nPattern:\npdb.set_trace(header=$X, ...)", "output": "Vulnerability rule: python37-compatibility-pdb\nMessage: pdb.set_trace() with the header argument is only available on Python 3.7+ and is therefore not backwards compatible. Instead, use set_trace() without the header argument.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python37.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python36-compatibility-ssl\nPattern:\nssl.get_ciphers()", "output": "Vulnerability rule: python36-compatibility-ssl\nMessage: this function is only available on Python 3.6+\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python36.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python36-compatibility-Popen1\nPattern:\nsubprocess.Popen(errors=$X, ...)", "output": "Vulnerability rule: python36-compatibility-Popen1\nMessage: the `errors` argument to Popen is only available on Python 3.6+\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python36.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python36-compatibility-Popen2\nPattern:\nsubprocess.Popen(encoding=$X, ...)", "output": "Vulnerability rule: python36-compatibility-Popen2\nMessage: the `encoding` argument to Popen is only available on Python 3.6+\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/compatibility/python36.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defusedcsv\nPattern:\ncsv.writer(...)", "output": "Vulnerability rule: use-defusedcsv\nMessage: Detected the generation of a CSV file using the built-in `csv` module. If user data is used to generate the data in this file, it is possible that an attacker could inject a formula when the CSV is imported into a spreadsheet application that runs an attacker script, which could steal data from the importing user or, at worst, install malware on the user's computer. `defusedcsv` is a drop-in replacement with the same API that will attempt to mitigate formula injection attempts. You can use `defusedcsv` instead of `csv` to safely generate CSVs.\nSeverity: INFO\nCWE: ['CWE-1236: Improper Neutralization of Formula Elements in a CSV File']\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defusedcsv.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defused-xml-parse\nPattern:\nxml.etree.ElementTree.parse($...ARGS)", "output": "Vulnerability rule: use-defused-xml-parse\nMessage: The native Python `xml` library is vulnerable to XML External Entity (XXE) attacks.  These attacks can leak confidential data and \"XML bombs\" can cause denial of service. Do not use this library to parse untrusted input. Instead  the Python documentation recommends using `defusedxml`.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defused-xml-parse.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-sha1\nPattern:\nhashlib.sha1(...)", "output": "Vulnerability rule: insecure-hash-algorithm-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/insecure-hash-algorithms.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defused-xmlrpc\nPattern:\nimport xmlrpclib", "output": "Vulnerability rule: use-defused-xmlrpc\nMessage: Detected use of xmlrpc. xmlrpc is not inherently safe from vulnerabilities. Use defusedxml.xmlrpc instead.\nSeverity: ERROR\nCWE: [\"CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')\"]\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defused-xmlrpc.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defused-xmlrpc\nPattern:\nimport SimpleXMLRPCServer", "output": "Vulnerability rule: use-defused-xmlrpc\nMessage: Detected use of xmlrpc. xmlrpc is not inherently safe from vulnerabilities. Use defusedxml.xmlrpc instead.\nSeverity: ERROR\nCWE: [\"CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')\"]\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defused-xmlrpc.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defused-xmlrpc\nPattern:\nimport xmlrpc", "output": "Vulnerability rule: use-defused-xmlrpc\nMessage: Detected use of xmlrpc. xmlrpc is not inherently safe from vulnerabilities. Use defusedxml.xmlrpc instead.\nSeverity: ERROR\nCWE: [\"CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')\"]\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defused-xmlrpc.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-uuid-version\nPattern:\nuuid.uuid1(...)", "output": "Vulnerability rule: insecure-uuid-version\nMessage: Using UUID version 1 for UUID generation can lead to predictable UUIDs based on system information (e.g., MAC address, timestamp). This may lead to security risks such as the sandwich attack. Consider using `uuid.uuid4()` instead for better randomness and security.\nSeverity: WARNING\nCWE: ['CWE-330: Use of Insufficiently Random Values']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/insecure-uuid-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-defused-xml\nPattern:\nimport xml", "output": "Vulnerability rule: use-defused-xml\nMessage: The Python documentation recommends using `defusedxml` instead of `xml` because the native Python `xml` library is vulnerable to XML External Entity (XXE) attacks. These attacks can leak confidential data and \"XML bombs\" can cause denial of service.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/use-defused-xml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-algorithm-md5\nPattern:\nhashlib.md5(...)", "output": "Vulnerability rule: insecure-hash-algorithm-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/insecure-hash-algorithms-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-function\nPattern:\nhashlib.new(\"=~/[M|m][D|d][4|5]/\", ...)", "output": "Vulnerability rule: insecure-hash-function\nMessage: Detected use of an insecure MD4 or MD5 hash function. These functions have known vulnerabilities and are considered deprecated. Consider using 'SHA256' or a similar function instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/insecure-hash-function.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-hash-function\nPattern:\nhashlib.new(..., name=\"=~/[M|m][D|d][4|5]/\", ...)", "output": "Vulnerability rule: insecure-hash-function\nMessage: Detected use of an insecure MD4 or MD5 hash function. These functions have known vulnerabilities and are considered deprecated. Consider using 'SHA256' or a similar function instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/insecure-hash-function.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: telnetlib\nPattern:\ntelnetlib.$ANYTHING(...)", "output": "Vulnerability rule: telnetlib\nMessage: Telnet does not encrypt communications. Use SSH instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/telnetlib.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: exec-detected\nPattern:\nexec(...)", "output": "Vulnerability rule: exec-detected\nMessage: Detected the use of exec(). exec() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/exec-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: non-literal-import\nPattern:\nimportlib.import_module($NAME, ...)\n", "output": "Vulnerability rule: non-literal-import\nMessage: Untrusted user input in `importlib.import_module()` function allows an attacker to load arbitrary code. Avoid dynamic values in `importlib.import_module()` or use a whitelist to prevent running untrusted code.\nSeverity: WARNING\nCWE: ['CWE-706: Use of Incorrectly-Resolved Name or Reference']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/non-literal-import.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: subprocess-shell-true\nPattern:\nsubprocess.$FUNC(..., shell=$TRUE, ...)", "output": "Vulnerability rule: subprocess-shell-true\nMessage: Found 'subprocess' function '$FUNC' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/subprocess-shell-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: marshal-usage\nPattern:\nmarshal.dump(...)", "output": "Vulnerability rule: marshal-usage\nMessage: The marshal module is not intended to be secure against erroneous or maliciously constructed data. Never unmarshal data received from an untrusted or unauthenticated source. See more details: https://docs.python.org/3/library/marshal.html?highlight=security\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: marshal-usage\nPattern:\nmarshal.dumps(...)", "output": "Vulnerability rule: marshal-usage\nMessage: The marshal module is not intended to be secure against erroneous or maliciously constructed data. Never unmarshal data received from an untrusted or unauthenticated source. See more details: https://docs.python.org/3/library/marshal.html?highlight=security\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: marshal-usage\nPattern:\nmarshal.load(...)", "output": "Vulnerability rule: marshal-usage\nMessage: The marshal module is not intended to be secure against erroneous or maliciously constructed data. Never unmarshal data received from an untrusted or unauthenticated source. See more details: https://docs.python.org/3/library/marshal.html?highlight=security\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: marshal-usage\nPattern:\nmarshal.loads(...)", "output": "Vulnerability rule: marshal-usage\nMessage: The marshal module is not intended to be secure against erroneous or maliciously constructed data. Never unmarshal data received from an untrusted or unauthenticated source. See more details: https://docs.python.org/3/library/marshal.html?highlight=security\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/marshal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-subinterpreters-run-string-audit\nPattern:\n_xxsubinterpreters.run_string($ID, $PAYLOAD, ...)\n", "output": "Vulnerability rule: dangerous-subinterpreters-run-string-audit\nMessage: Found dynamic content in `run_string`. This is dangerous if external data can reach this function call because it allows a malicious actor to run arbitrary Python code. Ensure no external data reaches here.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/dangerous-subinterpreters-run-string-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hardcoded-password-default-argument\nPattern:\ndef $FUNC(..., password=\"...\", ...):\n  ...\n", "output": "Vulnerability rule: hardcoded-password-default-argument\nMessage: Hardcoded password is used as a default argument to '$FUNC'. This could be dangerous if a real password is not supplied.\nSeverity: WARNING\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/hardcoded-password-default-argument.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dangerous-annotations-usage\nPattern:\n$C.__annotations__[$NAME] = $X\n", "output": "Vulnerability rule: dangerous-annotations-usage\nMessage: Annotations passed to `typing.get_type_hints` are evaluated in `globals` and `locals` namespaces. Make sure that no arbitrary value can be written as the annotation and passed to `typing.get_type_hints` function.\nSeverity: INFO\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/dangerous-annotations-usage.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-sql-query\nPattern:\n$DB.execute(\"...\" % ...)", "output": "Vulnerability rule: formatted-sql-query\nMessage: Detected possible formatted SQL query. Use parameterized queries instead.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/formatted-sql-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-sql-query\nPattern:\n$DB.execute(\"...\".format(...))", "output": "Vulnerability rule: formatted-sql-query\nMessage: Detected possible formatted SQL query. Use parameterized queries instead.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/formatted-sql-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formatted-sql-query\nPattern:\n$DB.execute(f\"...\")", "output": "Vulnerability rule: formatted-sql-query\nMessage: Detected possible formatted SQL query. Use parameterized queries instead.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/formatted-sql-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\nssl.PROTOCOL_SSLv2", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\nssl.PROTOCOL_SSLv3", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\nssl.PROTOCOL_TLSv1", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\nssl.PROTOCOL_TLSv1_1", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\npyOpenSSL.SSL.SSLv2_METHOD", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\npyOpenSSL.SSL.SSLv23_METHOD", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\npyOpenSSL.SSL.SSLv3_METHOD", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\npyOpenSSL.SSL.TLSv1_METHOD", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: weak-ssl-version\nPattern:\npyOpenSSL.SSL.TLSv1_1_METHOD", "output": "Vulnerability rule: weak-ssl-version\nMessage: An insecure SSL version was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use 'ssl.PROTOCOL_TLSv1_2' or higher.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/weak-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: mako-templates-detected\nPattern:\nmako.template.Template(...)", "output": "Vulnerability rule: mako-templates-detected\nMessage: Mako templates do not provide a global HTML escaping mechanism. This means you must escape all sensitive data in your templates using '| u' for URL escaping or '| h' for HTML escaping. If you are using Mako to serve web content, consider using a system such as Jinja2 which enables global escaping.\nSeverity: INFO\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/mako-templates-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: httpsconnection-detected\nPattern:\nhttplib.HTTPSConnection(...)", "output": "Vulnerability rule: httpsconnection-detected\nMessage: The HTTPSConnection API has changed frequently with minor releases of Python. Ensure you are using the API for your version of Python securely. For example, Python 3 versions prior to 3.4.3 will not verify SSL certificates by default. See https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection for more information.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/httpsconnection-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: httpsconnection-detected\nPattern:\nhttp.client.HTTPSConnection(...)", "output": "Vulnerability rule: httpsconnection-detected\nMessage: The HTTPSConnection API has changed frequently with minor releases of Python. Ensure you are using the API for your version of Python securely. For example, Python 3 versions prior to 3.4.3 will not verify SSL certificates by default. See https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection for more information.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/httpsconnection-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: httpsconnection-detected\nPattern:\nsix.moves.http_client.HTTPSConnection(...)", "output": "Vulnerability rule: httpsconnection-detected\nMessage: The HTTPSConnection API has changed frequently with minor releases of Python. Ensure you are using the API for your version of Python securely. For example, Python 3 versions prior to 3.4.3 will not verify SSL certificates by default. See https://docs.python.org/3/library/http.client.html#http.client.HTTPSConnection for more information.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/httpsconnection-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: ssl-wrap-socket-is-deprecated\nPattern:\nssl.wrap_socket(...)", "output": "Vulnerability rule: ssl-wrap-socket-is-deprecated\nMessage: 'ssl.wrap_socket()' is deprecated. This function creates an insecure socket without server name indication or hostname matching. Instead, create an SSL context using 'ssl.SSLContext()' and use that to wrap a socket.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/ssl-wrap-socket-is-deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: regex_dos\nPattern:\n$A = re.compile(\"$B\", ...)\n...\n$A.$METHOD(...)\n", "output": "Vulnerability rule: regex_dos\nMessage: Detected usage of re.compile with an inefficient regular expression. This can lead to regular expression denial of service, which can result in service down time. Instead, check all regexes or use safer alternatives such as pyre2.\nSeverity: WARNING\nCWE: CWE-1333: Inefficient Regular Expression Complexity\nOWASP: A06:2017 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/regex-dos.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sha224-hash\nPattern:\nhashlib.sha224(...)", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sha224-hash\nPattern:\nhashlib.sha3_224(...)", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: eval-detected\nPattern:\neval(...)", "output": "Vulnerability rule: eval-detected\nMessage: Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/eval-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: multiprocessing-recv\nPattern:\nmultiprocessing.connection.Connection.recv(...)", "output": "Vulnerability rule: multiprocessing-recv\nMessage: The Connection.recv() method automatically unpickles the data it receives, which can be a security risk unless you can trust the process which sent the message. Therefore, unless the connection object was produced using Pipe() you should only use the recv() and send() methods after performing some sort of authentication. See more dettails: https://docs.python.org/3/library/multiprocessing.html?highlight=security#multiprocessing.connection.Connection\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/conn_recv.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: multiprocessing-recv\nPattern:\nmultiprocessing.connection.Client.recv(...)", "output": "Vulnerability rule: multiprocessing-recv\nMessage: The Connection.recv() method automatically unpickles the data it receives, which can be a security risk unless you can trust the process which sent the message. Therefore, unless the connection object was produced using Pipe() you should only use the recv() and send() methods after performing some sort of authentication. See more dettails: https://docs.python.org/3/library/multiprocessing.html?highlight=security#multiprocessing.connection.Connection\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/conn_recv.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: multiprocessing-recv\nPattern:\n$C = multiprocessing.connection.Client(...)\n...\n$C.recv(...)\n", "output": "Vulnerability rule: multiprocessing-recv\nMessage: The Connection.recv() method automatically unpickles the data it receives, which can be a security risk unless you can trust the process which sent the message. Therefore, unless the connection object was produced using Pipe() you should only use the recv() and send() methods after performing some sort of authentication. See more dettails: https://docs.python.org/3/library/multiprocessing.html?highlight=security#multiprocessing.connection.Connection\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/conn_recv.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: paramiko-exec-command\nPattern:\n$CLIENT.exec_command(...)", "output": "Vulnerability rule: paramiko-exec-command\nMessage: Unverified SSL context detected. This will permit insecure connections without verifying SSL certificates. Use 'ssl.create_default_context()' instead.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/paramiko/paramiko-exec-command.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: http-not-https-connection\nPattern:\nurllib3.HTTPConnectionPool(...)", "output": "Vulnerability rule: http-not-https-connection\nMessage: Detected HTTPConnectionPool. This will transmit data in cleartext. It is recommended to use HTTPSConnectionPool instead for to encrypt communications.\nSeverity: ERROR\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/network/http-not-https-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: http-not-https-connection\nPattern:\nurllib3.connectionpool.HTTPConnectionPool(...)", "output": "Vulnerability rule: http-not-https-connection\nMessage: Detected HTTPConnectionPool. This will transmit data in cleartext. It is recommended to use HTTPSConnectionPool instead for to encrypt communications.\nSeverity: ERROR\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/network/http-not-https-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\n$S = socket.socket(...)\n...\n$S.bind((\"0.0.0.0\", ...))\n", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Running `socket.bind` to 0.0.0.0, or empty string could unexpectedly expose the server publicly as it binds to all available interfaces. Consider instead getting correct address from an environment variable or configuration file.\nSeverity: INFO\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/network/bind.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\n$S = socket.socket(...)\n...\n$S.bind((\"::\", ...))\n", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Running `socket.bind` to 0.0.0.0, or empty string could unexpectedly expose the server publicly as it binds to all available interfaces. Consider instead getting correct address from an environment variable or configuration file.\nSeverity: INFO\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/network/bind.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-bind-to-all-interfaces\nPattern:\n$S = socket.socket(...)\n...\n$S.bind((\"\", ...))\n", "output": "Vulnerability rule: avoid-bind-to-all-interfaces\nMessage: Running `socket.bind` to 0.0.0.0, or empty string could unexpectedly expose the server publicly as it binds to all available interfaces. Consider instead getting correct address from an environment variable or configuration file.\nSeverity: INFO\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/network/bind.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python-logger-credential-disclosure\nPattern:\n$LOGGER_OBJ.$LOGGER_CALL($FORMAT_STRING,...)\n", "output": "Vulnerability rule: python-logger-credential-disclosure\nMessage: Detected a python logger call with a potential hardcoded secret $FORMAT_STRING being logged. This may lead to secret credentials being exposed. Make sure that the logger is not logging  sensitive information.\nSeverity: WARNING\nCWE: ['CWE-532: Insertion of Sensitive Information into Log File']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/logging/logger-credential-leak.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: listen-eval\nPattern:\nlogging.config.listen(...)", "output": "Vulnerability rule: listen-eval\nMessage: Because portions of the logging configuration are passed through eval(), use of this function may open its users to a security risk. While the function only binds to a socket on localhost, and so does not accept connections from remote machines, there are scenarios where untrusted code could be run under the account of the process which calls listen(). To avoid this happening, use the `verify()` argument to `listen()` to prevent unrecognized configurations.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/logging/listeneval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-set-ciphers\nPattern:\n$CONTEXT.set_ciphers(...)", "output": "Vulnerability rule: no-set-ciphers\nMessage: The 'ssl' module disables insecure cipher suites by default. Therefore, use of 'set_ciphers()' should only be used when you have very specialized requirements. Otherwise, you risk lowering the security of the SSL channel.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/ssl/no-set-ciphers.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-ftp-tls\nPattern:\nftplib.FTP(...)", "output": "Vulnerability rule: use-ftp-tls\nMessage: The 'FTP' class sends information unencrypted. Consider using the 'FTP_TLS' class instead.\nSeverity: INFO\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/ftplib/use-ftp-tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object-ftp\nPattern:\nurllib.request.Request(\"=~/^[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-request-object-ftp\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'ftp://'. This connection will not be encrypted. Consider using SFTP instead. urllib does not support SFTP natively, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object-ftp\nPattern:\n$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.Request($URL, ...)\n", "output": "Vulnerability rule: insecure-request-object-ftp\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'ftp://'. This connection will not be encrypted. Consider using SFTP instead. urllib does not support SFTP natively, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object-ftp\nPattern:\ndef $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.Request($URL, ...)", "output": "Vulnerability rule: insecure-request-object-ftp\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'ftp://'. This connection will not be encrypted. Consider using SFTP instead. urllib does not support SFTP natively, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-openerdirector-open-ftp\nPattern:\nurllib.request.OpenerDirector(...).open(\"=~/^[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-openerdirector-open-ftp\nMessage: Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'ftp://'. Information sent over this connection will be unencrypted. Consider using SFTP instead. urllib does not support SFTP, so consider a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-openerdirector-open-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-openerdirector-open-ftp\nPattern:\n$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.OpenerDirector(...).open($URL, ...)\n", "output": "Vulnerability rule: insecure-openerdirector-open-ftp\nMessage: Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'ftp://'. Information sent over this connection will be unencrypted. Consider using SFTP instead. urllib does not support SFTP, so consider a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-openerdirector-open-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object\nPattern:\nurllib.request.Request(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-request-object\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'http://'. This connection will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.Request($URL, ...)\n", "output": "Vulnerability rule: insecure-request-object\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'http://'. This connection will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-request-object\nPattern:\ndef $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.Request($URL, ...)\n", "output": "Vulnerability rule: insecure-request-object\nMessage: Detected a 'urllib.request.Request()' object using an insecure transport protocol, 'http://'. This connection will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-request-object.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen-ftp\nPattern:\nurllib.request.urlopen(\"=~/^[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopen-ftp\nMessage: Detected 'urllib.urlopen()' using 'ftp://'. This request will not be encrypted. Consider using SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen-ftp\nPattern:\n$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.urlopen($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopen-ftp\nMessage: Detected 'urllib.urlopen()' using 'ftp://'. This request will not be encrypted. Consider using SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen-ftp\nPattern:\ndef $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlopen($URL, ...)", "output": "Vulnerability rule: insecure-urlopen-ftp\nMessage: Detected 'urllib.urlopen()' using 'ftp://'. This request will not be encrypted. Consider using SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-retrieve\nPattern:\nurllib.request.URLopener(...).retrieve(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopener-retrieve\nMessage: Detected an unsecured transmission channel. 'URLopener.retrieve(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-retrieve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-retrieve\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).retrieve($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopener-retrieve\nMessage: Detected an unsecured transmission channel. 'URLopener.retrieve(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-retrieve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-openerdirector-open\nPattern:\nurllib.request.OpenerDirector(...).open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-openerdirector-open\nMessage: Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-openerdirector-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-openerdirector-open\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.OpenerDirector(...).open($URL, ...)\n", "output": "Vulnerability rule: insecure-openerdirector-open\nMessage: Detected an unsecured transmission channel. 'OpenerDirector.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-openerdirector-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-open\nPattern:\nurllib.request.URLopener(...).open(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopener-open\nMessage: Detected an unsecured transmission channel. 'URLopener.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-open\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).open($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopener-open\nMessage: Detected an unsecured transmission channel. 'URLopener.open(...)' is being used with 'http://'. Use 'https://' instead to secure the channel.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-open-ftp\nPattern:\nurllib.request.URLopener(...).open(\"=~/[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopener-open-ftp\nMessage: Detected an insecure transmission channel. 'URLopener.open(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-open-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-open-ftp\nPattern:\n$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).open($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopener-open-ftp\nMessage: Detected an insecure transmission channel. 'URLopener.open(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-open-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve\nPattern:\nurllib.request.urlretrieve(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlretrieve\nMessage: Detected 'urllib.urlretrieve()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.urlretrieve($URL, ...)\n", "output": "Vulnerability rule: insecure-urlretrieve\nMessage: Detected 'urllib.urlretrieve()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve\nPattern:\ndef $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlretrieve($URL, ...)\n", "output": "Vulnerability rule: insecure-urlretrieve\nMessage: Detected 'urllib.urlretrieve()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-retrieve-ftp\nPattern:\nurllib.request.URLopener(...).retrieve(\"=~/[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopener-retrieve-ftp\nMessage: Detected an insecure transmission channel. 'URLopener.retrieve(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-retrieve-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopener-retrieve-ftp\nPattern:\n$URL = \"=~/[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.URLopener(...).retrieve($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopener-retrieve-ftp\nMessage: Detected an insecure transmission channel. 'URLopener.retrieve(...)' is being used with 'ftp://'. Use SFTP instead. urllib does not support SFTP, so consider using a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopener-retrieve-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve-ftp\nPattern:\nurllib.request.urlretrieve(\"=~/^[Ff][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlretrieve-ftp\nMessage: Detected 'urllib.urlretrieve()' using 'ftp://'. This request will not be encrypted. Use SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve-ftp\nPattern:\n$URL = \"=~/^[Ff][Tt][Pp]://.*/\"\n...\nurllib.request.urlretrieve($URL, ...)\n", "output": "Vulnerability rule: insecure-urlretrieve-ftp\nMessage: Detected 'urllib.urlretrieve()' using 'ftp://'. This request will not be encrypted. Use SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlretrieve-ftp\nPattern:\ndef $FUNC(..., $URL = \"=~/^[Ff][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlretrieve($URL, ...)", "output": "Vulnerability rule: insecure-urlretrieve-ftp\nMessage: Detected 'urllib.urlretrieve()' using 'ftp://'. This request will not be encrypted. Use SFTP instead. urllib does not support SFTP, so consider switching to a library which supports SFTP.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlretrieve-ftp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen\nPattern:\nurllib.request.urlopen(\"=~/[Hh][Tt][Tt][Pp]://.*/\", ...)", "output": "Vulnerability rule: insecure-urlopen\nMessage: Detected 'urllib.urlopen()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen\nPattern:\n$URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\"\n...\nurllib.request.urlopen($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopen\nMessage: Detected 'urllib.urlopen()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: insecure-urlopen\nPattern:\ndef $FUNC(..., $URL = \"=~/[Hh][Tt][Tt][Pp]://.*/\", ...):\n  ...\n  urllib.request.urlopen($URL, ...)\n", "output": "Vulnerability rule: insecure-urlopen\nMessage: Detected 'urllib.urlopen()' using 'http://'. This request will not be encrypted. Use 'https://' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/audit/insecure-transport/urllib/insecure-urlopen.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-jsonpickle\nPattern:\njsonpickle.decode($PAYLOAD,...)\n", "output": "Vulnerability rule: avoid-jsonpickle\nMessage: Avoid using `jsonpickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data using `json` module.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/avoid-jsonpickle.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-unsafe-ruamel\nPattern:\nruamel.yaml.YAML(..., typ='unsafe', ...)", "output": "Vulnerability rule: avoid-unsafe-ruamel\nMessage: Avoid using unsafe `ruamel.yaml.YAML()`. `ruamel.yaml.YAML` can create arbitrary Python objects. A malicious actor could exploit this to run arbitrary code. Use `YAML(typ='rt')` or `YAML(typ='safe')` instead.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/avoid-unsafe-ruamel.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-unsafe-ruamel\nPattern:\nruamel.yaml.YAML(..., typ='base', ...)", "output": "Vulnerability rule: avoid-unsafe-ruamel\nMessage: Avoid using unsafe `ruamel.yaml.YAML()`. `ruamel.yaml.YAML` can create arbitrary Python objects. A malicious actor could exploit this to run arbitrary code. Use `YAML(typ='rt')` or `YAML(typ='safe')` instead.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/avoid-unsafe-ruamel.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-cPickle\nPattern:\ncPickle.$FUNC(...)", "output": "Vulnerability rule: avoid-cPickle\nMessage: Avoid using `cPickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/pickle.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-dill\nPattern:\ndill.$FUNC(...)", "output": "Vulnerability rule: avoid-dill\nMessage: Avoid using `dill`, which uses `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/pickle.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-shelve\nPattern:\nshelve.$FUNC(...)", "output": "Vulnerability rule: avoid-shelve\nMessage: Avoid using `shelve`, which uses `pickle`, which is known to lead to code execution vulnerabilities. When unpickling, the serialized data could be manipulated to run arbitrary code. Instead, consider serializing the relevant data as JSON or a similar text-based serialization format.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/security/deserialization/pickle.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-if-conditional\nPattern:\nif $X:\n    ...\nelif $X:\n    ...\n", "output": "Vulnerability rule: useless-if-conditional\nMessage: if block checks for the same condition on both branches (`$X`)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-ifelse.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-if-body\nPattern:\nif $X:\n    $S\nelse:\n    $S\n", "output": "Vulnerability rule: useless-if-body\nMessage: Useless if statement; both blocks have the same body\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-ifelse.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: code-after-unconditional-return\nPattern:\nreturn ...\n$S\n", "output": "Vulnerability rule: code-after-unconditional-return\nMessage: code after return statement will not be executed\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/return.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: return-not-in-function\nPattern:\nreturn ...", "output": "Vulnerability rule: return-not-in-function\nMessage: `return` only makes sense inside a function\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/return.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-assignment-keyed\nPattern:\n$X[$Y] = ...\n$X[$Y] = ...\n", "output": "Vulnerability rule: useless-assignment-keyed\nMessage: key `$Y` in `$X` is assigned twice; the first assignment is useless\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-assign-keyed.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-assignment-keyed\nPattern:\n$X[$Y][$Z] = ...\n$X[$Y][$Z] = ...\n", "output": "Vulnerability rule: useless-assignment-keyed\nMessage: key `$Y` in `$X` is assigned twice; the first assignment is useless\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-assign-keyed.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-inner-function\nPattern:\ndef $FF(...):\n  ...\n", "output": "Vulnerability rule: useless-inner-function\nMessage: function `$FF` is defined inside a function but never used\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-innerfunction.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: useless-literal-set\nPattern:\nset(..., ($X, $A), ..., ($X, $B), ...)\n", "output": "Vulnerability rule: useless-literal-set\nMessage: `$X` is uselessly assigned twice inside the creation of the set\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/useless-literal-set.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: is-function-without-parentheses\nPattern:\n$X.$FUNC", "output": "Vulnerability rule: is-function-without-parentheses\nMessage: Is \"$FUNC\" a function or an attribute? If it is a function, you may have meant $X.$FUNC() because $X.$FUNC is always true.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/is-function-without-parentheses.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: improper-list-concat\nPattern:\n[...] + [...] if $EXPRESSION else [...]", "output": "Vulnerability rule: improper-list-concat\nMessage: This expression will evaluate to be ONLY value the of the `else` clause if the condition `$EXPRESSION` is false. If you meant to do list concatenation, put parentheses around the entire concatenation expression, like this: `['a', 'b', 'c'] + (['d'] if x else ['e'])`. If this is the intended behavior, the expression may be confusing to others, and you may wish to add parentheses for readability.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/maintainability/improper-list-concat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: writing-to-file-in-read-mode\nPattern:\n$FD.write(...)", "output": "Vulnerability rule: writing-to-file-in-read-mode\nMessage: The file object '$FD' was opened in read mode, but is being written to. This will cause a runtime error.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/writing-to-file-in-read-mode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-sys-exit\nPattern:\nexit($X)", "output": "Vulnerability rule: use-sys-exit\nMessage: Detected use of `exit`. Use `sys.exit` over the python shell `exit` built-in. `exit` is a helper for the interactive shell and may not be available on all Python implementations.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/exit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: sync-sleep-in-async-code\nPattern:\ntime.sleep(...)", "output": "Vulnerability rule: sync-sleep-in-async-code\nMessage: Synchronous time.sleep in async code will block the event loop and not allow other tasks to execute. Use asyncio.sleep() instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/sync-sleep-in-async-code.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pytest-assert_match-after-path-patch\nPattern:\nsnapshot.assert_match(...)", "output": "Vulnerability rule: pytest-assert_match-after-path-patch\nMessage: snapshot.assert_match makes use of pathlib to create files. Patching $METHOD may result in unexpected snapshot behavior\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/pytest-assert_match-after-path-patch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pdb-remove\nPattern:\npdb.$X(...)", "output": "Vulnerability rule: pdb-remove\nMessage: pdb is an interactive debugging tool and you may have forgotten to remove it before committing your code\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/pdb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pdb-remove\nPattern:\npdb.Pdb.$X(...)", "output": "Vulnerability rule: pdb-remove\nMessage: pdb is an interactive debugging tool and you may have forgotten to remove it before committing your code\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/pdb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: list-modify-while-iterate\nPattern:\nfor $ELEMENT in $LIST:\n  ...\n  $LIST.pop(...)\n", "output": "Vulnerability rule: list-modify-while-iterate\nMessage: It appears that `$LIST` is a list that is being modified while in a for loop. This will likely cause a runtime error or an infinite loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/list-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: list-modify-while-iterate\nPattern:\nfor $ELEMENT in $LIST:\n  ...\n  $LIST.push(...)\n", "output": "Vulnerability rule: list-modify-while-iterate\nMessage: It appears that `$LIST` is a list that is being modified while in a for loop. This will likely cause a runtime error or an infinite loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/list-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: list-modify-while-iterate\nPattern:\nfor $ELEMENT in $LIST:\n  ...\n  $LIST.append(...)\n", "output": "Vulnerability rule: list-modify-while-iterate\nMessage: It appears that `$LIST` is a list that is being modified while in a for loop. This will likely cause a runtime error or an infinite loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/list-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: list-modify-while-iterate\nPattern:\nfor $ELEMENT in $LIST:\n  ...\n  $LIST.extend(...)\n", "output": "Vulnerability rule: list-modify-while-iterate\nMessage: It appears that `$LIST` is a list that is being modified while in a for loop. This will likely cause a runtime error or an infinite loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/list-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: list-modify-while-iterate\nPattern:\nfor $ELEMENT in $LIST:\n  ...\n  $LIST.remove(...)\n", "output": "Vulnerability rule: list-modify-while-iterate\nMessage: It appears that `$LIST` is a list that is being modified while in a for loop. This will likely cause a runtime error or an infinite loop.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/list-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: test-is-missing-assert\nPattern:\n$A == $B", "output": "Vulnerability rule: test-is-missing-assert\nMessage: Comparison without assertion. The result of this comparison is not used. Perhaps this expression is missing an `assert` keyword.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/test-is-missing-assert.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: uncaught-executor-exceptions\nPattern:\n$EXECUTOR.map(...)", "output": "Vulnerability rule: uncaught-executor-exceptions\nMessage: Values returned by thread pool map must be read in order to raise exceptions. Consider using `for _ in $EXECUTOR.map(...): pass`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/concurrent.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: cannot-cache-generators\nPattern:\nfunctools.lru_cache(...)", "output": "Vulnerability rule: cannot-cache-generators\nMessage: Generators can only be consumed once, so in most cases, caching them will cause an error when the already-consumed generator is retrieved from cache.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/cannot-cache-generators.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: file-object-redefined-before-close\nPattern:\n$F = open($X, ...)\n...\n$F = open($Y, ...)\n", "output": "Vulnerability rule: file-object-redefined-before-close\nMessage: Detected a file object that is redefined and never closed. This could leak file descriptors and unnecessarily consume system resources.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/file-object-redefined-before-close.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: baseclass-attribute-override\nPattern:\nclass $C(..., $A, ..., $B, ...):\n  ...\n", "output": "Vulnerability rule: baseclass-attribute-override\nMessage: Class $C inherits from both `$A` and `$B` which both have a method named `$F`; one of these methods will be overwritten.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/baseclass-attribute-override.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: unchecked-subprocess-call\nPattern:\nsubprocess.$CALL(...)", "output": "Vulnerability rule: unchecked-subprocess-call\nMessage: This is not checking the return value of this subprocess call; if it fails no exception will be raised. Consider subprocess.check_call() instead\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/unchecked-returns.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dict-del-while-iterate\nPattern:\nfor $KEY, $VALUE in $DICT.items():\n    ...\n    del $DICT[$KEY]\n", "output": "Vulnerability rule: dict-del-while-iterate\nMessage: It appears that `$DICT[$KEY]` is a dict with items being deleted while in a for loop. This is usually a bad idea and will likely lead to a RuntimeError: dictionary changed size during iteration\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/dict-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: dict-del-while-iterate\nPattern:\nfor $KEY in $DICT.keys():\n    ...\n    del $DICT[$KEY]\n", "output": "Vulnerability rule: dict-del-while-iterate\nMessage: It appears that `$DICT[$KEY]` is a dict with items being deleted while in a for loop. This is usually a bad idea and will likely lead to a RuntimeError: dictionary changed size during iteration\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/dict-modify-iterating.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-strings-as-booleans\nPattern:\nif <... \"...\" and ... ...>:\n    ...\n", "output": "Vulnerability rule: no-strings-as-booleans\nMessage: Using strings as booleans in Python has unexpected results. `\"one\" and \"two\"` will return \"two\". `\"one\" or \"two\"` will return \"one\". In Python, strings are truthy, and strings with a non-zero length evaluate to True.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/useless-comparison.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-strings-as-booleans\nPattern:\nif <... \"...\" or ... ...>:\n    ...\n", "output": "Vulnerability rule: no-strings-as-booleans\nMessage: Using strings as booleans in Python has unexpected results. `\"one\" and \"two\"` will return \"two\". `\"one\" or \"two\"` will return \"one\". In Python, strings are truthy, and strings with a non-zero length evaluate to True.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/useless-comparison.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: raise-not-base-exception\nPattern:\nraise \"...\"", "output": "Vulnerability rule: raise-not-base-exception\nMessage: In Python3, a runtime `TypeError` will be thrown if you attempt to raise an object or class which does not inherit from `BaseException`\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/exceptions/exceptions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: raise-not-base-exception\nPattern:\n$X: BaseException\nraise $X(...)\n", "output": "Vulnerability rule: raise-not-base-exception\nMessage: In Python3, a runtime `TypeError` will be thrown if you attempt to raise an object or class which does not inherit from `BaseException`\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/exceptions/exceptions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: tempfile-insecure\nPattern:\ntempfile.mktemp(...)", "output": "Vulnerability rule: tempfile-insecure\nMessage: Use tempfile.NamedTemporaryFile instead. From the official Python documentation: THIS FUNCTION IS UNSAFE AND SHOULD NOT BE USED. The file name may refer to a file that did not exist at some point, but by the time you get around to creating it, someone else may have beaten you to the punch.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/tempfile/mktemp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: is-not-is-not\nPattern:\n$S is (not ...)", "output": "Vulnerability rule: is-not-is-not\nMessage: In Python 'X is not ...' is different from 'X is (not ...)'. In the latter the 'not' converts the '...' directly to boolean.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/common-mistakes/is-not-is-not.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: string-concat-in-list\nPattern:\n\"...\" \"...\"", "output": "Vulnerability rule: string-concat-in-list\nMessage: Detected strings that are implicitly concatenated inside a list. Python will implicitly concatenate strings when not explicitly delimited. Was this supposed to be individual elements of the list?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/common-mistakes/string-concat-in-list.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: identical-is-comparison\nPattern:\n$S is $S", "output": "Vulnerability rule: identical-is-comparison\nMessage: Found identical comparison using is. Ensure this is what you intended.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/correctness/common-mistakes/is-comparison-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pass-body-fn\nPattern:\ndef $X(...):\n    pass\n", "output": "Vulnerability rule: pass-body-fn\nMessage: `pass` is the body of function $X. Consider removing this or raise NotImplementedError() if this is a TODO\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/pass-body.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: pass-body-range\nPattern:\nfor $X in $Y:\n    pass\n", "output": "Vulnerability rule: pass-body-range\nMessage: `pass` is the body of for $X in $Y. Consider removing this or raise NotImplementedError() if this is a TODO\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/pass-body.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python-debugger-found\nPattern:\nimport pdb", "output": "Vulnerability rule: python-debugger-found\nMessage: Importing the python debugger; did you mean to leave this in?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/pdb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: python-debugger-found\nPattern:\npdb.set_trace()", "output": "Vulnerability rule: python-debugger-found\nMessage: Importing the python debugger; did you mean to leave this in?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/pdb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: missing-hash-with-eq\nPattern:\nclass A(...):\n  ...\n  def __eq__(self, $O): ...\n  ...\n", "output": "Vulnerability rule: missing-hash-with-eq\nMessage: Class `$A` has defined `__eq__` which means it should also have defined `__hash__`; \nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/missing-hash-with-eq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-dict-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    if $KEY not in $DICT:\n        ...\n        $DICT[$KEY] = {}\n        ...\n    $DICT[$KEY].update(...)\n", "output": "Vulnerability rule: manual-defaultdict-dict-create\nMessage: manually creating a defaultdict - use collections.defaultdict(dict)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-dict-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    $DICT.setdefault($KEY, {}).update(...)\n", "output": "Vulnerability rule: manual-defaultdict-dict-create\nMessage: manually creating a defaultdict - use collections.defaultdict(dict)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-set-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    if $KEY not in $DICT:\n        ...\n        $DICT[$KEY] = set()\n        ...\n    $DICT[$KEY].add(...)\n", "output": "Vulnerability rule: manual-defaultdict-set-create\nMessage: manually creating a defaultdict - use collections.defaultdict(set)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-set-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    $DICT.setdefault($KEY, set()).add(...)\n", "output": "Vulnerability rule: manual-defaultdict-set-create\nMessage: manually creating a defaultdict - use collections.defaultdict(set)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-list-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    if $KEY not in $DICT:\n        ...\n        $DICT[$KEY] = []\n        ...\n    $DICT[$KEY].append(...)\n", "output": "Vulnerability rule: manual-defaultdict-list-create\nMessage: manually creating a defaultdict - use collections.defaultdict(list)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-defaultdict-list-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    $DICT.setdefault($KEY, []).append(...)\n", "output": "Vulnerability rule: manual-defaultdict-list-create\nMessage: manually creating a defaultdict - use collections.defaultdict(list)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: manual-counter-create\nPattern:\n$DICT = {}\n...\nfor $KEY, $VALUE in $OTHERDICT.items():\n    ...\n    if $KEY not in $DICT:\n        ...\n        $DICT[$KEY] = 0\n        ...\n    $DICT[$KEY] += 1\n", "output": "Vulnerability rule: manual-counter-create\nMessage: manually creating a counter - use collections.Counter\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/manual-collections-create.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hardcoded-tmp-path\nPattern:\nopen(\"=~/^\\/tmp.*/\", ...)", "output": "Vulnerability rule: hardcoded-tmp-path\nMessage: Detected hardcoded temp directory. Consider using 'tempfile.TemporaryFile' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/lang/best-practice/hardcoded-tmp-path.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: string-concat\nPattern:\nsh.$BIN($X + $Y)", "output": "Vulnerability rule: string-concat\nMessage: Detected string concatenation or formatting in a call to a command via 'sh'. This could be a command injection vulnerability if the data is user-controlled. Instead, use a list and append the argument.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sh/security/string-concat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: string-concat\nPattern:\nsh.$BIN($X.format(...))", "output": "Vulnerability rule: string-concat\nMessage: Detected string concatenation or formatting in a call to a command via 'sh'. This could be a command injection vulnerability if the data is user-controlled. Instead, use a list and append the argument.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sh/security/string-concat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: string-concat\nPattern:\nsh.$BIN(f\"...{...}...\")", "output": "Vulnerability rule: string-concat\nMessage: Detected string concatenation or formatting in a call to a command via 'sh'. This could be a command injection vulnerability if the data is user-controlled. Instead, use a list and append the argument.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/sh/security/string-concat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: check-is-none-explicitly\nPattern:\n$X and $X == 0", "output": "Vulnerability rule: check-is-none-explicitly\nMessage: This expression will always return False because 0 is a false-y value. So if $X is 0, then the first part of this expression will return False but if it is not, the second part will return False. Perhaps you meant to check if $X was None explicitly.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/correctness/check-is-none-explicitly.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: check-is-none-explicitly\nPattern:\n$X.get($FIELD) and $X[$FIELD] == 0", "output": "Vulnerability rule: check-is-none-explicitly\nMessage: This expression will always return False because 0 is a false-y value. So if $X is 0, then the first part of this expression will return False but if it is not, the second part will return False. Perhaps you meant to check if $X was None explicitly.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/correctness/check-is-none-explicitly.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: socket-shutdown-close\nPattern:\n$SOCK.shutdown(socket.$A)\n$SOCK.close()\n", "output": "Vulnerability rule: socket-shutdown-close\nMessage: Socket is not closed if shutdown fails. When socket.shutdown fails on an OSError, socket.close is not called and the code fails to clean up the socket and allow garbage collection to release the memory used for it. The OSError on shutdown can occur when the remote side of the connection closes the connection first.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/correctness/socket-shutdown-close.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-signals-weak\nPattern:\ndjango.dispatch.signals.Signal.disconnect(..., weak=$X, ...)", "output": "Vulnerability rule: django-compat-2_0-signals-weak\nMessage: The weak argument to django.dispatch.signals.Signal.disconnect() is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-check-aggregate-support\nPattern:\ndjango.db.backends.base.BaseDatabaseOperations.check_aggregate_support(...)", "output": "Vulnerability rule: django-compat-2_0-check-aggregate-support\nMessage: django.db.backends.base.BaseDatabaseOperations.check_aggregate_support() is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nfrom django.forms import extras", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nfrom django.forms.extras import $X", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nfrom django.forms import extras as $Y", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nfrom django.forms.extras import $X as $Y", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nimport django.forms.extras", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nimport django.forms.extras.$X", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nimport django.forms.extras as $Y", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-extra-forms\nPattern:\nimport django.forms.extras.$X as $Y", "output": "Vulnerability rule: django-compat-2_0-extra-forms\nMessage: The django.forms.extras package is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-assignment-tag\nPattern:\n$X.assignment_tag(...)", "output": "Vulnerability rule: django-compat-2_0-assignment-tag\nMessage: The assignment_tag helper is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-assignment-tag\nPattern:\nassignment_tag(...)", "output": "Vulnerability rule: django-compat-2_0-assignment-tag\nMessage: The assignment_tag helper is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-assert-redirects-helper\nPattern:\n$X.assertRedirects(..., host=$Y, ...)", "output": "Vulnerability rule: django-compat-2_0-assert-redirects-helper\nMessage: The host argument to assertRedirects is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-compat-2_0-assert-redirects-helper\nPattern:\nassertRedirects(..., host=$Y, ...)", "output": "Vulnerability rule: django-compat-2_0-assert-redirects-helper\nMessage: The host argument to assertRedirects is removed in Django 2.0.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/compatibility/django-2_0-compat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hashids-with-django-secret\nPattern:\nhashids.Hashids(..., salt=django.conf.settings.SECRET_KEY, ...)", "output": "Vulnerability rule: hashids-with-django-secret\nMessage: The Django secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Django secret key can be obtained by attackers, through the HashIDs.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A02:2021  Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/hashids-with-django-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: hashids-with-django-secret\nPattern:\nhashids.Hashids(django.conf.settings.SECRET_KEY, ...)", "output": "Vulnerability rule: hashids-with-django-secret\nMessage: The Django secret key is used as salt in HashIDs. The HashID mechanism is not secure. By observing sufficient HashIDs, the salt used to construct them can be recovered. This means the Django secret key can be obtained by attackers, through the HashIDs.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A02:2021  Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/hashids-with-django-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: locals-as-template-context\nPattern:\ndjango.shortcuts.render(..., locals(...), ...)", "output": "Vulnerability rule: locals-as-template-context\nMessage: Using 'locals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'locals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/locals-as-template-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: locals-as-template-context\nPattern:\ndjango.template.Template.render(..., locals(...), ...)", "output": "Vulnerability rule: locals-as-template-context\nMessage: Using 'locals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'locals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/locals-as-template-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: django-no-csrf-token\nPattern:\n<form...>...</form>", "output": "Vulnerability rule: django-no-csrf-token\nMessage: Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.\nSeverity: WARNING\nCWE: CWE-352: Cross-Site Request Forgery (CSRF)\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/django-no-csrf-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: globals-as-template-context\nPattern:\ndjango.shortcuts.render(..., globals(...), ...)", "output": "Vulnerability rule: globals-as-template-context\nMessage: Using 'globals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'globals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/globals-as-template-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: globals-as-template-context\nPattern:\ndjango.template.Template.render(..., globals(...), ...)", "output": "Vulnerability rule: globals-as-template-context\nMessage: Using 'globals()' as a context to 'render(...)' is extremely dangerous. This exposes Python functions to the template that were not meant to be exposed. An attacker could use these functions to execute code that was not intended to run and could compromise the application. (This is server-side template injection (SSTI)). Do not use 'globals()'. Instead, specify each variable in a dictionary or 'django.template.Context' object, like '{\"var1\": \"hello\"}' and use that instead.\nSeverity: ERROR\nCWE: [\"CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/globals-as-template-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-mark-safe\nPattern:\ndjango.utils.safestring.mark_safe(...)", "output": "Vulnerability rule: avoid-mark-safe\nMessage: 'mark_safe()' is used to mark a string as \"safe\" for HTML output. This disables escaping and could therefore subject the content to XSS attacks. Use 'django.utils.html.format_html()' to build HTML for rendering instead.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/avoid-mark-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: custom-expression-as-sql\nPattern:\n$EXPRESSION.as_sql(...)", "output": "Vulnerability rule: custom-expression-as-sql\nMessage: Detected a Custom Expression ''$EXPRESSION'' calling ''as_sql(...).'' This could lead to SQL injection, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/custom-expression-as-sql.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Func, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Func, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Expression, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Expression, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Value, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Value, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.DurationValue, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.DurationValue, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.RawSQL, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.RawSQL, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Star, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Star, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Random, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Random, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Col, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Col, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Ref, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Ref, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.ExpressionList, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.ExpressionList, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.ExpressionWrapper, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.ExpressionWrapper, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.When, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.When, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Case, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Case, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Subquery, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Subquery, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Exists, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Exists, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.Window, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.Window, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.WindowFrame, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.WindowFrame, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.RowRange, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.RowRange, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.ValueRange, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: extends-custom-expression\nPattern:\nclass $CLASS(..., django.db.models.expressions.ValueRange, ...):\n    ...\n", "output": "Vulnerability rule: extends-custom-expression\nMessage: Found extension of custom expression: $CLASS. Extending expressions in this way could inadvertently lead to a SQL injection vulnerability, which can result in attackers exfiltrating sensitive data. Instead, ensure no user input enters this function or that user input is properly sanitized.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/extends-custom-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-secure-set-cookie\nPattern:\nresponse.set_cookie(...)", "output": "Vulnerability rule: django-secure-set-cookie\nMessage: Django cookies should be handled securely by setting secure=True, httponly=True, and samesite='Lax' in response.set_cookie(...). If your situation calls for different settings, explicitly disable the setting. If you want to send the cookie over http, set secure=False. If you want to let client-side JavaScript read the cookie, set httponly=False. If you want to attach cookies to requests for external sites, set samesite=None.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/secure-cookies.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: no-csrf-exempt\nPattern:\n@django.views.decorators.csrf.csrf_exempt\ndef $R(...):\n  ...\n", "output": "Vulnerability rule: no-csrf-exempt\nMessage: Detected usage of @csrf_exempt, which indicates that there is no CSRF token set for this route. This could lead to an attacker manipulating the user's account and exfiltration of private data. Instead, create a function without this decorator.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/csrf-exempt.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: avoid-query-set-extra\nPattern:\n$MODEL.extra(...)", "output": "Vulnerability rule: avoid-query-set-extra\nMessage: QuerySet.extra' does not provide safeguards against SQL injection and requires very careful use. SQL injection can lead to critical data being stolen by attackers. Instead of using '.extra', use the Django ORM and parameterized queries such as `People.objects.get(name='Bob')`.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/query-set-extra.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: unvalidated-password\nPattern:\n$MODEL.set_password($X)", "output": "Vulnerability rule: unvalidated-password\nMessage: The password on '$MODEL' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.\nSeverity: WARNING\nCWE: ['CWE-521: Weak Password Requirements']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/unvalidated-password.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formathtml-fstring-parameter\nPattern:\nformat_html(<... f\"...\" ...>, ...)", "output": "Vulnerability rule: formathtml-fstring-parameter\nMessage: Passing a formatted string as first parameter to `format_html` disables the proper encoding of variables. Any HTML in the first parameter is not encoded. Using a formatted string as first parameter obscures which parameters are encoded. Correct use of `format_html` is passing a static format string as first parameter, and the variables to substitute as subsequent parameters.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/formathtml-fstring-parameter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formathtml-fstring-parameter\nPattern:\nformat_html(\"...\" % ..., ...)", "output": "Vulnerability rule: formathtml-fstring-parameter\nMessage: Passing a formatted string as first parameter to `format_html` disables the proper encoding of variables. Any HTML in the first parameter is not encoded. Using a formatted string as first parameter obscures which parameters are encoded. Correct use of `format_html` is passing a static format string as first parameter, and the variables to substitute as subsequent parameters.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/formathtml-fstring-parameter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: formathtml-fstring-parameter\nPattern:\nformat_html(\"...\".format(...), ...)", "output": "Vulnerability rule: formathtml-fstring-parameter\nMessage: Passing a formatted string as first parameter to `format_html` disables the proper encoding of variables. Any HTML in the first parameter is not encoded. Using a formatted string as first parameter obscures which parameters are encoded. Correct use of `format_html` is passing a static format string as first parameter, and the variables to substitute as subsequent parameters.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/formathtml-fstring-parameter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-var-unescaped-with-safeseq\nPattern:\n{{.*?\\|\\s+safeseq(\\s+}})?", "output": "Vulnerability rule: template-var-unescaped-with-safeseq\nMessage: Detected a template variable where autoescaping is explicitly disabled with '| safeseq' filter. This allows rendering of raw HTML in this segment. Ensure no user data is rendered here, otherwise this is a cross-site scripting (XSS) vulnerability. If you must do this, use `mark_safe` in your Python code.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/template-var-unescaped-with-safeseq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: html-safe\nPattern:\ndjango.utils.html.html_safe(...)", "output": "Vulnerability rule: html-safe\nMessage: `html_safe()` add the `__html__` magic method to the provided class. The `__html__` method indicates to the Django template engine that the value is 'safe' for rendering. This means that normal HTML escaping will not be applied to the return value. This exposes your application to cross-site scripting (XSS) vulnerabilities. If you need to render raw HTML, consider instead using `mark_safe()` which more clearly marks the intent to render raw HTML than a class with a magic method.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: html-safe\nPattern:\n@django.utils.html.html_safe\nclass $CLASS(...):\n  ...\n", "output": "Vulnerability rule: html-safe\nMessage: `html_safe()` add the `__html__` magic method to the provided class. The `__html__` method indicates to the Django template engine that the value is 'safe' for rendering. This means that normal HTML escaping will not be applied to the return value. This exposes your application to cross-site scripting (XSS) vulnerabilities. If you need to render raw HTML, consider instead using `mark_safe()` which more clearly marks the intent to render raw HTML than a class with a magic method.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: class-extends-safestring\nPattern:\nclass $CLASS(django.utils.safestring.SafeString):\n  ...\n", "output": "Vulnerability rule: class-extends-safestring\nMessage: Found a class extending 'SafeString', 'SafeText' or 'SafeData'. These classes are for bypassing the escaping engine built in to Django and should not be used directly. Improper use of this class exposes your application to cross-site scripting (XSS) vulnerabilities. If you need this functionality, use 'mark_safe' instead and ensure no user data can reach it.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/class-extends-safestring.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: class-extends-safestring\nPattern:\nclass $CLASS(django.utils.safestring.SafeText):\n  ...\n", "output": "Vulnerability rule: class-extends-safestring\nMessage: Found a class extending 'SafeString', 'SafeText' or 'SafeData'. These classes are for bypassing the escaping engine built in to Django and should not be used directly. Improper use of this class exposes your application to cross-site scripting (XSS) vulnerabilities. If you need this functionality, use 'mark_safe' instead and ensure no user data can reach it.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/class-extends-safestring.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: class-extends-safestring\nPattern:\nclass $CLASS(django.utils.safestring.SafeData):\n  ...", "output": "Vulnerability rule: class-extends-safestring\nMessage: Found a class extending 'SafeString', 'SafeText' or 'SafeData'. These classes are for bypassing the escaping engine built in to Django and should not be used directly. Improper use of this class exposes your application to cross-site scripting (XSS) vulnerabilities. If you need this functionality, use 'mark_safe' instead and ensure no user data can reach it.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/class-extends-safestring.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-autoescape-off\nPattern:\n{%\\s+autoescape\\s+off\\s+%}", "output": "Vulnerability rule: template-autoescape-off\nMessage: Detected a template block where autoescaping is explicitly disabled with '{% autoescape off %}'. This allows rendering of raw HTML in this segment. Turn autoescaping on to prevent cross-site scripting (XSS). If you must do this, consider instead, using `mark_safe` in Python code.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/template-autoescape-off.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: html-magic-method\nPattern:\ndef __html__(...):\n  ...\n", "output": "Vulnerability rule: html-magic-method\nMessage: The `__html__` method indicates to the Django template engine that the value is 'safe' for rendering. This means that normal HTML escaping will not be applied to the return value. This exposes your application to cross-site scripting (XSS) vulnerabilities. If you need to render raw HTML, consider instead using `mark_safe()` which more clearly marks the intent to render raw HTML than a class with a magic method.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/html-magic-method.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: global-autoescape-off\nPattern:\n{..., 'BACKEND': ..., 'OPTIONS': {..., 'autoescape': $FALSE, ...}, ...}\n", "output": "Vulnerability rule: global-autoescape-off\nMessage: Autoescape is globally disbaled for this Django application. If you are rendering any web pages, this exposes your application to cross-site scripting (XSS) vulnerabilities. Remove 'autoescape: False' or set it to 'True'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/global-autoescape-off.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: filter-with-is-safe\nPattern:\n@register.filter(..., is_safe=True, ...)\ndef $FILTER(...):\n  ...", "output": "Vulnerability rule: filter-with-is-safe\nMessage: Detected Django filters flagged with 'is_safe'. 'is_safe' tells Django not to apply escaping on the value returned by this filter (although the input is escaped). Used improperly, 'is_safe' could expose your application to cross-site scripting (XSS) vulnerabilities. Ensure this filter does not 1) add HTML characters, 2) remove characters, or 3) use external data in any way. Consider instead removing 'is_safe' and explicitly marking safe content with 'mark_safe()'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/xss/filter-with-is-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: missing-throttle-config\nPattern:\nREST_FRAMEWORK", "output": "Vulnerability rule: missing-throttle-config\nMessage: Django REST framework configuration is missing default rate- limiting options. This could inadvertently allow resource starvation or Denial of Service (DoS) attacks. Add 'DEFAULT_THROTTLE_CLASSES' and 'DEFAULT_THROTTLE_RATES' to add rate-limiting to your application.\nSeverity: WARNING\nCWE: ['CWE-770: Allocation of Resources Without Limits or Throttling']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/django-rest-framework/missing-throttle-config.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: debug-template-tag\nPattern:\n({% debug %})", "output": "Vulnerability rule: debug-template-tag\nMessage: Detected a debug template tag in a Django template. This dumps debugging information to the page when debug mode is enabled. Showing debug information to users is dangerous because it may reveal information about your environment that malicious actors can use to gain access to the system. Remove the debug tag.\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: A06:2017 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/audit/templates/debug-template-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: mass-assignment\nPattern:\n$MODEL.objects.create(**request.$W)", "output": "Vulnerability rule: mass-assignment\nMessage: Mass assignment detected. This can result in assignment to model fields that are unintended and can be exploited by an attacker. Instead of using '**request.$W', assign each field you want to edit individually to prevent mass assignment. You can read more about mass assignment at https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html.\nSeverity: WARNING\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/mass-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: mass-assignment\nPattern:\n$OBJ.update(**request.$W)\n...\n$OBJ.save()\n", "output": "Vulnerability rule: mass-assignment\nMessage: Mass assignment detected. This can result in assignment to model fields that are unintended and can be exploited by an attacker. Instead of using '**request.$W', assign each field you want to edit individually to prevent mass assignment. You can read more about mass assignment at https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html.\nSeverity: WARNING\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/mass-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$F.write(..., request.$W.get(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$F.write(..., $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$F.write(..., $STR % $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W.get(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$A = $F.write(..., request.$W.get(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\nreturn $F.write(..., request.$W.get(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$F.write(..., request.$W(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$F.write(..., $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$F.write(..., $STR % $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W(...)\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$A = $F.write(..., request.$W(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\nreturn $F.write(..., request.$W(...), ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$F.write(..., request.$W[...], ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$F.write(..., $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$F.write(..., $STR % $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W[...]\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$A = $F.write(..., request.$W[...], ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\nreturn $F.write(..., request.$W[...], ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$F.write(..., request.$W, ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$F.write(..., $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$INTERM = $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$F.write(..., $B.$C(..., $DATA, ...), ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$INTERM = $B.$C(..., $DATA, ...)\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$F.write(..., $STR % $DATA, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$INTERM = $STR % $DATA\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$F.write(..., f\"...{$DATA}...\", ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$DATA = request.$W\n...\n$INTERM = f\"...{$DATA}...\"\n...\n$F.write(..., $INTERM, ...)\n", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\n$A = $F.write(..., request.$W, ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: request-data-write\nPattern:\nreturn $F.write(..., request.$W, ...)", "output": "Vulnerability rule: request-data-write\nMessage: Found user-controlled request data passed into '.write(...)'. This could be dangerous if a malicious actor is able to control data into sensitive files. For example, a malicious actor could force rolling of critical log files, or cause a denial-of-service by using up available disk space. Instead, ensure that request data is properly escaped or sanitized.\nSeverity: WARNING\nCWE: [\"CWE-93: Improper Neutralization of CRLF Sequences ('CRLF Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/security/injection/request-data-write.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: duplicate-path-assignment\nPattern:\n[..., django.urls.path('$URL', $VIEW, ...), ..., django.urls.path('$URL', $VIEW, ...), ...]\n", "output": "Vulnerability rule: duplicate-path-assignment\nMessage: path for `$URL` is uselessly assigned twice\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/maintainability/duplicate-path-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: conflicting-path-assignment\nPattern:\n[..., django.urls.path('$URL', $VIEW, ...), ..., django.urls.path('$URL', $DIFFERENT_VIEW, ...), ...]\n", "output": "Vulnerability rule: conflicting-path-assignment\nMessage: The path for `$URL` is assigned once to view `$VIEW` and once to `$DIFFERENT_VIEW`, which can lead to unexpected behavior. Verify what the intended target view is and delete the other route.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/maintainability/duplicate-path-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: duplicate-path-assignment-different-names\nPattern:\n[..., django.urls.path('$URL', $VIEW, name='$NAME', ...), ..., django.urls.path('$URL', $VIEW, name='$OTHER_NAME', ...), ...]\n", "output": "Vulnerability rule: duplicate-path-assignment-different-names\nMessage: path for `$URL` is assigned twice with different names\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/maintainability/duplicate-path-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: duplicate-name-assignment\nPattern:\n[..., django.urls.path('$URL', $VIEW, name='$NAME', ...), ..., django.urls.path('$OTHER_URL', $OTHER_VIEW, name='$NAME', ...), ...]\n", "output": "Vulnerability rule: duplicate-name-assignment\nMessage: The name `$NAME` is used for both `$URL` and `$OTHER_URL`, which can lead to unexpected behavior when using URL reversing. Pick a unique name for each path.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/maintainability/duplicate-path-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-decimalfield-for-money\nPattern:\n$F = django.db.models.FloatField(...)", "output": "Vulnerability rule: use-decimalfield-for-money\nMessage: Found a FloatField used for variable $F. Use DecimalField for currency fields to avoid float-rounding errors.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/correctness/use-decimalfield-for-money.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: django-db-model-save-super\nPattern:\ndef save(self, ...):\n  ...\n", "output": "Vulnerability rule: django-db-model-save-super\nMessage: Detected a django model `$MODEL` is not calling super().save() inside of the save method.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/correctness/model-save.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: nontext-field-must-set-null-true\nPattern:\n$F = $X(..., blank=True, ...)", "output": "Vulnerability rule: nontext-field-must-set-null-true\nMessage: null=True should be set if blank=True is set on non-text fields.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/correctness/nontext-field-must-set-null-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: access-foreign-keys\nPattern:\n$X.user.id", "output": "Vulnerability rule: access-foreign-keys\nMessage: You should use ITEM.user_id rather than ITEM.user.id to prevent running an extra query.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/access-foreign-keys.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-earliest-or-latest\nPattern:\n$X.objects.order_by(...)[0]", "output": "Vulnerability rule: use-earliest-or-latest\nMessage: Looks like you are only accessing first element of an ordered QuerySet. Use `latest()` or `earliest()` instead. See https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet.latest\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell_earliest_latest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-earliest-or-latest\nPattern:\n$X.objects.$FUNC(...).order_by(...)[0]", "output": "Vulnerability rule: use-earliest-or-latest\nMessage: Looks like you are only accessing first element of an ordered QuerySet. Use `latest()` or `earliest()` instead. See https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet.latest\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell_earliest_latest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-earliest-or-latest\nPattern:\n$X.objects.$FUNC(...).$FILTER(...).order_by(...)[0]", "output": "Vulnerability rule: use-earliest-or-latest\nMessage: Looks like you are only accessing first element of an ordered QuerySet. Use `latest()` or `earliest()` instead. See https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet.latest\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell_earliest_latest.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-count-method\nPattern:\n$X.objects.$FUNC(...).len()", "output": "Vulnerability rule: use-count-method\nMessage: Looks like you need to determine the number of records. Django provides the count() method which is more efficient than .len(). See https://docs.djangoproject.com/en/3.0/ref/models/querysets/\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell-count.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-count-method\nPattern:\n$X.objects.$FUNC(...).$FILTER().len()", "output": "Vulnerability rule: use-count-method\nMessage: Looks like you need to determine the number of records. Django provides the count() method which is more efficient than .len(). See https://docs.djangoproject.com/en/3.0/ref/models/querysets/\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell-count.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-count-method\nPattern:\n$X.objects.$FUNC(...).$FILTER().$UPDATE(...).len()", "output": "Vulnerability rule: use-count-method\nMessage: Looks like you need to determine the number of records. Django provides the count() method which is more efficient than .len(). See https://docs.djangoproject.com/en/3.0/ref/models/querysets/\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/performance/upsell-count.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-onetoonefield\nPattern:\n$F = django.db.models.ForeignKey(..., unique=True, ...)", "output": "Vulnerability rule: use-onetoonefield\nMessage: Use 'django.db.models.OneToOneField' instead of 'ForeignKey' with unique=True. 'OneToOneField' is used to create one-to-one relationships.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/best-practice/use-onetoonefield.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: use-json-response\nPattern:\n$Y = json.dumps(...)\n...\ndjango.http.HttpResponse($Y, ...)\n", "output": "Vulnerability rule: use-json-response\nMessage: Use JsonResponse instead\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: python/django/best-practice/json_response.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: read-string-unsafe\nPattern:\n(read-string $X)\n", "output": "Vulnerability rule: read-string-unsafe\nMessage: The default core Clojure read-string method is dangerous and can lead to deserialization vulnerabilities. Use the edn/read-string instead.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/security/clojure-read-string/read-string-unsafe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(MessageDigest/getInstance \"MD5\")", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(MessageDigest/getInstance MessageDigestAlgorithms/MD5)", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(MessageDigest/getInstance org.apache.commons.codec.digest.MessageDigestAlgorithms/MD5)", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(java.security.MessageDigest/getInstance \"MD5\")", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(java.security.MessageDigest/getInstance MessageDigestAlgorithms/MD5)", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): clojure\nSemgrep rule id: use-of-md5\nPattern:\n(java.security.MessageDigest/getInstance org.apache.commons.codec.digest.MessageDigestAlgorithms/MD5)", "output": "Vulnerability rule: use-of-md5\nMessage: MD5 hash algorithm detected. This is not collision resistant and leads to easily-cracked password hashes. Replace with current recommended hashing algorithms.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: clojure/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: atom_exhaustion\nPattern:\n$MODULE.to_atom($STRING)", "output": "Vulnerability rule: atom_exhaustion\nMessage: Atom values are appended to a global table but never removed. If input is user-controlled, dynamic instantiations such as `String.to_atom` or `List.to_atom` can lead to possible memory leaks. Instead, use `String.to_existing_atom` or `List.to_existing_atom`.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/correctness/atom-exhaustion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_into\nPattern:\nEnum.into(Enum.map($E, $FUN), $INTO)\n", "output": "Vulnerability rule: enum_map_into\nMessage: Using `Enum.into/3` is more efficient than using `Enum.map/2 |> Enum.into/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-into.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_into\nPattern:\nEnum.map($E, $FUN)\n|> Enum.into($INTO)\n", "output": "Vulnerability rule: enum_map_into\nMessage: Using `Enum.into/3` is more efficient than using `Enum.map/2 |> Enum.into/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-into.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_into\nPattern:\n$E\n|> Enum.map($FUN)\n|> Enum.into($INTO)\n", "output": "Vulnerability rule: enum_map_into\nMessage: Using `Enum.into/3` is more efficient than using `Enum.map/2 |> Enum.into/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-into.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: deprecated_calendar_iso_day_of_week_3\nPattern:\n$VAR = Calendar.ISO.day_of_week($YEAR, $MONTH, $DAY)", "output": "Vulnerability rule: deprecated_calendar_iso_day_of_week_3\nMessage: `Calendar.ISO.day_of_week/3` is already deprecated. Please use `Calendar.ISO.day_of_week/4` instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/deprecated-calendar-iso-day-of-week-3.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: deprecated_bxor_operator\nPattern:\n$LEFT ^^^ $RIGHT", "output": "Vulnerability rule: deprecated_bxor_operator\nMessage: The bitwise operator (`^^^`) is already deprecated. Please use `Bitwise.bxor($LEFT, $RIGHT)` instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/deprecated-bxor-operator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_join\nPattern:\nEnum.join(Enum.map($E, $FUN), $JOINER)\n", "output": "Vulnerability rule: enum_map_join\nMessage: Using `Enum.map_join/3` is more efficient than using `Enum.map/2 |> Enum.join/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-join.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_join\nPattern:\nEnum.map($E, $FUN)\n|> Enum.join($JOINER)\n", "output": "Vulnerability rule: enum_map_join\nMessage: Using `Enum.map_join/3` is more efficient than using `Enum.map/2 |> Enum.join/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-join.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: enum_map_join\nPattern:\n$E\n|> Enum.map($FUN)\n|> Enum.join($JOINER)\n", "output": "Vulnerability rule: enum_map_join\nMessage: Using `Enum.map_join/3` is more efficient than using `Enum.map/2 |> Enum.join/2`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/enum-map-join.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: deprecated_bnot_operator\nPattern:\n~~~$VAL", "output": "Vulnerability rule: deprecated_bnot_operator\nMessage: The bitwise operator (`^^^`) is already deprecated. Please use `Bitwise.bnot($VAL)` instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/deprecated-bnot-operator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): elixir\nSemgrep rule id: deprecated_use_bitwise\nPattern:\nuse Bitwise", "output": "Vulnerability rule: deprecated_use_bitwise\nMessage: The syntax `use Bitwise` is already deprecated. Please use `import Bitwise` instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: elixir/lang/best-practice/deprecated-use-bitwise.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-user-entrypoint\nPattern:\nENTRYPOINT $...VARS\n", "output": "Vulnerability rule: missing-user-entrypoint\nMessage: By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.\nSeverity: ERROR\nCWE: ['CWE-269: Improper Privilege Management']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/security/missing-user-entrypoint.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-user\nPattern:\nCMD $...VARS\n", "output": "Vulnerability rule: missing-user\nMessage: By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.\nSeverity: ERROR\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/security/missing-user.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: last-user-is-root\nPattern:\nUSER root", "output": "Vulnerability rule: last-user-is-root\nMessage: The last user in the container is 'root'. This is a security hazard because if an attacker gains control of the container they will have root access. Switch back to another user after running commands as 'root'.\nSeverity: ERROR\nCWE: ['CWE-269: Improper Privilege Management']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/security/last-user-is-root.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: no-sudo-in-dockerfile\nPattern:\nRUN sudo ...\n", "output": "Vulnerability rule: no-sudo-in-dockerfile\nMessage: Avoid using sudo in Dockerfiles. Running processes as a non-root user can help  reduce the potential impact of configuration errors and security vulnerabilities.\nSeverity: WARNING\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/security/no-sudo-in-dockerfile.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: dockerfile-pip-extra-index-url\nPattern:\nRUN ... $PIP install ... --extra-index-url ...\n", "output": "Vulnerability rule: dockerfile-pip-extra-index-url\nMessage: When `--extra-index-url` is used in a `pip install` command, this is usually meant to  install a package from a package index other than the public one.  However, if a package is added with the same name to the public PyPi repository, and if the version number is high enough, this package will be installed when building this docker image. This package may be a malicious dependency. Such an attack is called a dependency confusion attack. If using a private package index, prefer to use `--index-url` if possible. \nSeverity: INFO\nCWE: ['CWE-427: Uncontrolled Search Path Element']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/audit/dockerfile-pip-extra-index-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: multiple-entrypoint-instructions\nPattern:\nENTRYPOINT ...\n...\n$ENTRYPOINT_INSTR\n", "output": "Vulnerability rule: multiple-entrypoint-instructions\nMessage: Multiple ENTRYPOINT instructions were found. Only the last one will take effect.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/correctness/multiple-entrypoint-instructions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-assume-yes-switch\nPattern:\nRUN ... apt-get install ... $MULTIFLAG ... \n", "output": "Vulnerability rule: missing-assume-yes-switch\nMessage: This 'apt-get install' is missing the '-y' switch. This might stall builds because it requires human intervention. Add the '-y' switch.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/correctness/missing-assume-yes-switch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-dnf-update\nPattern:\ndnf update", "output": "Vulnerability rule: avoid-dnf-update\nMessage: Packages in base images should be up-to-date, removing the need for 'dnf update'. If packages are out-of-date, consider contacting the base image maintainer.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-dnf-update.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-dnf-clean-all\nPattern:\nRUN ... dnf ...", "output": "Vulnerability rule: missing-dnf-clean-all\nMessage: This dnf command does not end with '&& dnf clean all'. Running 'dnf clean all' will remove cached data and reduce package size. (This must be performed in the same RUN step.)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-dnf-clean-all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-dnf-assume-yes-switch\nPattern:\nRUN ... dnf install ...\n", "output": "Vulnerability rule: missing-dnf-assume-yes-switch\nMessage: This 'dnf install' is missing the '-y' switch. This might stall builds because it requires human intervention. Add the '-y' switch.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-dnf-assume-yes-switch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: prefer-copy-over-add\nPattern:\nADD $FROM $TO\n", "output": "Vulnerability rule: prefer-copy-over-add\nMessage: The ADD command will accept and include files from a URL and automatically extract archives. This potentially exposes the container to a man-in-the-middle attack or other attacks if a malicious actor can tamper with the source archive. Since ADD can have this and other unexpected side effects, the use of the more explicit COPY command is preferred.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/prefer-copy-over-add.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: use-either-wget-or-curl\nPattern:\nRUN wget ...\n...\nRUN curl ...\n", "output": "Vulnerability rule: use-either-wget-or-curl\nMessage: 'wget' and 'curl' are similar tools. Choose one and do not install the other to decrease image size.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/use-either-wget-or-curl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: use-either-wget-or-curl\nPattern:\nRUN curl ...\n...\nRUN wget ...\n", "output": "Vulnerability rule: use-either-wget-or-curl\nMessage: 'wget' and 'curl' are similar tools. Choose one and do not install the other to decrease image size.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/use-either-wget-or-curl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: maintainer-is-deprecated\nPattern:\nMAINTAINER $NAME", "output": "Vulnerability rule: maintainer-is-deprecated\nMessage: MAINTAINER has been deprecated.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/maintainer-is-deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-zypper-update\nPattern:\nzypper update ...", "output": "Vulnerability rule: avoid-zypper-update\nMessage: Packages in base images should be up-to-date, removing the need for 'zypper update'. If packages are out-of-date, consider contacting the base image maintainer.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-zypper-update.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-apt-get-upgrade\nPattern:\nRUN ... apt-get upgrade ...", "output": "Vulnerability rule: avoid-apt-get-upgrade\nMessage: Packages in base containers should be up-to-date, removing the need to upgrade or dist-upgrade. If a package is out of date, contact the maintainers.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-apt-get-upgrade.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-apt-get-upgrade\nPattern:\nRUN ... apt-get dist-upgrade ...", "output": "Vulnerability rule: avoid-apt-get-upgrade\nMessage: Packages in base containers should be up-to-date, removing the need to upgrade or dist-upgrade. If a package is out of date, contact the maintainers.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-apt-get-upgrade.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-zypper-clean\nPattern:\nRUN ... zypper $COMMAND ...", "output": "Vulnerability rule: missing-zypper-clean\nMessage: This zypper command does not end with '&& zypper clean'. Running 'zypper clean' will remove cached data and reduce package size. (This must be performed in the same RUN step.)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-zypper-clean.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: remove-package-cache\nPattern:\nRUN ... apt-get update ...", "output": "Vulnerability rule: remove-package-cache\nMessage: The package cache was not deleted after running 'apt-get update', which increases the size of the image. Remove the package cache by appending '&& apt-get clean' at the end of apt-get command chain.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/remove-package-cache.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: remove-package-cache\nPattern:\napt-get update", "output": "Vulnerability rule: remove-package-cache\nMessage: The package cache was not deleted after running 'apt-get update', which increases the size of the image. Remove the package cache by appending '&& apt-get clean' at the end of apt-get command chain.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/remove-package-cache.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: nonsensical-command\nPattern:\nRUN $CMD ...", "output": "Vulnerability rule: nonsensical-command\nMessage: Some commands such as `$CMD` do not make sense in a container. Do not use these.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/nonsensical-command.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: remove-package-lists\nPattern:\nRUN apt-get update ...", "output": "Vulnerability rule: remove-package-lists\nMessage: The package lists were not deleted after running 'apt-get update', which increases the size of the image. Remove the package lists by appending '&& rm -rf /var/lib/apt/lists/*' at the end of apt-get command chain.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/remove-package-lists.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: remove-package-lists\nPattern:\napt-get update", "output": "Vulnerability rule: remove-package-lists\nMessage: The package lists were not deleted after running 'apt-get update', which increases the size of the image. Remove the package lists by appending '&& rm -rf /var/lib/apt/lists/*' at the end of apt-get command chain.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/remove-package-lists.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-yum-assume-yes-switch\nPattern:\nRUN ... yum install ...\n", "output": "Vulnerability rule: missing-yum-assume-yes-switch\nMessage: This 'yum install' is missing the '-y' switch. This might stall builds because it requires human intervention. Add the '-y' switch.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-yum-assume-yes-switch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-apk-upgrade\nPattern:\nRUN ... apk upgrade ...", "output": "Vulnerability rule: avoid-apk-upgrade\nMessage: Packages in base images should be up-to-date, removing the need for 'apk upgrade'. If packages are out-of-date, consider contacting the base image maintainer.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-apk-upgrade.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-platform-with-from\nPattern:\nFROM --platform=$PLATFORM $IMAGE", "output": "Vulnerability rule: avoid-platform-with-from\nMessage: Using '--platform' with FROM restricts the image to build on a single platform. Further, this must be the same as the build platform. If you intended to specify the target platform, use the utility 'docker buildx --platform=' instead.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-platform-with-from.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-latest-version\nPattern:\nFROM $FROM:latest", "output": "Vulnerability rule: avoid-latest-version\nMessage: Images should be tagged with an explicit version to produce deterministic container images. The 'latest' tag may change the base container without warning.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-latest-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: avoid-yum-update\nPattern:\nyum update", "output": "Vulnerability rule: avoid-yum-update\nMessage: Packages in base images should be up-to-date, removing the need for 'yum update'. If packages are out-of-date, consider contacting the base image maintainer.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/avoid-yum-update.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: use-shell-instruction\nPattern:\nRUN ln ... $SHELL /bin/sh\n", "output": "Vulnerability rule: use-shell-instruction\nMessage: Use the SHELL instruction to set the default shell instead of overwriting '/bin/sh'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/use-shell-instruction.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: prefer-apt-get\nPattern:\nRUN apt ...", "output": "Vulnerability rule: prefer-apt-get\nMessage: 'apt-get' is preferred as an unattended tool for stability. 'apt' is discouraged.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/prefer-apt-get.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-no-install-recommends\nPattern:\nRUN apt-get install ...\n", "output": "Vulnerability rule: missing-no-install-recommends\nMessage: This 'apt-get install' is missing '--no-install-recommends'. This prevents unnecessary packages from being installed, thereby reducing image size. Add '--no-install-recommends'.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-no-install-recommends.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-apk-no-cache\nPattern:\nRUN apk $COMMAND ...\n", "output": "Vulnerability rule: missing-apk-no-cache\nMessage: This apk command is missing '--no-cache'. This forces apk to use a package index instead of a local package cache, removing the need for '--update' and the deletion of '/var/cache/apk/*'. Add '--no-cache' to your apk command.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: dockerfile/best-practice/missing-apk-no-cache.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: useless-ternary\nPattern:\n$CONDITION ? $ANS : $ANS\n", "output": "Vulnerability rule: useless-ternary\nMessage: It looks like no matter how $CONDITION is evaluated, this expression returns $ANS. This is probably a copy-paste error.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/lang/correctness/useless-ternary.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: moment-deprecated\nPattern:\nimport 'moment'\n", "output": "Vulnerability rule: moment-deprecated\nMessage: Moment is a legacy project in maintenance mode. Consider using libraries that are actively supported, e.g. `dayjs`.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/lang/best-practice/moment-deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-xss-disabled\nPattern:\nclass $CN {\n    ...\n    @Header(\"=~/[Xx]-[Xx][Ss][Ss]-[Pp][Rr][Oo][Tt][Ee][Cc][Tt][Ii][Oo][Nn]/\", '0')\n    $FN(...) {\n        ...\n    }\n    ...\n}\n", "output": "Vulnerability rule: nestjs-header-xss-disabled\nMessage: X-XSS-Protection header is set to 0. This will disable the browser's XSS Filter.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-xss-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-open-redirect\nPattern:\nreturn {url: $URL}\n", "output": "Vulnerability rule: nestjs-open-redirect\nMessage: Untrusted user input in {url: ...} can result in Open Redirect vulnerability.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-open-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-cors-any\nPattern:\nclass $CN {\n    @Header(\"=~/[Aa][Cc][Cc][Ee][Ss][Ss]-[Cc][Oo][Nn][Tt][Rr][Oo][Ll]-[Aa][Ll][Ll][Oo][Ww]-[Oo][Rr][Ii][Gg][Ii][Nn]/\", '*')\n    $FN(...) {\n        ...\n    }\n}\n", "output": "Vulnerability rule: nestjs-header-cors-any\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-cors-any.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-cors-any\nPattern:\nNestFactory.create($MODULE, {cors: true})\n", "output": "Vulnerability rule: nestjs-header-cors-any\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-cors-any.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-cors-any\nPattern:\nNestFactory.create($MODULE, {cors: {origin: '*'}})\n", "output": "Vulnerability rule: nestjs-header-cors-any\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-cors-any.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-cors-any\nPattern:\n$APP.enableCors()\n", "output": "Vulnerability rule: nestjs-header-cors-any\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-cors-any.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript\nSemgrep rule id: nestjs-header-cors-any\nPattern:\n$APP.enableCors({origin: '*'})\n", "output": "Vulnerability rule: nestjs-header-cors-any\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/nestjs/security/audit/nestjs-header-cors-any.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: react-jwt-decoded-property\nPattern:\n$DECODED.$PROPERTY", "output": "Vulnerability rule: react-jwt-decoded-property\nMessage: Property decoded from JWT token without verifying and cannot be trustworthy.\nSeverity: INFO\nCWE: ['CWE-922: Insecure Storage of Sensitive Information']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/security/audit/react-jwt-decoded-property.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: jsx-not-internationalized\nPattern:\n<$ELEMENT>$MESSAGE</$ELEMENT>", "output": "Vulnerability rule: jsx-not-internationalized\nMessage: JSX element not internationalized: '$MESSAGE'.  You should support different languages in your website or app with internationalization. Instead, use packages such as `i18next` in order to internationalize your elements.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/portability/i18next/jsx-not-internationalized.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: useselect-label-not-i18n\nPattern:\nuseSelect($X1, $X2, '$LABEL', $X4)", "output": "Vulnerability rule: useselect-label-not-i18n\nMessage: React useSelect() label is not internationalized - '$LABEL'. You should support different langauges in your website or app with internationalization. Instead, use packages such as `i18next` to internationalize your elements.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/portability/i18next/useselect-label-not-i18n.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: mui-snackbar-message\nPattern:\nenqueueSnackbar('$MESSAGE', $X2)", "output": "Vulnerability rule: mui-snackbar-message\nMessage: React MUI enqueueSnackbar() title is not internationalized: '$MESSAGE'\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/portability/i18next/mui-snackbar-message.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: react-legacy-component\nPattern:\n$METHOD(...) {\n  ...\n}\n", "output": "Vulnerability rule: react-legacy-component\nMessage: Legacy component lifecycle was detected - $METHOD.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/best-practice/react-legacy-component.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: react-props-spreading\nPattern:\n<$X {...$PROPS} />", "output": "Vulnerability rule: react-props-spreading\nMessage: It's best practice to explicitly pass props to an HTML component rather than use the spread operator. The spread operator risks passing invalid HTML props to an HTML element, which can cause console warnings or worse, give malicious actors a way to inject unexpected attributes.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/best-practice/react-props-spreading.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: react-find-dom\nPattern:\nfindDOMNode(...)\n", "output": "Vulnerability rule: react-find-dom\nMessage: findDOMNode is an escape hatch used to access the underlying DOM node. In most cases, use of this escape hatch is discouraged because it pierces the component abstraction.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/best-practice/react-find-dom.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): typescript, javascript\nSemgrep rule id: react-find-dom\nPattern:\n$DOM.findDOMNode(...)\n", "output": "Vulnerability rule: react-find-dom\nMessage: findDOMNode is an escape hatch used to access the underlying DOM node. In most cases, use of this escape hatch is discouraged because it pierces the component abstraction.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: typescript/react/best-practice/react-find-dom.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: find-sql-string-concatenation\nPattern:\n$RETURN $METHOD(...,String $X,...){\n  ...\n  Session $SESSION = ...;\n  ...\n  String $QUERY = ... + $X + ...;\n  ...\n  PreparedStatement $PS = $SESSION.connection().prepareStatement($QUERY);\n  ...\n  ResultSet $RESULT = $PS.executeQuery();\n  ...\n}\n", "output": "Vulnerability rule: find-sql-string-concatenation\nMessage: In $METHOD, $X is used to construct a SQL query via string concatenation.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jboss/security/session_sqli.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: find-sql-string-concatenation\nPattern:\n$RETURN $METHOD(...,String $X,...){\n  ...\n  String $QUERY = ... + $X + ...;\n  ...\n  Session $SESSION = ...;\n  ...\n  PreparedStatement $PS = $SESSION.connection().prepareStatement($QUERY);\n  ...\n  ResultSet $RESULT = $PS.executeQuery();\n  ...\n}\n", "output": "Vulnerability rule: find-sql-string-concatenation\nMessage: In $METHOD, $X is used to construct a SQL query via string concatenation.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jboss/security/session_sqli.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: seam-log-injection\nPattern:\n$LOG.$INFO($X + $Y,...)\n", "output": "Vulnerability rule: seam-log-injection\nMessage: Seam Logging API support an expression language to introduce bean property to log messages. The expression language can also be the source to unwanted code execution. In this context, an expression is built with a dynamic value. The source of the value(s) should be verified to avoid that unfiltered values fall into this risky code evaluation.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jboss/security/seam-log-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: jjwt-none-alg\nPattern:\nio.jsonwebtoken.Jwts.builder();\n", "output": "Vulnerability rule: jjwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jjwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-resteasy-deserialization\nPattern:\n@Consumes({\"application/x-java-serialized-object\"})\n", "output": "Vulnerability rule: insecure-resteasy-deserialization\nMessage: When a Restful webservice endpoint is configured to use wildcard mediaType {*/*} as a value for the @Consumes annotation, an attacker could abuse the SerializableProvider by sending a HTTP Request with a Content-Type of application/x-java-serialized-object. The body of that request would be processed by the SerializationProvider and could contain a malicious payload, which may lead to arbitrary code execution when calling the $Y.getObject method.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/insecure-resteasy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-resteasy-deserialization\nPattern:\n@Consumes({\"*/*\"})\n", "output": "Vulnerability rule: insecure-resteasy-deserialization\nMessage: When a Restful webservice endpoint is configured to use wildcard mediaType {*/*} as a value for the @Consumes annotation, an attacker could abuse the SerializableProvider by sending a HTTP Request with a Content-Type of application/x-java-serialized-object. The body of that request would be processed by the SerializationProvider and could contain a malicious payload, which may lead to arbitrary code execution when calling the $Y.getObject method.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/insecure-resteasy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-resteasy-deserialization\nPattern:\n@Consumes(\"*/*\")\n", "output": "Vulnerability rule: insecure-resteasy-deserialization\nMessage: When a Restful webservice endpoint is configured to use wildcard mediaType {*/*} as a value for the @Consumes annotation, an attacker could abuse the SerializableProvider by sending a HTTP Request with a Content-Type of application/x-java-serialized-object. The body of that request would be processed by the SerializationProvider and could contain a malicious payload, which may lead to arbitrary code execution when calling the $Y.getObject method.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/insecure-resteasy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-resteasy-deserialization\nPattern:\n@Consumes({MediaType.WILDCARD_TYPE})\n", "output": "Vulnerability rule: insecure-resteasy-deserialization\nMessage: When a Restful webservice endpoint is configured to use wildcard mediaType {*/*} as a value for the @Consumes annotation, an attacker could abuse the SerializableProvider by sending a HTTP Request with a Content-Type of application/x-java-serialized-object. The body of that request would be processed by the SerializationProvider and could contain a malicious payload, which may lead to arbitrary code execution when calling the $Y.getObject method.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/insecure-resteasy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: default-resteasy-provider-abuse\nPattern:\n@Path(\"...\")\npublic $RETURNTYPE $METHOD(...) { ...}\n", "output": "Vulnerability rule: default-resteasy-provider-abuse\nMessage: When a Restful webservice endpoint isn't configured with a @Consumes annotation, an attacker could abuse the SerializableProvider by sending a HTTP Request with a Content-Type of application/x-java-serialized-object. The body of that request would be processed by the SerializationProvider and could contain a malicious payload, which may lead to arbitrary code execution. Instead, add a @Consumes annotation to the function or class.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/insecure-resteasy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: jax-rs-path-traversal\nPattern:\n$RETURNTYPE $FUNC (..., @PathParam(...) $TYPE $VAR, ...) {\n  ...\n  new File(..., $VAR, ...);\n  ...\n}\n", "output": "Vulnerability rule: jax-rs-path-traversal\nMessage: Detected a potential path traversal. A malicious actor could control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are sanitized. You may also consider using a utility method such as org.apache.commons.io.FilenameUtils.getName(...) to only retrieve the file name from the path.\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/jax-rs-path-traversal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: jax-rs-path-traversal\nPattern:\n$RETURNTYPE $FUNC (..., @javax.ws.rs.PathParam(...) $TYPE $VAR, ...) {\n  ...\n  new File(..., $VAR, ...);\n  ...\n}", "output": "Vulnerability rule: jax-rs-path-traversal\nMessage: Detected a potential path traversal. A malicious actor could control the location of this file, to include going backwards in the directory with '../'. To address this, ensure that user-controlled variables in file paths are sanitized. You may also consider using a utility method such as org.apache.commons.io.FilenameUtils.getName(...) to only retrieve the file name from the path.\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/jax-rs/security/jax-rs-path-traversal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: cookie-issecure-false\nPattern:\n$COOKIE = new Cookie($...ARGS);", "output": "Vulnerability rule: cookie-issecure-false\nMessage: Default session middleware settings: `setSecure` not set to true. This ensures that the cookie is sent only over HTTPS to prevent cross-site scripting attacks.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/servlets/security/cookie-issecure-false.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): xml\nSemgrep rule id: security-constraint-http-method\nPattern:\n<http-method>$X</http-method>", "output": "Vulnerability rule: security-constraint-http-method\nMessage: The tag \"http-method\" is used to specify on which HTTP methods the java web security constraint apply. The target security constraints could be bypassed if a non listed HTTP method is used. Inverse the logic by using the tag \"http-method-omission\" to define for which HTTP methods the security constraint do not apply. Using this way, only expected allowed HTTP methods will be skipped by the security constraint.\nSeverity: WARNING\nCWE: ['CWE-863: Incorrect Authorization']\nOWASP: ['A05:2021 Security Misconfiguration', 'A01:2021 Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/servlets/security/security-constraint-http-method.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-snakeyaml-constructor\nPattern:\n$Y = new org.yaml.snakeyaml.Yaml();\n...\n$Y.load(...);\n", "output": "Vulnerability rule: use-snakeyaml-constructor\nMessage: Used SnakeYAML org.yaml.snakeyaml.Yaml() constructor with no arguments, which is vulnerable to deserialization attacks. Use the one-argument Yaml(...) constructor instead, with SafeConstructor or a custom Constructor as the argument.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/use-snakeyaml-constructor.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,String $URL,...) {\n  ...\n  $RES.sendRedirect($URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...,HttpServletResponse $RES,...) {\n  ...\n  $RES.sendRedirect($URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {\n  ...\n  String $URL = $REQ.getParameter(...);\n  ...\n  $RES.sendRedirect($URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {\n  ...\n  String $URL = $REQ.getParameter(...);\n  ...\n  $RES.sendRedirect($URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.sendRedirect($URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {\n  ...\n  $RES.sendRedirect($REQ.getParameter(...));\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {\n  ...\n  $RES.sendRedirect($REQ.getParameter(...));\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,String $URL,...) {\n  ...\n  $RES.addHeader(\"Location\",$URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...,HttpServletResponse $RES,...) {\n  ...\n  $RES.addHeader(\"Location\",$URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {\n  ...\n  String $URL = $REQ.getParameter(...);\n  ...\n  $RES.addHeader(\"Location\",$URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {\n  ...\n  String $URL = $REQ.getParameter(...);\n  ...\n  $RES.addHeader(\"Location\",$URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.addHeader(\"Location\",$URL);\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletRequest $REQ,...,HttpServletResponse $RES,...) {\n  ...\n  $RES.addHeader(\"Location\",$REQ.getParameter(...));\n  ...\n}\n", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unvalidated-redirect\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...,HttpServletRequest $REQ,...) {\n  ...\n  $RES.addHeader(\"Location\",$REQ.getParameter(...));\n  ...\n}", "output": "Vulnerability rule: unvalidated-redirect\nMessage: Application redirects to a destination URL specified by a user-supplied parameter that is not validated. This could direct users to malicious locations. Consider using an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ldap-entry-poisoning\nPattern:\nnew SearchControls($S, $CL, $TL, $AT, true, $DEREF)\n", "output": "Vulnerability rule: ldap-entry-poisoning\nMessage: An object-returning LDAP search will allow attackers to control the LDAP response. This could lead to Remote Code Execution.\nSeverity: WARNING\nCWE: [\"CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/ldap-entry-poisoning.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ldap-entry-poisoning\nPattern:\nSearchControls $VAR = new SearchControls();\n...\n$VAR.setReturningObjFlag(true);\n", "output": "Vulnerability rule: ldap-entry-poisoning\nMessage: An object-returning LDAP search will allow attackers to control the LDAP response. This could lead to Remote Code Execution.\nSeverity: WARNING\nCWE: [\"CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/ldap-entry-poisoning.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-smtp-connection\nPattern:\n$EMAIL.send(...);", "output": "Vulnerability rule: insecure-smtp-connection\nMessage: Insecure SMTP connection detected. This connection will trust any SSL certificate. Enable certificate verification by setting 'email.setSSLCheckServerIdentity(true)'.\nSeverity: WARNING\nCWE: ['CWE-297: Improper Validation of Certificate with Host Mismatch']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/insecure-smtp-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unsafe-reflection\nPattern:\nClass.forName($CLASS,...)\n", "output": "Vulnerability rule: unsafe-reflection\nMessage: If an attacker can supply values that the application then uses to determine which class to instantiate or which method to invoke, the potential exists for the attacker to create control flow paths through the application that were not intended by the application developers. This attack vector may allow the attacker to bypass authentication or access control checks or otherwise cause the application to behave in an unexpected manner.\nSeverity: WARNING\nCWE: [\"CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/unsafe-reflection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: overly-permissive-file-permission\nPattern:\njava.nio.file.Files.setPosixFilePermissions($FILE, java.nio.file.attribute.PosixFilePermissions.fromString(\"=~/(^......r..$)|(^.......w.$)|(^........x$)/\"));", "output": "Vulnerability rule: overly-permissive-file-permission\nMessage: Detected file permissions that are overly permissive (read, write, and execute). It is generally a bad practices to set overly permissive file permission such as read+write+exec for all users. If the file affected is a configuration, a binary, a script or sensitive data, it can lead to privilege escalation or information leakage. Instead, follow the principle of least privilege and give users only the  permissions they need.\nSeverity: WARNING\nCWE: ['CWE-276: Incorrect Default Permissions']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/overly-permissive-file-permission.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: overly-permissive-file-permission\nPattern:\n$TYPE $P = java.nio.file.attribute.PosixFilePermissions.fromString(\"=~/(^......r..$)|(^.......w.$)|(^........x$)/\");\n...\njava.nio.file.Files.setPosixFilePermissions($FILE, $P);\n", "output": "Vulnerability rule: overly-permissive-file-permission\nMessage: Detected file permissions that are overly permissive (read, write, and execute). It is generally a bad practices to set overly permissive file permission such as read+write+exec for all users. If the file affected is a configuration, a binary, a script or sensitive data, it can lead to privilege escalation or information leakage. Instead, follow the principle of least privilege and give users only the  permissions they need.\nSeverity: WARNING\nCWE: ['CWE-276: Incorrect Default Permissions']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/overly-permissive-file-permission.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: overly-permissive-file-permission\nPattern:\n$P.add(java.nio.file.attribute.PosixFilePermission.OTHERS_READ);\n...\njava.nio.file.Files.setPosixFilePermissions($FILE, $P);\n", "output": "Vulnerability rule: overly-permissive-file-permission\nMessage: Detected file permissions that are overly permissive (read, write, and execute). It is generally a bad practices to set overly permissive file permission such as read+write+exec for all users. If the file affected is a configuration, a binary, a script or sensitive data, it can lead to privilege escalation or information leakage. Instead, follow the principle of least privilege and give users only the  permissions they need.\nSeverity: WARNING\nCWE: ['CWE-276: Incorrect Default Permissions']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/overly-permissive-file-permission.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: overly-permissive-file-permission\nPattern:\n$P.add(java.nio.file.attribute.PosixFilePermission.OTHERS_WRITE);\n...\njava.nio.file.Files.setPosixFilePermissions($FILE, $P);\n", "output": "Vulnerability rule: overly-permissive-file-permission\nMessage: Detected file permissions that are overly permissive (read, write, and execute). It is generally a bad practices to set overly permissive file permission such as read+write+exec for all users. If the file affected is a configuration, a binary, a script or sensitive data, it can lead to privilege escalation or information leakage. Instead, follow the principle of least privilege and give users only the  permissions they need.\nSeverity: WARNING\nCWE: ['CWE-276: Incorrect Default Permissions']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/overly-permissive-file-permission.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: overly-permissive-file-permission\nPattern:\n$P.add(java.nio.file.attribute.PosixFilePermission.OTHERS_EXECUTE);\n...\njava.nio.file.Files.setPosixFilePermissions($FILE, $P);", "output": "Vulnerability rule: overly-permissive-file-permission\nMessage: Detected file permissions that are overly permissive (read, write, and execute). It is generally a bad practices to set overly permissive file permission such as read+write+exec for all users. If the file affected is a configuration, a binary, a script or sensitive data, it can lead to privilege escalation or information leakage. Instead, follow the principle of least privilege and give users only the  permissions they need.\nSeverity: WARNING\nCWE: ['CWE-276: Incorrect Default Permissions']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/overly-permissive-file-permission.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nHttpServletResponse $RES = ...;\n...\n$RES.addHeader(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nHttpServletResponse $RES = ...;\n...\n$RES.setHeader(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nServerHttpResponse $RES = ...;\n...\n$RES.getHeaders().add(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nHttpHeaders $HEADERS = ...;\n...\n$HEADERS.set(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nServerWebExchange $SWE = ...;\n...\n$SWE.getResponse().getHeaders().add(\"Access-Control-Allow-Origin\", \"*\");\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.addHeader(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n  ...\n}\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.setHeader(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n  ...\n}\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\n$X $METHOD(...,ServerHttpResponse $RES,...) {\n  ...\n  $RES.getHeaders().add(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n  ...\n}\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\n$X $METHOD(...,ServerWebExchange $SWE,...) {\n  ...\n  $SWE.getResponse().getHeaders().add(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\");\n  ...\n}\n", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nResponseEntity.$RES().header(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\")", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: permissive-cors\nPattern:\nServerResponse.$RES().header(\"=~/access-control-allow-origin/i\", \"=~/^\\*|null$/i\")", "output": "Vulnerability rule: permissive-cors\nMessage: https://find-sec-bugs.github.io/bugs.htm#PERMISSIVE_CORS Permissive CORS policy will allow a malicious application to communicate with the victim application in an inappropriate way, leading to spoofing, data theft, relay and other attacks.\nSeverity: WARNING\nCWE: ['CWE-183: Permissive List of Allowed Inputs']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: cbc-padding-oracle\nPattern:\n\"=~/.*\\/CBC\\/PKCS5Padding/\"\n", "output": "Vulnerability rule: cbc-padding-oracle\nMessage: Using CBC with PKCS5Padding is susceptible to padding oracle attacks. A malicious actor could discern the difference between plaintext with valid or invalid padding. Further, CBC mode does not include any integrity checks. Use 'AES/GCM/NoPadding' instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/cbc-padding-oracle.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: script-engine-injection\nPattern:\n$X $METHOD(...) {\n  ...\n  $SE.eval(...);\n  ...\n}\n", "output": "Vulnerability rule: script-engine-injection\nMessage: Detected potential code injection using ScriptEngine. Ensure user-controlled data cannot enter '.eval()', otherwise, this is a code injection vulnerability.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/script-engine-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: bad-hexa-conversion\nPattern:\n$X $METHOD(...) {\n  ...\n  MessageDigest $MD = ...;\n  ...\n  $MD.digest(...);\n  ...\n  Integer.toHexString(...);\n}", "output": "Vulnerability rule: bad-hexa-conversion\nMessage: 'Integer.toHexString()' strips leading zeroes from each byte if read byte-by-byte. This mistake weakens the hash value computed since it introduces more collisions. Use 'String.format(\"%02X\", ...)' instead.\nSeverity: WARNING\nCWE: ['CWE-704: Incorrect Type Conversion or Cast']\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/bad-hexa-conversion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: object-deserialization\nPattern:\nnew ObjectInputStream(...);", "output": "Vulnerability rule: object-deserialization\nMessage: Found object deserialization using ObjectInputStream. Deserializing entire Java objects is dangerous because malicious actors can create Java object streams with unintended consequences. Ensure that the objects being deserialized are not user-controlled. If this must be done, consider using HMACs to sign the data stream to make sure it is not tampered with, or consider only transmitting object fields and populating a new object.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/object-deserialization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.encodeURL(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.encodeUrl(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.encodeRedirectURL(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...,HttpServletResponse $RES,...) {\n  ...\n  $RES.encodeRedirectUrl(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.encodeURL(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.encodeUrl(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.encodeRedirectURL(...);\n  ...\n}\n", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: url-rewriting\nPattern:\n$X $METHOD(...) {\n  ...\n  HttpServletResponse $RES = ...;\n  ...\n  $RES.encodeRedirectUrl(...);\n  ...\n}", "output": "Vulnerability rule: url-rewriting\nMessage: URL rewriting has significant security risks. Since session ID appears in the URL, it may be easily seen by third parties.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/url-rewriting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: anonymous-ldap-bind\nPattern:\n$ENV.put($CTX.SECURITY_AUTHENTICATION, \"none\");\n...\n$DCTX = new InitialDirContext($ENV, ...);\n", "output": "Vulnerability rule: anonymous-ldap-bind\nMessage: Detected anonymous LDAP bind. This permits anonymous users to execute LDAP statements. Consider enforcing authentication for LDAP. See https://docs.oracle.com/javase/tutorial/jndi/ldap/auth_mechs.html for more information.\nSeverity: WARNING\nCWE: ['CWE-287: Improper Authentication']\nOWASP: ['A02:2017 - Broken Authentication', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/anonymous-ldap-bind.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: http-response-splitting\nPattern:\n$VAR = $REQ.getParameter(...);\n...\n$COOKIE = new Cookie(..., $VAR, ...);\n...\n$RESP.addCookie($COOKIE, ...);\n", "output": "Vulnerability rule: http-response-splitting\nMessage: Older Java application servers are vulnerable to HTTP response splitting, which may occur if an HTTP request can be injected with CRLF characters. This finding is reported for completeness; it is recommended to ensure your environment is not affected by testing this yourself.\nSeverity: INFO\nCWE: [\"CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/http-response-splitting.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: blowfish-insufficient-key-size\nPattern:\n$KEYGEN = KeyGenerator.getInstance(\"Blowfish\");\n...\n$KEYGEN.init($SIZE);\n", "output": "Vulnerability rule: blowfish-insufficient-key-size\nMessage: Using less than 128 bits for Blowfish is considered insecure. Use 128 bits or more, or switch to use AES instead.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/blowfish-insufficient-key-size.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: xml-decoder\nPattern:\n$X $METHOD(...) {\n  ...\n  new XMLDecoder(...);\n  ...\n}\n", "output": "Vulnerability rule: xml-decoder\nMessage: XMLDecoder should not be used to parse untrusted data. Deserializing user input can lead to arbitrary code execution. Use an alternative and explicitly disable external entities. See https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html for alternatives and vulnerability prevention.\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xml-decoder.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: xssrequestwrapper-is-insecure\nPattern:\nclass XSSRequestWrapper extends HttpServletRequestWrapper {\n  ...\n}\n", "output": "Vulnerability rule: xssrequestwrapper-is-insecure\nMessage: It looks like you're using an implementation of XSSRequestWrapper from dzone. (https://www.javacodegeeks.com/2012/07/anti-cross-site-scripting-xss-filter.html) The XSS filtering in this code is not secure and can be bypassed by malicious actors. It is recommended to use a stack that automatically escapes in your view or templates instead of filtering yourself.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xssrequestwrapper-is-insecure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: xssrequestwrapper-is-insecure\nPattern:\n$P = $X.compile(\"</script>\", $X.CASE_INSENSITIVE);\n$V = $P.matcher(...).replaceAll(\"\");", "output": "Vulnerability rule: xssrequestwrapper-is-insecure\nMessage: It looks like you're using an implementation of XSSRequestWrapper from dzone. (https://www.javacodegeeks.com/2012/07/anti-cross-site-scripting-xss-filter.html) The XSS filtering in this code is not secure and can be bypassed by malicious actors. It is recommended to use a stack that automatically escapes in your view or templates instead of filtering yourself.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xssrequestwrapper-is-insecure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ldap-injection\nPattern:\n$X $METHOD(...) {\n  ...\n  $CTX.search($Y,$INPUT,...);\n  ...\n}\n", "output": "Vulnerability rule: ldap-injection\nMessage: Detected non-constant data passed into an LDAP query. If this data can be controlled by an external user, this is an LDAP injection. Ensure data passed to an LDAP query is not controllable; or properly sanitize the data.\nSeverity: WARNING\nCWE: [\"CWE-90: Improper Neutralization of Special Elements used in an LDAP Query ('LDAP Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/ldap-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: weak-ssl-context\nPattern:\nSSLContext.getInstance(\"...\")", "output": "Vulnerability rule: weak-ssl-context\nMessage: An insecure SSL context was detected. TLS versions 1.0, 1.1, and all SSL versions are considered weak encryption and are deprecated. Use SSLContext.getInstance(\"TLSv1.2\") for the best security.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/weak-ssl-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unencrypted-socket\nPattern:\nnew ServerSocket(...)", "output": "Vulnerability rule: unencrypted-socket\nMessage: Detected use of a Java socket that is not encrypted. As a result, the traffic could be read by an attacker intercepting the network traffic. Use an SSLSocket created by 'SSLSocketFactory' or 'SSLServerSocketFactory' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/unencrypted-socket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unencrypted-socket\nPattern:\nnew Socket(...)", "output": "Vulnerability rule: unencrypted-socket\nMessage: Detected use of a Java socket that is not encrypted. As a result, the traffic could be read by an attacker intercepting the network traffic. Use an SSLSocket created by 'SSLSocketFactory' or 'SSLServerSocketFactory' instead.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/unencrypted-socket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha1\nPattern:\n$DU.getSha1Digest().digest(...)\n", "output": "Vulnerability rule: use-of-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Instead, use PBKDF2 for password hashing or SHA256 or SHA512 for other hash function applications.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-blowfish\nPattern:\n$CIPHER.getInstance(\"Blowfish\")", "output": "Vulnerability rule: use-of-blowfish\nMessage: Use of Blowfish was detected. Blowfish uses a 64-bit block size that  makes it vulnerable to birthday attacks, and is therefore considered non-compliant.  Instead, use a strong, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-blowfish.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: no-static-initialization-vector\nPattern:\nbyte[] $IV = {\n    ...\n};\n...\nnew IvParameterSpec($IV, ...);\n", "output": "Vulnerability rule: no-static-initialization-vector\nMessage: Initialization Vectors (IVs) for block ciphers should be randomly generated each time they are used. Using a static IV means the same plaintext encrypts to the same ciphertext every time, weakening the strength of the encryption.\nSeverity: WARNING\nCWE: ['CWE-329: Generation of Predictable IV with CBC Mode']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/no-static-initialization-vector.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: no-static-initialization-vector\nPattern:\nclass $CLASS {\n    byte[] $IV = {\n        ...\n    };\n    ...\n    $METHOD(...) {\n        ...\n        new IvParameterSpec($IV, ...);\n        ...\n    }\n}\n", "output": "Vulnerability rule: no-static-initialization-vector\nMessage: Initialization Vectors (IVs) for block ciphers should be randomly generated each time they are used. Using a static IV means the same plaintext encrypts to the same ciphertext every time, weakening the strength of the encryption.\nSeverity: WARNING\nCWE: ['CWE-329: Generation of Predictable IV with CBC Mode']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/no-static-initialization-vector.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-rc2\nPattern:\n$CIPHER.getInstance(\"RC2\")", "output": "Vulnerability rule: use-of-rc2\nMessage: Use of RC2 was detected. RC2 is vulnerable to related-key attacks, and is therefore considered non-compliant. Instead, use a strong, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-rc2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ecb-cipher\nPattern:\nCipher $VAR = $CIPHER.getInstance($MODE);\n", "output": "Vulnerability rule: ecb-cipher\nMessage: Cipher in ECB mode is detected. ECB mode produces the same output for the same input each time which allows an attacker to intercept and replay the data. Further, ECB mode does not provide any integrity checking. See https://find-sec-bugs.github.io/bugs.htm#CIPHER_INTEGRITY.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ecb-cipher.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-weak-rsa-key\nPattern:\nKeyPairGenerator $KEY = $G.getInstance(\"RSA\");\n...\n$KEY.initialize($BITS);\n", "output": "Vulnerability rule: use-of-weak-rsa-key\nMessage: RSA keys should be at least 2048 bits based on NIST recommendation.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/weak-rsa.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-md5-digest-utils\nPattern:\n$DU.$GET_ALGO().digest(...)\n", "output": "Vulnerability rule: use-of-md5-digest-utils\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use HMAC instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-md5-digest-utils.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java, kt\nSemgrep rule id: rsa-no-padding\nPattern:\n$CIPHER.getInstance(\"=~/RSA/[Nn][Oo][Nn][Ee]/NoPadding/\")", "output": "Vulnerability rule: rsa-no-padding\nMessage: Using RSA without OAEP mode weakens the encryption.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/rsa-no-padding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-rc4\nPattern:\n$CIPHER.getInstance(\"RC4\")", "output": "Vulnerability rule: use-of-rc4\nMessage: Use of RC4 was detected. RC4 is vulnerable to several attacks, including stream cipher attacks and bit flipping attacks. Instead, use a strong, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-rc4.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-aes-ecb\nPattern:\n$CIPHER.getInstance(\"=~/AES/ECB.*/\")", "output": "Vulnerability rule: use-of-aes-ecb\nMessage: Use of AES with ECB mode detected. ECB doesn't provide message confidentiality and  is not semantically secure so should not be used. Instead, use a strong, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-aes-ecb.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.getSha3_224Digest()", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.getSha512_224Digest()", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.sha3_224(...)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.sha3_224Hex(...)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.sha512_224(...)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\norg.apache.commons.codec.digest.DigestUtils.sha512_224Hex(...)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\nnew org.apache.commons.codec.digest.DigestUtils(org.apache.commons.codec.digest.MessageDigestAlgorithms.SHA_224)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\nnew org.apache.commons.codec.digest.DigestUtils(org.apache.commons.codec.digest.MessageDigestAlgorithms.SHA_512_224)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-sha224\nPattern:\nnew org.apache.commons.codec.digest.DigestUtils(org.apache.commons.codec.digest.MessageDigestAlgorithms.SHA3_224)", "output": "Vulnerability rule: use-of-sha224\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-sha224.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: weak-random\nPattern:\nnew java.util.Random(...).$FUNC(...)\n", "output": "Vulnerability rule: weak-random\nMessage: Detected use of the functions `Math.random()` or `java.util.Random()`. These are both not cryptographically strong random number generators (RNGs). If you are using these RNGs to create passwords or secret tokens, use `java.security.SecureRandom` instead.\nSeverity: WARNING\nCWE: ['CWE-330: Use of Insufficiently Random Values']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/weak-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: weak-random\nPattern:\njava.lang.Math.random(...)\n", "output": "Vulnerability rule: weak-random\nMessage: Detected use of the functions `Math.random()` or `java.util.Random()`. These are both not cryptographically strong random number generators (RNGs). If you are using these RNGs to create passwords or secret tokens, use `java.security.SecureRandom` instead.\nSeverity: WARNING\nCWE: ['CWE-330: Use of Insufficiently Random Values']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/weak-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: use-of-md5\nPattern:\njava.security.MessageDigest.getInstance($ALGO, ...);\n", "output": "Vulnerability rule: use-of-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use HMAC instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-hostname-verifier\nPattern:\nclass $CLASS implements HostnameVerifier {\n  ...\n  public boolean verify(...) { return true; }\n}\n", "output": "Vulnerability rule: insecure-hostname-verifier\nMessage: Insecure HostnameVerifier implementation detected. This will accept any SSL certificate with any hostname, which creates the possibility for man-in-the-middle attacks.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ssl/insecure-hostname-verifier.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-hostname-verifier\nPattern:\nnew HostnameVerifier(...){\n  public boolean verify(...) {\n    return true;\n  }\n}", "output": "Vulnerability rule: insecure-hostname-verifier\nMessage: Insecure HostnameVerifier implementation detected. This will accept any SSL certificate with any hostname, which creates the possibility for man-in-the-middle attacks.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ssl/insecure-hostname-verifier.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: insecure-hostname-verifier\nPattern:\nimport org.apache.http.conn.ssl.NoopHostnameVerifier;", "output": "Vulnerability rule: insecure-hostname-verifier\nMessage: Insecure HostnameVerifier implementation detected. This will accept any SSL certificate with any hostname, which creates the possibility for man-in-the-middle attacks.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ssl/insecure-hostname-verifier.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: avoid-implementing-custom-digests\nPattern:\nclass $CLASS extends MessageDigest {\n  ...\n}", "output": "Vulnerability rule: avoid-implementing-custom-digests\nMessage: Cryptographic algorithms are notoriously difficult to get right. By implementing a custom message digest, you risk introducing security issues into your program. Use one of the many sound message digests already available to you: MessageDigest sha256Digest = MessageDigest.getInstance(\"SHA256\");\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ssl/avoid-implementing-custom-digests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: defaulthttpclient-is-deprecated\nPattern:\nnew DefaultHttpClient(...);", "output": "Vulnerability rule: defaulthttpclient-is-deprecated\nMessage: DefaultHttpClient is deprecated. Further, it does not support connections using TLS1.2, which makes using DefaultHttpClient a security hazard. Use HttpClientBuilder instead.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/crypto/ssl/defaulthttpclient-is-deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: documentbuilderfactory-external-general-entities-true\nPattern:\n$DBFACTORY.setFeature(\"http://xml.org/sax/features/external-general-entities\", true);", "output": "Vulnerability rule: documentbuilderfactory-external-general-entities-true\nMessage: External entities are allowed for $DBFACTORY. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://xml.org/sax/features/external-general-entities\" to false.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xxe/documentbuilderfactory-external-general-entities-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: documentbuilderfactory-disallow-doctype-decl-false\nPattern:\n$DBFACTORY.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", false);", "output": "Vulnerability rule: documentbuilderfactory-disallow-doctype-decl-false\nMessage: DOCTYPE declarations are enabled for $DBFACTORY. Without prohibiting external entity declarations, this is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xxe/documentbuilderfactory-disallow-doctype-decl-false.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: documentbuilderfactory-external-parameter-entities-true\nPattern:\n$DBFACTORY.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", true);", "output": "Vulnerability rule: documentbuilderfactory-external-parameter-entities-true\nMessage: External entities are allowed for $DBFACTORY. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://xml.org/sax/features/external-parameter-entities\" to false.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xxe/documentbuilderfactory-external-parameter-entities-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: hibernate-sqli\nPattern:\norg.hibernate.criterion.Restrictions.sqlRestriction(String.format(...),...)", "output": "Vulnerability rule: hibernate-sqli\nMessage: Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Use a prepared statements (java.sql.PreparedStatement) instead. You can obtain a PreparedStatement using 'connection.prepareStatement'.\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/sqli/hibernate-sqli.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: autoescape-disabled\nPattern:\n.*escape.*?=.*?false.*", "output": "Vulnerability rule: autoescape-disabled\nMessage: Detected an element with disabled HTML escaping. If external data can reach this, this is a cross-site scripting (XSS) vulnerability. Ensure no external data can reach here, or remove 'escape=false' from this element.\nSeverity: WARNING\nCWE: ['CWE-150: Improper Neutralization of Escape, Meta, or Control Sequences']\nOWASP: A07:2017 - Cross-Site Scripting (XSS)\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xss/jsf/autoescape-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: use-jstl-escaping\nPattern:\n<(?![A-Za-z0-9]+:out).*?\\$\\{.*?\\}.*>", "output": "Vulnerability rule: use-jstl-escaping\nMessage: Detected an Expression Language segment in a tag that does not escape output. This is dangerous because if any data in this expression can be controlled externally, it is a cross-site scripting vulnerability. Instead, use the 'out' tag from the JSTL taglib to escape this expression. See https://www.tutorialspoint.com/jsp/jstl_core_out_tag.htm for more information.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xss/jsp/use-jstl-escaping.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: use-escapexml\nPattern:\n\\$\\{(?!.*escapeXml).*\\}", "output": "Vulnerability rule: use-escapexml\nMessage: Detected an Expression Language segment that does not escape output. This is dangerous because if any data in this expression can be controlled externally, it is a cross-site scripting vulnerability. Instead, use the 'escapeXml' function from the JSTL taglib. See https://www.tutorialspoint.com/jsp/jstl_function_escapexml.htm for more information.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xss/jsp/use-escapexml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: no-scriptlets\nPattern:\n\\<\\%[^\\@].*", "output": "Vulnerability rule: no-scriptlets\nMessage: JSP scriptlet detected. Scriptlets are difficult to use securely and are considered bad practice. See https://stackoverflow.com/a/3180202. Instead, consider migrating to JSF or using the Expression Language '${...}' with the escapeXml function in your JSP files.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/security/audit/xss/jsp/no-scriptlets.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: no-string-eqeq\nPattern:\n$X == (String $Y)", "output": "Vulnerability rule: no-string-eqeq\nMessage: Strings should not be compared with '=='. This is a reference comparison operator. Use '.equals()' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/correctness/no-string-eqeq.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: assignment-comparison\nPattern:\nif ($X=true) { ... }", "output": "Vulnerability rule: assignment-comparison\nMessage: The value of `$X` is being ignored and will be used in the conditional test\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/correctness/assignment-comparison.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: assignment-comparison\nPattern:\nif ($X=false) { ... }", "output": "Vulnerability rule: assignment-comparison\nMessage: The value of `$X` is being ignored and will be used in the conditional test\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/lang/correctness/assignment-comparison.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: manifest-usesCleartextTraffic-true\nPattern:\nandroid:usesCleartextTraffic=\"true\"\n", "output": "Vulnerability rule: manifest-usesCleartextTraffic-true\nMessage: The Android manifest is configured to allow non-encrypted connections. Evaluate if this is necessary for your app, and disable it if appropriate. This flag is ignored on Android 7 (API 24) and above if a Network Security Config is present.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/android/best-practice/manifest-security-features.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: java-jwt-none-alg\nPattern:\n$JWT.sign(com.auth0.jwt.algorithms.Algorithm.none());\n", "output": "Vulnerability rule: java-jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/java-jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: java-jwt-none-alg\nPattern:\n$NONE = com.auth0.jwt.algorithms.Algorithm.none();\n...\n$JWT.sign($NONE);\n", "output": "Vulnerability rule: java-jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/java-jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: java-jwt-none-alg\nPattern:\nclass $CLASS {\n  ...\n  $TYPE $NONE = com.auth0.jwt.algorithms.Algorithm.none();\n  ...\n  $RETURNTYPE $FUNC (...) {\n    ...\n    $JWT.sign($NONE);\n    ...\n  }\n  ...\n}", "output": "Vulnerability rule: java-jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/java-jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: java-jwt-decode-without-verify\nPattern:\ncom.auth0.jwt.JWT.decode(...);\n", "output": "Vulnerability rule: java-jwt-decode-without-verify\nMessage: Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims. Call '.verify()' before using the token.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/java-jwt/security/audit/jwt-decode-without-verify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: server-dangerous-class-deserialization\nPattern:\ninterface $INTERFACE extends Remote {\n  $RETURNTYPE $METHOD($CLASS $PARAM) throws RemoteException;\n}\n", "output": "Vulnerability rule: server-dangerous-class-deserialization\nMessage: Using a non-primitive class with Java RMI may be an insecure deserialization vulnerability. Depending on the underlying implementation. This object could be manipulated by a malicious actor allowing them to execute code on your system. Instead, use an integer ID to look up your object, or consider alternative serialization schemes such as JSON.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/rmi/security/server-dangerous-class-deserialization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: server-dangerous-object-deserialization\nPattern:\ninterface $INTERFACE extends Remote {\n  $RETURNTYPE $METHOD($PARAMTYPE $PARAM) throws RemoteException;\n}\n", "output": "Vulnerability rule: server-dangerous-object-deserialization\nMessage: Using an arbitrary object ('$PARAMTYPE $PARAM') with Java RMI is an insecure deserialization vulnerability. This object can be manipulated by a malicious actor allowing them to execute code on your system. Instead, use an integer ID to look up your object, or consider alternative serialization schemes such as JSON.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/rmi/security/server-dangerous-object-deserialization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unrestricted-request-mapping\nPattern:\nRequestMapping\n", "output": "Vulnerability rule: unrestricted-request-mapping\nMessage: Detected a method annotated with 'RequestMapping' that does not specify the HTTP method. CSRF protections are not enabled for GET, HEAD, TRACE, or OPTIONS, and by default all HTTP methods are allowed when the HTTP method is not explicitly specified. This means that a method that performs state changes could be vulnerable to CSRF attacks. To mitigate, add the 'method' field and specify the HTTP method (such as 'RequestMethod.POST').\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/unrestricted-request-mapping.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: spring-actuator-fully-enabled-yaml\nPattern:\ninclude: \"*\"\n", "output": "Vulnerability rule: spring-actuator-fully-enabled-yaml\nMessage: Spring Boot Actuator is fully enabled. This exposes sensitive endpoints such as /actuator/env, /actuator/logfile, /actuator/heapdump and others. Unless you have Spring Security enabled or another means to protect these endpoints, this functionality is available without authentication, causing a severe security risk.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-actuator-fully-enabled-yaml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: spring-actuator-dangerous-endpoints-enabled-yaml\nPattern:\ninclude: [..., $ACTUATOR, ...]\n", "output": "Vulnerability rule: spring-actuator-dangerous-endpoints-enabled-yaml\nMessage: Spring Boot Actuator \"$ACTUATOR\" is enabled. Depending on the actuator, this can pose a significant security risk. Please double-check if the actuator is needed and properly secured.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-actuator-non-health-enabled-yaml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: spring-jsp-eval\nPattern:\n<spring:eval ... expression=...>\n", "output": "Vulnerability rule: spring-jsp-eval\nMessage: A Spring expression is built with a dynamic value. The source of the value(s) should be verified to avoid that unfiltered values fall into this risky code evaluation.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-jsp-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spel-injection\nPattern:\n$X $METHOD(...) {\n  ...\n  $PARSER.parseExpression(...);\n  ...\n}\n", "output": "Vulnerability rule: spel-injection\nMessage: A Spring expression is built with a dynamic value. The source of the value(s) should be verified to avoid that unfiltered values fall into this risky code evaluation.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spel-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  return \"redirect:\" + $URL;\n}\n", "output": "Vulnerability rule: spring-unvalidated-redirect\nMessage: Application redirects a user to a destination URL specified by a user supplied parameter that is not validated.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  ...\n  String $REDIR = \"redirect:\" + $URL;\n  ...\n  return $REDIR;\n  ...\n}\n", "output": "Vulnerability rule: spring-unvalidated-redirect\nMessage: Application redirects a user to a destination URL specified by a user supplied parameter that is not validated.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  ...\n  new ModelAndView(\"redirect:\" + $URL);\n  ...\n}\n", "output": "Vulnerability rule: spring-unvalidated-redirect\nMessage: Application redirects a user to a destination URL specified by a user supplied parameter that is not validated.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-unvalidated-redirect\nPattern:\n$X $METHOD(...,String $URL,...) {\n  ...\n  String $REDIR = \"redirect:\" + $URL;\n  ...\n  new ModelAndView($REDIR);\n  ...\n}", "output": "Vulnerability rule: spring-unvalidated-redirect\nMessage: Application redirects a user to a destination URL specified by a user supplied parameter that is not validated.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-unvalidated-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-csrf-disabled\nPattern:\n$OBJ.csrf(...).disable(...)", "output": "Vulnerability rule: spring-csrf-disabled\nMessage: CSRF protection is disabled for this configuration. This is a security risk.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-csrf-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: spring-actuator-dangerous-endpoints-enabled\nPattern:\nmanagement.endpoints.web.exposure.include=$...ACTUATORS", "output": "Vulnerability rule: spring-actuator-dangerous-endpoints-enabled\nMessage: Spring Boot Actuators \"$...ACTUATORS\" are enabled. Depending on the actuators, this can pose a significant security risk. Please double-check if the actuators are needed and properly secured.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-actuator-non-health-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: spring-actuator-fully-enabled\nPattern:\nmanagement.endpoints.web.exposure.include=*", "output": "Vulnerability rule: spring-actuator-fully-enabled\nMessage: Spring Boot Actuator is fully enabled. This exposes sensitive endpoints such as /actuator/env, /actuator/logfile, /actuator/heapdump and others. Unless you have Spring Security enabled or another means to protect these endpoints, this functionality is available without authentication, causing a significant security risk.\nSeverity: ERROR\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: java/spring/security/audit/spring-actuator-fully-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): html\nSemgrep rule id: plaintext-http-link\nPattern:\n<a href=\"$URL\">...</a>", "output": "Vulnerability rule: plaintext-http-link\nMessage: This link points to a plaintext HTTP URL. Prefer an encrypted HTTPS URL if possible.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: html/security/plaintext-http-link.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): html\nSemgrep rule id: https-equiv\nPattern:\n<meta ... https-equiv=...>", "output": "Vulnerability rule: https-equiv\nMessage: The correct attribute name for this meta tag is `http-equiv`, not `https-equiv`.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: html/correctness/https-equiv.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: robots-denied\nPattern:\n<meta name=\"robots\" ...>", "output": "Vulnerability rule: robots-denied\nMessage: This page denies crawlers from indexing the page. Remove the robots 'meta' tag.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: html/best-practice/robots-denied.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: robots-denied\nPattern:\n<META NAME=\"ROBOTS\" ...>", "output": "Vulnerability rule: robots-denied\nMessage: This page denies crawlers from indexing the page. Remove the robots 'meta' tag.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: html/best-practice/robots-denied.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: unencrypted-socket\nPattern:\nServerSocket(...)", "output": "Vulnerability rule: unencrypted-socket\nMessage: This socket is not encrypted. The traffic could be read by an attacker intercepting the network traffic. Use an SSLSocket created by 'SSLSocketFactory' or 'SSLServerSocketFactory' instead\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/unencrypted-socket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: unencrypted-socket\nPattern:\nSocket(...)", "output": "Vulnerability rule: unencrypted-socket\nMessage: This socket is not encrypted. The traffic could be read by an attacker intercepting the network traffic. Use an SSLSocket created by 'SSLSocketFactory' or 'SSLServerSocketFactory' instead\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/unencrypted-socket.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: use-of-sha1\nPattern:\n$DU.getSha1Digest().digest(...)\n", "output": "Vulnerability rule: use-of-sha1\nMessage: Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/use-of-sha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: bad-hexa-conversion\nPattern:\nfun $METHOD(...) {\n  ...\n  val $MD: MessageDigest = ...\n  ...\n  $MD.digest(...)\n  ...\n  Integer.toHexString(...)\n}", "output": "Vulnerability rule: bad-hexa-conversion\nMessage: 'Integer.toHexString()' strips leading zeroes from each byte if read byte-by-byte. This mistake weakens the hash value computed since it introduces more collisions. Use 'String.format(\"%02X\", ...)' instead.\nSeverity: WARNING\nCWE: ['CWE-704: Incorrect Type Conversion or Cast']\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/bad-hexa-conversion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: anonymous-ldap-bind\nPattern:\n$ENV.put($CTX.SECURITY_AUTHENTICATION, \"none\")\n...\n$DCTX = InitialDirContext($ENV, ...)\n", "output": "Vulnerability rule: anonymous-ldap-bind\nMessage: Detected anonymous LDAP bind. This permits anonymous users to execute LDAP statements. Consider enforcing authentication for LDAP. See https://docs.oracle.com/javase/tutorial/jndi/ldap/auth_mechs.html for more information.\nSeverity: WARNING\nCWE: ['CWE-287: Improper Authentication']\nOWASP: ['A02:2017 - Broken Authentication', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/anonymous-ldap-bind.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: command-injection-formatted-runtime-call\nPattern:\n$RUNTIME.exec($X + $Y)", "output": "Vulnerability rule: command-injection-formatted-runtime-call\nMessage: A formatted or concatenated string was detected as input to a java.lang.Runtime call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/command-injection-formatted-runtime-call.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: command-injection-formatted-runtime-call\nPattern:\n$RUNTIME.exec(String.format(...))", "output": "Vulnerability rule: command-injection-formatted-runtime-call\nMessage: A formatted or concatenated string was detected as input to a java.lang.Runtime call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/command-injection-formatted-runtime-call.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: command-injection-formatted-runtime-call\nPattern:\n$RUNTIME.loadLibrary($X + $Y)", "output": "Vulnerability rule: command-injection-formatted-runtime-call\nMessage: A formatted or concatenated string was detected as input to a java.lang.Runtime call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/command-injection-formatted-runtime-call.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: command-injection-formatted-runtime-call\nPattern:\n$RUNTIME.loadLibrary(String.format(...))", "output": "Vulnerability rule: command-injection-formatted-runtime-call\nMessage: A formatted or concatenated string was detected as input to a java.lang.Runtime call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/command-injection-formatted-runtime-call.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: defaulthttpclient-is-deprecated\nPattern:\nDefaultHttpClient(...)", "output": "Vulnerability rule: defaulthttpclient-is-deprecated\nMessage: DefaultHttpClient is deprecated. Further, it does not support connections using TLS1.2, which makes using DefaultHttpClient a security hazard. Use SystemDefaultHttpClient instead, which supports TLS1.2.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/defaulthttpclient-is-deprecated.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: use-of-md5\nPattern:\njava.security.MessageDigest.getInstance(\"MD5\")\n", "output": "Vulnerability rule: use-of-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt\nSemgrep rule id: use-of-md5\nPattern:\norg.apache.commons.codec.digest.DigestUtils.getMd5Digest()\n", "output": "Vulnerability rule: use-of-md5\nMessage: Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/use-of-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kt, scala\nSemgrep rule id: no-null-cipher\nPattern:\nNullCipher(...)", "output": "Vulnerability rule: no-null-cipher\nMessage: NullCipher was detected. This will not encrypt anything; the cipher text will be the same as the plain text. Use a valid, secure cipher: Cipher.getInstance(\"AES/CBC/PKCS7PADDING\"). See https://owasp.org/www-community/Using_the_Java_Cryptographic_Extensions for more information.\nSeverity: WARNING\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: kotlin/lang/security/no-null-cipher.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: exec-use\nPattern:\n$FUNC(...);", "output": "Vulnerability rule: exec-use\nMessage: Executing non-constant commands. This can lead to command injection.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/exec-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: phpinfo-use\nPattern:\nphpinfo(...);", "output": "Vulnerability rule: phpinfo-use\nMessage: The 'phpinfo' function may reveal sensitive information about your environment.\nSeverity: ERROR\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/phpinfo-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: unlink-use\nPattern:\nunlink(...)", "output": "Vulnerability rule: unlink-use\nMessage: Using user input when deleting files with `unlink()` is potentially dangerous. A malicious actor could use this to modify or access files they have no right to.\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/unlink-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: ftp-use\nPattern:\n$FUNC(...);", "output": "Vulnerability rule: ftp-use\nMessage: FTP allows for unencrypted file transfers. Consider using an encrypted alternative.\nSeverity: ERROR\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/ftp-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: php-permissive-cors\nPattern:\nheader($VALUE,...)", "output": "Vulnerability rule: php-permissive-cors\nMessage: Access-Control-Allow-Origin response header is set to \"*\". This will disable CORS Same Origin Policy restrictions.\nSeverity: WARNING\nCWE: ['CWE-346: Origin Validation Error']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/php-permissive-cors.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: mcrypt-use\nPattern:\n$FUNC(...);", "output": "Vulnerability rule: mcrypt-use\nMessage: Mcrypt functionality has been deprecated and/or removed in recent PHP versions. Consider using Sodium or OpenSSL.\nSeverity: ERROR\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/mcrypt-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: unserialize-use\nPattern:\nunserialize(...)", "output": "Vulnerability rule: unserialize-use\nMessage: Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution. Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/unserialize-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: eval-use\nPattern:\neval(...);", "output": "Vulnerability rule: eval-use\nMessage: Evaluating non-constant commands. This can lead to command injection.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/eval-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: mb-ereg-replace-eval\nPattern:\nmb_ereg_replace($PATTERN, $REPL, $STR, $OPTIONS);", "output": "Vulnerability rule: mb-ereg-replace-eval\nMessage: Calling mb_ereg_replace with user input in the options can lead to arbitrary code execution. The eval modifier (`e`) evaluates the replacement argument as code.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/mb-ereg-replace-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: backticks-use\nPattern:\n`...`;", "output": "Vulnerability rule: backticks-use\nMessage: Backticks use may lead to command injection vulnerabilities.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/backticks-use.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: assert-use-audit\nPattern:\nassert($ASSERT, ...);", "output": "Vulnerability rule: assert-use-audit\nMessage: Calling assert with user input is equivalent to eval'ing.\nSeverity: ERROR\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/assert-use-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash('sha224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash('sha512/224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash('sha3-224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash_hmac('sha224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash_hmac('sha512/224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: sha224-hash\nPattern:\nhash_hmac('sha3-224', ...);", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: openssl-decrypt-validate\nPattern:\nopenssl_decrypt(...);", "output": "Vulnerability rule: openssl-decrypt-validate\nMessage: The function `openssl_decrypt` returns either a string of the decrypted data on success or `false` on failure. If the failure case is not handled, this could lead to undefined behavior in your application. Please handle the case where `openssl_decrypt` returns `false`.\nSeverity: WARNING\nCWE: ['CWE-252: Unchecked Return Value']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/security/audit/openssl-decrypt-validate.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: empty-with-boolean-expression\nPattern:\nempty($A && $B)\n", "output": "Vulnerability rule: empty-with-boolean-expression\nMessage: Calling `empty` on a boolean expression may be an indication that a parenthesis is misplaced.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/correctness/empty-with-boolean-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: empty-with-boolean-expression\nPattern:\nempty($A || $B)\n", "output": "Vulnerability rule: empty-with-boolean-expression\nMessage: Calling `empty` on a boolean expression may be an indication that a parenthesis is misplaced.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/lang/correctness/empty-with-boolean-expression.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: wp-ajax-no-auth-and-auth-hooks-audit\nPattern:\nadd_action($HOOK,...)", "output": "Vulnerability rule: wp-ajax-no-auth-and-auth-hooks-audit\nMessage: These hooks allow the developer to handle the custom AJAX endpoints.\"wp_ajax_$action\" hook get fires for any authenticated user and \"wp_ajax_nopriv_$action\" hook get fires for non-authenticated users.\nSeverity: WARNING\nCWE: ['CWE-285: Improper Authorization']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/wordpress-plugins/security/audit/wp-ajax-no-auth-and-auth-hooks-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: wp-open-redirect-audit\nPattern:\nwp_redirect(...)", "output": "Vulnerability rule: wp-open-redirect-audit\nMessage: This function can be used to redirect to user supplied URLs. If user input is not sanitised or validated, this could lead to Open Redirect vulnerabilities. Use \"wp_safe_redirect()\" to prevent this kind of attack.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/wordpress-plugins/security/audit/wp-open-redirect-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: wp-authorisation-checks-audit\nPattern:\n$FUNCTION(...)", "output": "Vulnerability rule: wp-authorisation-checks-audit\nMessage: These are some of the patterns used for authorisation. Look properly if the authorisation is proper or not.\nSeverity: WARNING\nCWE: ['CWE-285: Improper Authorization']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/wordpress-plugins/security/audit/wp-authorisation-checks-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: wp-csrf-audit\nPattern:\ncheck_ajax_referer(...,...,false)", "output": "Vulnerability rule: wp-csrf-audit\nMessage: Passing false or 0 as the third argument to this function will not cause the script to die, making the check useless.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/wordpress-plugins/security/audit/wp-csrf-audit.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: symfony-non-literal-redirect\nPattern:\n$this->redirect(...)", "output": "Vulnerability rule: symfony-non-literal-redirect\nMessage: The `redirect()` method does not check its destination in any way. If you redirect to a URL provided by end-users, your application may be open to the unvalidated redirects security vulnerability. Consider using literal values or an allowlist to validate URLs.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/symfony/security/audit/symfony-non-literal-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-cookie-long-timeout\nPattern:\n'lifetime'\n", "output": "Vulnerability rule: laravel-cookie-long-timeout\nMessage: Found a configuration file where the lifetime attribute is over 30 minutes.\nSeverity: ERROR\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-cookie-long-timeout.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-cookie-http-only\nPattern:\n'cookie'\n", "output": "Vulnerability rule: laravel-cookie-http-only\nMessage: Found a configuration file where the HttpOnly attribute is not set to true. Setting `http_only` to true makes sure that your cookies are inaccessible from Javascript, which mitigates XSS attacks. Instead, set the 'http_only' like so: `http_only` => true \nSeverity: ERROR\nCWE: [\"CWE-1004: Sensitive Cookie Without 'HttpOnly' Flag\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-cookie-http-only.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: laravel-blade-form-missing-csrf\nPattern:\naction=\"$...ROUTE\"\n", "output": "Vulnerability rule: laravel-blade-form-missing-csrf\nMessage: Detected a form executing a state-changing HTTP method `$METHOD` to route definition `$...ROUTE` without a Laravel CSRF decorator or explicit CSRF token implementation. If this form modifies sensitive state this will open your application to Cross-Site Request Forgery (CSRF) attacks.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-blade-form-missing-csrf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-cookie-same-site\nPattern:\n'cookie'\n", "output": "Vulnerability rule: laravel-cookie-same-site\nMessage: Found a configuration file where the same_site attribute is not set to 'lax' or 'strict'. Setting 'same_site' to 'lax' or 'strict' restricts cookies to a first-party or same-site context, which will protect your cookies and prevent CSRF.\nSeverity: ERROR\nCWE: ['CWE-1275: Sensitive Cookie with Improper SameSite Attribute']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-cookie-same-site.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-dangerous-model-construction\nPattern:\n$guarded = [];\n", "output": "Vulnerability rule: laravel-dangerous-model-construction\nMessage: Setting `$guarded` to an empty array allows mass assignment to every property in a Laravel model. This explicitly overrides Eloquent's safe-by-default mass assignment protections.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-dangerous-model-construction.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-cookie-secure-set\nPattern:\n'cookie'\n", "output": "Vulnerability rule: laravel-cookie-secure-set\nMessage: Found a configuration file where the secure attribute is not set to 'true'. Setting 'secure' to 'true' prevents the client from transmitting the cookie over unencrypted channels and therefore prevents cookies from being stolen through man in the middle attacks. \nSeverity: ERROR\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-cookie-secure-set.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): php\nSemgrep rule id: laravel-cookie-null-domain\nPattern:\n'cookie'\n", "output": "Vulnerability rule: laravel-cookie-null-domain\nMessage: Found a configuration file where the domain attribute is not set to null. It is recommended (unless you are using sub-domain route registrations) to set this attribute to null so that only the same origin can set the cookie, thus protecting your cookies. \nSeverity: ERROR\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: php/laravel/security/laravel-cookie-null-domain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: ifs-tampering\nPattern:\nIFS=...", "output": "Vulnerability rule: ifs-tampering\nMessage: The special variable IFS affects how splitting takes place when expanding unquoted variables. Don't set it globally. Prefer a dedicated utility such as 'cut' or 'awk' if you need to split input data. If you must use 'read', set IFS locally using e.g. 'IFS=\",\" read -a my_array'.\nSeverity: WARNING\nCWE: ['CWE-20: Improper Input Validation']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/security/ifs-tampering.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: useless-cat\nPattern:\ncat | ...\n", "output": "Vulnerability rule: useless-cat\nMessage: Useless call to 'cat' in a pipeline. Use '<' and '>' for any command to read from a file or write to a file.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/best-practice/useless-cat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: useless-cat\nPattern:\n... | cat\n", "output": "Vulnerability rule: useless-cat\nMessage: Useless call to 'cat' in a pipeline. Use '<' and '>' for any command to read from a file or write to a file.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/best-practice/useless-cat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: useless-cat\nPattern:\n... | cat | ...\n", "output": "Vulnerability rule: useless-cat\nMessage: Useless call to 'cat' in a pipeline. Use '<' and '>' for any command to read from a file or write to a file.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/best-practice/useless-cat.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: iteration-over-ls-output\nPattern:\nfor $VAR in $LIST; do\n  ...\ndone\n", "output": "Vulnerability rule: iteration-over-ls-output\nMessage: Iterating over ls output is fragile. Use globs, e.g. 'dir/*' instead of '$(ls dir)'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/best-practice/iteration-over-ls-output.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): bash\nSemgrep rule id: iteration-over-ls-output\nPattern:\n$(ls ...)\n", "output": "Vulnerability rule: iteration-over-ls-output\nMessage: Iterating over ls output is fragile. Use globs, e.g. 'dir/*' instead of '$(ls dir)'.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: bash/lang/best-practice/iteration-over-ls-output.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: balancer-readonly-reentrancy-getrate\nPattern:\nfunction $F(...) {\n  ...\n  $VAR.getRate();\n  ...\n}\n", "output": "Vulnerability rule: balancer-readonly-reentrancy-getrate\nMessage: $VAR.getRate() call on a Balancer pool is not protected from the read-only reentrancy.\nSeverity: ERROR\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/balancer-readonly-reentrancy-getrate.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: erc777-reentrancy\nPattern:\n$X.tokensReceived(...);", "output": "Vulnerability rule: erc777-reentrancy\nMessage: ERC777 tokensReceived() reentrancy\nSeverity: WARNING\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/erc777-reentrancy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: openzeppelin-ecdsa-recover-malleable\nPattern:\nfunction $F(..., bytes $Y, ...) {\n   ...\n   $Z = ECDSA.recover(..., $Y);\n   ...\n   $A[$Y] = ...;\n   ...\n}\n", "output": "Vulnerability rule: openzeppelin-ecdsa-recover-malleable\nMessage: Potential signature malleability in $F\nSeverity: WARNING\nCWE: CWE-347: Improper Verification of Cryptographic Signature\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/openzeppelin-ecdsa-recover-malleable.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: openzeppelin-ecdsa-recover-malleable\nPattern:\nfunction $F(..., bytes $Y, ...) {\n   ...\n   $Z = ECDSA.recover(..., $Y);\n   ...\n   $A[$B][$Y] = ...;\n   ...\n}\n", "output": "Vulnerability rule: openzeppelin-ecdsa-recover-malleable\nMessage: Potential signature malleability in $F\nSeverity: WARNING\nCWE: CWE-347: Improper Verification of Cryptographic Signature\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/openzeppelin-ecdsa-recover-malleable.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: erc721-reentrancy\nPattern:\n_checkOnERC721Received(...)", "output": "Vulnerability rule: erc721-reentrancy\nMessage: ERC721 onERC721Received() reentrancy\nSeverity: WARNING\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/erc721-reentrancy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: erc677-reentrancy\nPattern:\ncallAfterTransfer(...);", "output": "Vulnerability rule: erc677-reentrancy\nMessage: ERC677 callAfterTransfer() reentrancy\nSeverity: WARNING\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/erc677-reentrancy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: compound-borrowfresh-reentrancy\nPattern:\ndoTransferOut(...);", "output": "Vulnerability rule: compound-borrowfresh-reentrancy\nMessage: Function borrowFresh() in Compound performs state update after doTransferOut()\nSeverity: WARNING\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/compound-borrowfresh-reentrancy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: arbitrary-send-erc20\nPattern:\n$FUNC.transferFrom(...)", "output": "Vulnerability rule: arbitrary-send-erc20\nMessage: msg.sender is not being used when calling erc20.transferFrom. Example - Alice approves this contract to spend her ERC20 tokens. Bob can call function 'a' and specify Alice's address as the from parameter in transferFrom, allowing him to transfer Alice's tokens to himself.\nSeverity: WARNING\nCWE: ['CWE-285: Improper Authorization']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/arbitrary-send-erc20.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: gearbox-tokens-path-confusion\nPattern:\n$PATH.toAddress($PATH.length - $ADDR_SIZE);", "output": "Vulnerability rule: gearbox-tokens-path-confusion\nMessage: UniswapV3 adapter implemented incorrect extraction of path parameters\nSeverity: WARNING\nCWE: CWE-1285: Improper Validation of Specified Index, Position, or Offset in Input\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/gearbox-tokens-path-confusion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: redacted-cartel-custom-approval-bug\nPattern:\n_approve(..., allowance(sender, recipient).sub(amount, ...), ...);", "output": "Vulnerability rule: redacted-cartel-custom-approval-bug\nMessage: transferFrom() can steal allowance of other accounts\nSeverity: ERROR\nCWE: CWE-688: Function Call With Incorrect Variable or Reference as Argument\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/redacted-cartel-custom-approval-bug.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: erc721-arbitrary-transferfrom\nPattern:\n_approve(...);", "output": "Vulnerability rule: erc721-arbitrary-transferfrom\nMessage: Custom ERC721 implementation lacks access control checks in _transfer()\nSeverity: WARNING\nCWE: CWE-284: Improper Access Control\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/erc721-arbitrary-transferfrom.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: curve-readonly-reentrancy\nPattern:\n$POOL.get_virtual_price()\n", "output": "Vulnerability rule: curve-readonly-reentrancy\nMessage: $POOL.get_virtual_price() call on a Curve pool is not protected from the read-only reentrancy.\nSeverity: ERROR\nCWE: CWE-841: Improper Enforcement of Behavioral Workflow\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/curve-readonly-reentrancy.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: uniswap-callback-not-protected\nPattern:\nfunction $CALLBACK(...) { ... }\n", "output": "Vulnerability rule: uniswap-callback-not-protected\nMessage: Uniswap callback is not protected\nSeverity: WARNING\nCWE: CWE-284: Improper Access Control\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/uniswap-callback-not-protected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: keeper-network-oracle-manipulation\nPattern:\n$KEEPER.current($TOKENIN, $AMOUNTIN, $TOKENOUT);", "output": "Vulnerability rule: keeper-network-oracle-manipulation\nMessage: Keep3rV2.current() call has high data freshness, but it has low security,  an exploiter simply needs to manipulate 2 data points to be able to impact the feed.\nSeverity: WARNING\nCWE: CWE-682: Incorrect Calculation\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/keeper-network-oracle-manipulation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: superfluid-ctx-injection\nPattern:\n$T.decodeCtx(ctx);", "output": "Vulnerability rule: superfluid-ctx-injection\nMessage: A specially crafted calldata may be used to impersonate other accounts\nSeverity: ERROR\nCWE: CWE-20: Improper Input Validation\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/superfluid-ctx-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: compound-sweeptoken-not-restricted\nPattern:\ntoken.transfer(...);", "output": "Vulnerability rule: compound-sweeptoken-not-restricted\nMessage: Function sweepToken is allowed to be called by anyone\nSeverity: WARNING\nCWE: CWE-284: Improper Access Control\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/compound-sweeptoken-not-restricted.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: msg-value-multicall\nPattern:\nmsg.value", "output": "Vulnerability rule: msg-value-multicall\nMessage: $F with constant msg.value can be called multiple times\nSeverity: ERROR\nCWE: CWE-837: Improper Enforcement of a Single, Unique Action\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/msg-value-multicall.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: rigoblock-missing-access-control\nPattern:\nfunction setMultipleAllowances(...) {...}", "output": "Vulnerability rule: rigoblock-missing-access-control\nMessage: setMultipleAllowances() is missing onlyOwner modifier\nSeverity: ERROR\nCWE: CWE-284: Improper Access Control\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/security/rigoblock-missing-access-control.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: non-payable-constructor\nPattern:\nconstructor(...){\n  ...\n}\n", "output": "Vulnerability rule: non-payable-constructor\nMessage: Consider making costructor payable to save gas.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/non-payable-constructor.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: use-prefix-increment-not-postfix\nPattern:\n$VAR++", "output": "Vulnerability rule: use-prefix-increment-not-postfix\nMessage: Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/use-prefix-increment-not-postfix.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: array-length-outside-loop\nPattern:\n$VAR.length\n", "output": "Vulnerability rule: array-length-outside-loop\nMessage: Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/array-length-outside-loop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: use-multiple-require\nPattern:\nrequire (<... $X && $Y ...>, ...);\n", "output": "Vulnerability rule: use-multiple-require\nMessage: Using multiple require statements is cheaper than using && multiple check combinations.  There are more advantages, such as easier to read code and better coverage reports.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/use-multiple-require.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: use-prefix-decrement-not-postfix\nPattern:\n$VAR--", "output": "Vulnerability rule: use-prefix-decrement-not-postfix\nMessage: Consider using the prefix decrement expression whenever the return value is not needed. The prefix decrement expression is cheaper in terms of gas.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/use-prefix-decrement-not-postfix.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: use-nested-if\nPattern:\nif (<... $X && $Y ...>) {\n  ...\n}\n", "output": "Vulnerability rule: use-nested-if\nMessage: Using nested is cheaper than using && multiple check combinations.  There are more advantages, such as easier to read code and better coverage reports.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/use-nested-if.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: state-variable-read-in-a-loop\nPattern:\n$X", "output": "Vulnerability rule: state-variable-read-in-a-loop\nMessage: Replace state variable reads and writes within loops with local variable reads and writes.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/state-variable-read-in-a-loop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: non-optimal-variables-swap\nPattern:\n$TMP = $VAR1;\n...\n$VAR1 = $VAR2;\n...\n$VAR2 = $TMP;\n", "output": "Vulnerability rule: non-optimal-variables-swap\nMessage: Consider swapping variables using `($VAR1, $VAR2) = ($VAR2, $VAR1)` to save gas\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/performance/non-optimal-variables-swap.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): solidity\nSemgrep rule id: use-abi-encodecall-instead-of-encodewithselector\nPattern:\nabi.encodeWithSelector(...);\n", "output": "Vulnerability rule: use-abi-encodecall-instead-of-encodewithselector\nMessage: To guarantee arguments type safety it is recommended to use `abi.encodeCall` instead of `abi.encodeWithSelector`.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: solidity/best-practice/use-abi-encodecall-instead-of-encodewithselector.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json\nSemgrep rule id: wildcard-assume-role\nPattern:\n\"Principal\": {..., \"AWS\": \"*\", ...}\n", "output": "Vulnerability rule: wildcard-assume-role\nMessage: Detected wildcard access granted to sts:AssumeRole. This means anyone with your AWS account ID and the name of the role can assume the role. Instead, limit to a specific identity in your account, like this: `arn:aws:iam::<account_id>:root`.\nSeverity: ERROR\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: json/aws/security/wildcard-assume-role.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json\nSemgrep rule id: public-s3-policy-statement\nPattern:\n{\n  \"Effect\": \"Allow\",\n  \"Principal\": \"*\",\n  \"Resource\": [\n    ..., \"=~/arn:aws:s3.*/\", ...\n  ],\n  ...\n}\n", "output": "Vulnerability rule: public-s3-policy-statement\nMessage: Detected public S3 bucket policy. This policy allows anyone to access certain properties of or items in the bucket. Do not do this unless you will never have sensitive data inside the bucket.\nSeverity: WARNING\nCWE: ['CWE-264: CWE CATEGORY: Permissions, Privileges, and Access Controls']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: json/aws/security/public-s3-policy-statement.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-slick-overrideSql-literal\nPattern:\n$MODEL.overrideSql($QUERY,...)", "output": "Vulnerability rule: scala-slick-overrideSql-literal\nMessage: Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Avoid using non literal values in `overrideSql(...)`.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/slick/security/scala-slick-overrideSql-literal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-slick-sql-non-literal\nPattern:\nsql\"...\"", "output": "Vulnerability rule: scala-slick-sql-non-literal\nMessage: Detected a formatted string in a SQL statement. This could lead to SQL injection if variables in the SQL statement are not properly sanitized. Avoid using `#$variable` and use `$variable` in `sql\"...\"` strings instead.\nSeverity: ERROR\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/slick/security/scala-slick-sql-non-literal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: rsa-padding-set\nPattern:\n$VAR = $CIPHER.getInstance($MODE)\n", "output": "Vulnerability rule: rsa-padding-set\nMessage: Usage of RSA without OAEP (Optimal Asymmetric Encryption Padding) may weaken encryption. This could lead to sensitive data exposure. Instead, use RSA with `OAEPWithMD5AndMGF1Padding` instead.\nSeverity: WARNING\nCWE: ['CWE-780: Use of RSA Algorithm without OAEP']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/rsa-padding-set.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: dangerous-seq-run\nPattern:\nSeq($CMD, ...)", "output": "Vulnerability rule: dangerous-seq-run\nMessage: Found dynamic content used for the external process. This is dangerous if arbitrary data can reach this function call because it allows a malicious actor to execute commands. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/dangerous-seq-run.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: dispatch-ssrf\nPattern:\nurl($URL)", "output": "Vulnerability rule: dispatch-ssrf\nMessage: A parameter being passed directly into `url` most likely lead to SSRF. This could allow an attacker to send data to their own server, potentially exposing sensitive data sent with this request. They could also probe internal servers or other resources that the server running this code can access. Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts, or hardcode the correct host.\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/dispatch-ssrf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scalaj-http-ssrf\nPattern:\nHttp($URL)", "output": "Vulnerability rule: scalaj-http-ssrf\nMessage: A parameter being passed directly into `Http` can likely lead to SSRF. This could allow an attacker to send data to their own server, potentially exposing sensitive data sent with this request. They could also probe internal servers or other resources that the server running this code can access. Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts, or hardcode the correct host.\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/scalaj-http-ssrf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: insecure-random\nPattern:\nimport scala.util.Random\n", "output": "Vulnerability rule: insecure-random\nMessage: Flags the use of a predictable random value from `scala.util.Random`. This can lead to vulnerabilities when used in security contexts, such as in a CSRF token, password reset token, or any other secret value. To fix this, use java.security.SecureRandom instead.\nSeverity: WARNING\nCWE: ['CWE-330: Use of Insufficiently Random Values']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: dangerous-shell-run\nPattern:\nSeq($SH, \"-c\", $CMD, ...)", "output": "Vulnerability rule: dangerous-shell-run\nMessage: Found dynamic content used for the external process. This is dangerous if arbitrary data can reach this function call because it allows a malicious actor to execute commands. Ensure your variables are not controlled by users or sufficiently sanitized.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/lang/security/audit/dangerous-shell-run.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\ncom.auth0.jwt.algorithms.Algorithm.HMAC256(\"...\");\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\n$SECRET = \"...\";\n...\ncom.auth0.jwt.algorithms.Algorithm.HMAC256($SECRET);\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\nclass $CLASS {\n  ...\n  $DECL $SECRET = \"...\";\n  ...\n  def $FUNC (...): $RETURNTYPE = {\n    ...\n    com.auth0.jwt.algorithms.Algorithm.HMAC256($SECRET);\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\ncom.auth0.jwt.algorithms.Algorithm.HMAC384(\"...\");\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\n$SECRET = \"...\";\n...\ncom.auth0.jwt.algorithms.Algorithm.HMAC384($SECRET);\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\nclass $CLASS {\n  ...\n  $DECL $SECRET = \"...\";\n  ...\n  def $FUNC (...): $RETURNTYPE = {\n    ...\n    com.auth0.jwt.algorithms.Algorithm.HMAC384($SECRET);\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\ncom.auth0.jwt.algorithms.Algorithm.HMAC512(\"...\");\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\n$SECRET = \"...\";\n...\ncom.auth0.jwt.algorithms.Algorithm.HMAC512($SECRET);\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: scala-jwt-hardcoded-secret\nPattern:\nclass $CLASS {\n  ...\n  $DECL $SECRET = \"...\";\n  ...\n  def $FUNC (...): $RETURNTYPE = {\n    ...\n    com.auth0.jwt.algorithms.Algorithm.HMAC512($SECRET);\n    ...\n  }\n  ...\n}\n", "output": "Vulnerability rule: scala-jwt-hardcoded-secret\nMessage: Hardcoded JWT secret or private key is used. This is a Insufficiently Protected Credentials weakness: https://cwe.mitre.org/data/definitions/522.html Consider using an appropriate security mechanism to protect the credentials (e.g. keeping secrets in environment variables)\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/scala-jwt/security/jwt-hardcode.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: conf-insecure-cookie-settings\nPattern:\nsecure = false", "output": "Vulnerability rule: conf-insecure-cookie-settings\nMessage: Session cookie `Secure` flag is explicitly disabled. The `secure` flag for cookies prevents the client from transmitting the cookie over insecure channels such as HTTP. Set the `Secure` flag by setting `secure` to `true` in configuration file.\nSeverity: WARNING\nCWE: [\"CWE-614: Sensitive Cookie in HTTPS Session Without 'Secure' Attribute\"]\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/play/security/conf-insecure-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): scala\nSemgrep rule id: webservice-ssrf\nPattern:\n$WS.url($URL)", "output": "Vulnerability rule: webservice-ssrf\nMessage: A parameter being passed directly into `WSClient` most likely lead to SSRF. This could allow an attacker to send data to their own server, potentially exposing sensitive data sent with this request. They could also probe internal servers or other resources that the server running this code can access. Do not allow arbitrary hosts. Instead, create an allowlist for approved hosts hardcode the correct host.\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: scala/play/security/webservice-ssrf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: swift-webview-config-allows-js-open-windows\nPattern:\n$P = WKPreferences()\n...\n", "output": "Vulnerability rule: swift-webview-config-allows-js-open-windows\nMessage: Webviews were observed that explictly allow JavaScript in an WKWebview to open windows automatically. Consider disabling this functionality if not required, following the principle of least privelege.\nSeverity: WARNING\nCWE: ['CWE-272: Least Privilege Violation']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/webview/webview-js-window.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nrandom()", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nInt.random(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nBool.random(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nFloat.random(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nDouble.random(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\narc4random()", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\narc4random_buf(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\narc4random_uniform(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nSystemRandomNumberGenerator(...)", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: insecure-random\nPattern:\nrand()", "output": "Vulnerability rule: insecure-random\nMessage: A random number generator was detected which is **not** *guaranteed* to be Cryptographically secure. If the source of entropy is used for security purposes (e.g. with other Cryptographic operations), make sure to use the `SecCopyRandomBytes` API explicitly.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: swift/lang/crypto/insecure-random.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: detect-openai\nPattern:\nimport \"github.com/sashabaranov/go-openai\"", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/go/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: detect-openai\nPattern:\ngogpt.NewClient(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/go/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: detect-gemini\nPattern:\nimport \"github.com/google/generative-ai-go\"", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/go/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: detect-gemini\nPattern:\ngenai.NewClient(...)", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/go/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-anthropic\nPattern:\nimport anthropic", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-anthropic\nPattern:\nfrom anthropic import $ANYTHING", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-anthropic\nPattern:\nAnthropic(...)", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-anthropic\nPattern:\nanthropic.Anthropic(...)", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-anthropic\nPattern:\n$CLIENT.messages.$FUNC(...,model=...,...)", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-tensorflow\nPattern:\nimport tensorflow", "output": "Vulnerability rule: detect-tensorflow\nMessage: Possibly found usage of AI tooling: Tensorflow\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-tensorflow.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-openai\nPattern:\nimport openai", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-openai\nPattern:\nfrom openai import $ANYTHING", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-openai\nPattern:\nOpenAI(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-openai\nPattern:\n$CLIENT.chat.completions.$FUNC(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain_openai", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nChatOpenAI(...)", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain_community", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nOllama(...)", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain_anthropic", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nChatAnthropic(...)", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain_cohere", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nChatCohere(...)", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain_core", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-langchain\nPattern:\nimport langchain", "output": "Vulnerability rule: detect-langchain\nMessage: Possibly found usage of AI tooling: LangChain\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-langchain.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-mistral\nPattern:\nimport mistralai", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-mistral\nPattern:\nMistralClient(...)", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-mistral\nPattern:\n$CLIENT.chat(...,model=...,...)", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-pytorch\nPattern:\nimport torch", "output": "Vulnerability rule: detect-pytorch\nMessage: Possibly found usage of AI tooling: PyTorch\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-pytorch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-pytorch\nPattern:\ntorch.$FUNC(...)", "output": "Vulnerability rule: detect-pytorch\nMessage: Possibly found usage of AI tooling: PyTorch\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-pytorch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-huggingface\nPattern:\nimport huggingface_hub", "output": "Vulnerability rule: detect-huggingface\nMessage: Possibly found usage of AI: HuggingFace\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-huggingface.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): python\nSemgrep rule id: detect-gemini\nPattern:\nimport google.generativeai", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/python/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dart\nSemgrep rule id: detect-gemini\nPattern:\nimport 'package:google_generative_ai';", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/dart/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dart\nSemgrep rule id: detect-gemini\nPattern:\nfinal $MODEL = GenerativeModel(...);", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/dart/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-promptfoo\nPattern:\nimport \"promptfoo\"", "output": "Vulnerability rule: detect-promptfoo\nMessage: Possibly found usage of AI tooling: promptfoo\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-promptfoo.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-promptfoo\nPattern:\npromptfoo.evaluate(...)", "output": "Vulnerability rule: detect-promptfoo\nMessage: Possibly found usage of AI tooling: promptfoo\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-promptfoo.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-anthropic\nPattern:\nimport \"@anthropic-ai\"", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-anthropic\nPattern:\nimport $ANYTHING from \"@anthropic-ai\";", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-anthropic\nPattern:\nnew Anthropic(...)", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-anthropic\nPattern:\nanthropic.messages.$FUNC(...)", "output": "Vulnerability rule: detect-anthropic\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-anthropic.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-openai\nPattern:\nimport \"openai\"", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-openai\nPattern:\nimport $ANYTHING from \"openai\";", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-openai\nPattern:\nnew OpenAI(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-openai\nPattern:\n$CLIENT.chat.completions.$FUNC(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-vercel-ai\nPattern:\nimport \"ai\"", "output": "Vulnerability rule: detect-vercel-ai\nMessage: Possibly found usage of AI: VercelAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-vercel-ai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-vercel-ai\nPattern:\nimport \"@ai-sdk\"", "output": "Vulnerability rule: detect-vercel-ai\nMessage: Possibly found usage of AI: VercelAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-vercel-ai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-vercel-ai\nPattern:\ngenerateText({model:...})", "output": "Vulnerability rule: detect-vercel-ai\nMessage: Possibly found usage of AI: VercelAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-vercel-ai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-vercel-ai\nPattern:\ngenerateText({prompt:...})", "output": "Vulnerability rule: detect-vercel-ai\nMessage: Possibly found usage of AI: VercelAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-vercel-ai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-mistral\nPattern:\nimport \"@mistralai\"", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-mistral\nPattern:\nnew MistralClient(...)", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-mistral\nPattern:\n$CLIENT.chat({model: ...})", "output": "Vulnerability rule: detect-mistral\nMessage: Possibly found usage of AI: Mistral\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-mistral.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-gemini\nPattern:\nimport \"@google/generative-ai\"", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-gemini\nPattern:\nimport $ANYTHING from \"@google/generative-ai\";", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-gemini\nPattern:\nnew GoogleGenerativeAI(...)", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js, ts\nSemgrep rule id: detect-gemini\nPattern:\n$GENAI.getGenerativeModel(...)", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/typescript/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kotlin\nSemgrep rule id: detect-gemini\nPattern:\nimport com.google.ai", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/kotlin/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): kotlin\nSemgrep rule id: detect-gemini\nPattern:\nGenerativeModel(...)", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/kotlin/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: detect-apple-core-ml\nPattern:\nVNCoreMLModel(...)", "output": "Vulnerability rule: detect-apple-core-ml\nMessage: Possibly found usage of AI: Apple CoreML\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/swift/detect-apple-core-ml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: detect-apple-core-ml\nPattern:\nMLModelConfiguration(...)", "output": "Vulnerability rule: detect-apple-core-ml\nMessage: Possibly found usage of AI: Apple CoreML\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/swift/detect-apple-core-ml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: detect-gemini\nPattern:\nimport GoogleGenerativeAI", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/swift/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): swift\nSemgrep rule id: detect-gemini\nPattern:\nGenerativeModel(...)", "output": "Vulnerability rule: detect-gemini\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/swift/detect-gemini.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-anthprop\nPattern:\nanthropic", "output": "Vulnerability rule: detect-generic-ai-anthprop\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-anthprop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-anthprop\nPattern:\nAnthropic", "output": "Vulnerability rule: detect-generic-ai-anthprop\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-anthprop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-anthprop\nPattern:\nclaude", "output": "Vulnerability rule: detect-generic-ai-anthprop\nMessage: Possibly found usage of AI: Anthropic\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-anthprop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-api\nPattern:\n/chat/completions", "output": "Vulnerability rule: detect-generic-ai-api\nMessage: Possibly found usage of AI: HTTP Request\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-api.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-api\nPattern:\napi.openai.com", "output": "Vulnerability rule: detect-generic-ai-api\nMessage: Possibly found usage of AI: HTTP Request\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-api.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-gem\nPattern:\ngoogle/generative-ai", "output": "Vulnerability rule: detect-generic-ai-gem\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-gem.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-gem\nPattern:\nGoogleGenerativeAI", "output": "Vulnerability rule: detect-generic-ai-gem\nMessage: Possibly found usage of AI: Gemini\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-gem.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-oai\nPattern:\nopenai", "output": "Vulnerability rule: detect-generic-ai-oai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-oai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detect-generic-ai-oai\nPattern:\nOpenAI", "output": "Vulnerability rule: detect-generic-ai-oai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/generic/detect-generic-ai-oai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: detect-openai\nPattern:\nusing OpenAI", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/csharp/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: detect-openai\nPattern:\n(ChatClient $CLIENT)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/csharp/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: detect-openai\nPattern:\n(ChatClient $CLIENT).$FUNC(...)", "output": "Vulnerability rule: detect-openai\nMessage: Possibly found usage of AI: OpenAI\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ai/csharp/detect-openai.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: changes-with-when-never\nPattern:\n- changes:\n  - ...\n  when: never\n", "output": "Vulnerability rule: changes-with-when-never\nMessage: This Gitlab CI YAML will never run on default branches due to a `changes` rule with `when:never`. To fix this, make sure the triggering event is a push event. You can do this with `if: '$CI_PIPELINE_SOURCE == \"push\"'`. See https://docs.gitlab.com/ee/ci/yaml/index.html#ruleschanges\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/gitlab/correctness/changes-with-when-never.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: interfile-true-under-metadata-and-no-options\nPattern:\nrules:\n  - id: $ID\n    ...\n    $METADATA:\n      ...\n      $INTERFILE: true\n      ...\n    ...\n", "output": "Vulnerability rule: interfile-true-under-metadata-and-no-options\nMessage: `interfile: true` should be under the `options` field, not the `metadata` field.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/interfile-true-under-metadata-and-no-options.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: empty-message\nPattern:\nmessage: \"\"\n", "output": "Vulnerability rule: empty-message\nMessage: This rule has an empty message field. Consider adding a message field that communicates why this rule is an issue and how to fix it. This will increase the chance that the finding gets addressed.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/empty-message.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-1\nPattern:\n...", "output": "Vulnerability rule: example-1\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: A1: Some Vulnerability\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-2\nPattern:\n...", "output": "Vulnerability rule: example-2\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: A11: Some Vulnerability\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-3\nPattern:\n...", "output": "Vulnerability rule: example-3\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: a4\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-4\nPattern:\n...", "output": "Vulnerability rule: example-4\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: A5 Some Vulnerability\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-5\nPattern:\n...", "output": "Vulnerability rule: example-5\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-6\nPattern:\n...", "output": "Vulnerability rule: example-6\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: ['A5:2021 - Security Misconfiguration', 'A06:201789 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-owasp.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: other-rule\nPattern:\n<div>hello</div>", "output": "Vulnerability rule: other-rule\nMessage: \nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-language-field.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-1\nPattern:\n...", "output": "Vulnerability rule: example-1\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-references.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-2\nPattern:\n...", "output": "Vulnerability rule: example-2\nMessage: Example\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-references.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: bad-1\nPattern:\n...", "output": "Vulnerability rule: bad-1\nMessage: a\nb\n\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/multi-line-message.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: bad-2\nPattern:\n...", "output": "Vulnerability rule: bad-2\nMessage: a\nb\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/multi-line-message.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: good-1\nPattern:\n...", "output": "Vulnerability rule: good-1\nMessage: a b\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/multi-line-message.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call\nPattern:\nsubprocess.call(...)\n", "output": "Vulnerability rule: unchecked-subprocess-call\nMessage: \nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-message-field.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: other-rule\nPattern:\n<div>hello</div>", "output": "Vulnerability rule: other-rule\nMessage: \nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-message-field.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: other-rule-2\nPattern:\n<div>hello</div>", "output": "Vulnerability rule: other-rule-2\nMessage: \nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-message-field.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-impact-incorrect-value\nPattern:\nimpact: $VALUE\n", "output": "Vulnerability rule: metadata-impact-incorrect-value\nMessage: Semgrep rule impact: $VALUE detected, but the value must be LOW, MEDIUM, or HIGH. For more information visit: https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-impact-incorrect-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: message-whitespace-check\nPattern:\nmessage: >-\n  $VALUE\n", "output": "Vulnerability rule: message-whitespace-check\nMessage: It looks like you have an additional space in your rule message, this can look awkward in the finding output, please remove the additional whitespace!\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/message-whitespace.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: interfile-true-under-metadata-and-options-already-present\nPattern:\nrules:\n  - id: $ID\n    ...\n    $METADATA:\n      ...\n      $INTERFILE: true\n      ...\n    ...\n", "output": "Vulnerability rule: interfile-true-under-metadata-and-options-already-present\nMessage: `interfile: true` should be under the `options` field, not the `metadata` field.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/interfile-true-under-metadata-and-options-already-present.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-incorrect-option\nPattern:\n$KEY: $VALUE\n", "output": "Vulnerability rule: metadata-incorrect-option\nMessage: It looks like $KEY is not in the default list of expected options, if this is a new key update this rule\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-incorrect-option.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: duplicate-id\nPattern:\nid: $X\n", "output": "Vulnerability rule: duplicate-id\nMessage: The 'id' field $X was used multiple times. The 'id' field needs to be unique.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/duplicate-id.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript\nSemgrep rule id: javascript.phantom.security.audit.phantom-injection.phantom-injection\nPattern:\n...\n$PHANTOM = require('phantom');\n...\n", "output": "Vulnerability rule: javascript.phantom.security.audit.phantom-injection.phantom-injection\nMessage: If unverified user data can reach the `phantom` page methods it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/slow-pattern-top-ellipsis.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: duplicate-pattern\nPattern:\npattern: $X\n", "output": "Vulnerability rule: duplicate-pattern\nMessage: Two identical pattern clauses were detected. This will cause Semgrep to run the same pattern twice. Remove one of the duplicate pattern clauses.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/duplicate-pattern.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js\nSemgrep rule id: half-written-crypto-example\nPattern:\ncreateCipheriv($ALGO, $KEY, $IV);\n", "output": "Vulnerability rule: half-written-crypto-example\nMessage: A lav crypto hun\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/rule-missing-deconstructed-value.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: multi-line-message\nPattern:\nmessage: \"=~/[\\\\n\\\\r]/\"\n", "output": "Vulnerability rule: multi-line-message\nMessage: This rule has a multi-line message field, which may display poorly in a terminal. Consider ensuring it is on one line. For example, use `message: >-`, not `message: |`.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/multi-line-message.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: metadata-references\nPattern:\nreferences: ...\n", "output": "Vulnerability rule: metadata-references\nMessage: The references in rule metadata should always be a list, even if there's only one.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-references.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-category\nPattern:\nid: $RULEID", "output": "Vulnerability rule: metadata-category\nMessage: This Semgrep rule is missing a valid 'category' field in the 'metadata'. 'category' must be one of 'security', 'correctness', 'best-practice', 'performance', 'maintainability', or 'portability'.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-category.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-subcategory-incorrect-value\nPattern:\nsubcategory: \n  - $VALUE\n", "output": "Vulnerability rule: metadata-subcategory-incorrect-value\nMessage: Semgrep rule likelihood: $VALUE detected, but the value must be vuln, audit, or secure default. For more information visit: https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-subcategory-incorrect-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-cwe-prohibited-or-discouraged\nPattern:\ncwe: $CWE", "output": "Vulnerability rule: metadata-cwe-prohibited-or-discouraged\nMessage: Vulnerability mapping for this CWE is discouraged or prohibited.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe-prohibited-or-discouraged.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-1\nPattern:\n...", "output": "Vulnerability rule: example-1\nMessage: Example\nSeverity: ERROR\nCWE: CWE-123: Some Vulnerability\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-2\nPattern:\n...", "output": "Vulnerability rule: example-2\nMessage: Example\nSeverity: ERROR\nCWE: CWE123: Some Vulnerability\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-3\nPattern:\n...", "output": "Vulnerability rule: example-3\nMessage: Example\nSeverity: ERROR\nCWE: cwe-123: Some Vulnerability\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-4\nPattern:\n...", "output": "Vulnerability rule: example-4\nMessage: Example\nSeverity: ERROR\nCWE: CWE-123\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-4\nPattern:\n...", "output": "Vulnerability rule: example-4\nMessage: Example\nSeverity: ERROR\nCWE: CWE-123: Some Vulnerability\n\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-license\nPattern:\nlicense: ...\n", "output": "Vulnerability rule: metadata-license\nMessage: The license should not be set in rule metadata, it gets added by Semgrep app at the registry level.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-license.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-confidence-incorrect-value\nPattern:\nconfidence: $VALUE\n", "output": "Vulnerability rule: metadata-confidence-incorrect-value\nMessage: Semgrep rule confidence: $VALUE detected, but the value must be LOW, MEDIUM, or HIGH. For more information visit: https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-confidence-incorrect-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-allowed\nPattern:\n...", "output": "Vulnerability rule: example-allowed\nMessage: Example\nSeverity: ERROR\nCWE: CWE-257: Storing Passwords in a Recoverable Format\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe-prohibited-or-discouraged.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): json, yaml\nSemgrep rule id: example-prohibited\nPattern:\n...", "output": "Vulnerability rule: example-prohibited\nMessage: Example\nSeverity: ERROR\nCWE: CWE-320: Key Management Errors\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe-prohibited-or-discouraged.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: missing-message-field\nPattern:\nid: $RULEID", "output": "Vulnerability rule: missing-message-field\nMessage: This rule does not have a message. Semgrep requires that rules have a message. Include a message to explain what the rule does. Consider writing a message that explains why this is an issue and how to fix it.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-message-field.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-cwe\nPattern:\ncwe: ...", "output": "Vulnerability rule: metadata-cwe\nMessage: $...CWE The cwe tag in rule metadata should always be in the format \"CWE-000: Title\".\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-cwe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: metadata-likelihood-incorrect-value\nPattern:\nlikelihood: $VALUE\n", "output": "Vulnerability rule: metadata-likelihood-incorrect-value\nMessage: Semgrep rule likelihood: $VALUE detected, but the value must be LOW, MEDIUM, or HIGH. For more information visit: https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/metadata-likelihood-incorrect-value.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call\nPattern:\nsubprocess.call(...)\n", "output": "Vulnerability rule: unchecked-subprocess-call\nMessage: blah\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unsatisfiable.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: missing-language-field\nPattern:\nid: $RULEID", "output": "Vulnerability rule: missing-language-field\nMessage: Please include a 'languages' field for your rule!\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/missing-language-field.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): js\nSemgrep rule id: half-written-crypto-example\nPattern:\ncreateCipheriv($ALGO, $KEY, $IV);\n", "output": "Vulnerability rule: half-written-crypto-example\nMessage: # ruleid: message-whitespace-check Semgrep found  a match # ruleid: message-whitespace-check I like    big space\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/message-whitespace.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call2\nPattern:\nsubprocess.call3(...)", "output": "Vulnerability rule: unchecked-subprocess-call2\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call4\nPattern:\nsubprocess.call3(...)", "output": "Vulnerability rule: unchecked-subprocess-call4\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call5\nPattern:\nsubprocess.call1(...)", "output": "Vulnerability rule: unchecked-subprocess-call5\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call6\nPattern:\nsubprocess.call1(...)", "output": "Vulnerability rule: unchecked-subprocess-call6\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call6\nPattern:\nsubprocess.call2(...)", "output": "Vulnerability rule: unchecked-subprocess-call6\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call7\nPattern:\nsubprocess.call1(...)", "output": "Vulnerability rule: unchecked-subprocess-call7\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call8\nPattern:\nsubprocess.call1(...)", "output": "Vulnerability rule: unchecked-subprocess-call8\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): unknown\nSemgrep rule id: unchecked-subprocess-call8\nPattern:\nsubprocess.call2(...)", "output": "Vulnerability rule: unchecked-subprocess-call8\nMessage: test\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/unnecessary-parent.test.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-hcl\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-hcl\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'hcl' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-hcl.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-python\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-python\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'python' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-python.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-kotlin\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-kotlin\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'kotlin' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-kotlin.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-regex\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-regex\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'regex' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-regex.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-solidity\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-solidity\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'solidity' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-solidity.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-js\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-js\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'js' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-js.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-cpp\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-cpp\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'cpp' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-cpp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-go\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-go\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'go' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-go.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-dockerfile\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-dockerfile\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'dockerfile' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-dockerfile.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-elixir\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-elixir\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'elixir' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-elixir.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-csharp\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-csharp\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'csharp' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-csharp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-bash\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-bash\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'bash' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-bash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: lang-consistency-ts\nPattern:\n$X", "output": "Vulnerability rule: lang-consistency-ts\nMessage: Found '$X' in language config which diverges from semgrep.dev normalization. Please use 'ts' instead.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/semgrep/consistency/lang-consistency-ts.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: api-key-in-query-parameter\nPattern:\n$SECURITY_SCHEME:\n  ...\n  type: apiKey\n  ...\n  in: query\n  \n", "output": "Vulnerability rule: api-key-in-query-parameter\nMessage: The $SECURITY_SCHEME security scheme passes an API key in a query parameter. API keys should not be passed as query parameters in security schemes.  Pass the API key in the header or body. If using a query parameter is necessary, ensure that the API key is tightly scoped and short lived.\nSeverity: WARNING\nCWE: CWE-598: Use of GET Request Method With Sensitive Query Strings\nOWASP: ['A04:2021 Insecure Design', 'A07:2021 Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/openapi/security/api-key-in-query-parameter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: use-of-basic-authentication\nPattern:\ntype: http\n...\nscheme: basic\n", "output": "Vulnerability rule: use-of-basic-authentication\nMessage: Basic authentication is considered weak and should be avoided.  Use a different authentication scheme, such of OAuth2, OpenID Connect, or mTLS.\nSeverity: ERROR\nCWE: CWE-287: Improper Authentication\nOWASP: ['A04:2021 Insecure Design', 'A07:2021 Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/openapi/security/use-of-basic-authentication.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: no-new-privileges\nPattern:\n$SERVICE:\n  ...\n  image: ...\n", "output": "Vulnerability rule: no-new-privileges\nMessage: Service '$SERVICE' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/docker-compose/security/no-new-privileges.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: seccomp-confinement-disabled\nPattern:\n$SERVICE:\n  ...\n  image: ...\n  ...\n  security_opt:\n    - ...\n    - seccomp:unconfined\n", "output": "Vulnerability rule: seccomp-confinement-disabled\nMessage: Service '$SERVICE' is explicitly disabling seccomp confinement. This runs the service in an unrestricted state. Remove 'seccomp:unconfined' to prevent this.\nSeverity: WARNING\nCWE: ['CWE-284: Improper Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/docker-compose/security/seccomp-confinement-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: selinux-separation-disabled\nPattern:\n$SERVICE:\n  ...\n  image: ...\n  ...\n  security_opt:\n    - ...\n    - label:disable\n", "output": "Vulnerability rule: selinux-separation-disabled\nMessage: Service '$SERVICE' is explicitly disabling SELinux separation. This runs the service as an unconfined type. Remove 'label:disable' to prevent this.\nSeverity: WARNING\nCWE: ['CWE-284: Improper Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/docker-compose/security/selinux-separation-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: writable-filesystem-service\nPattern:\n$SERVICE:\n  ...\n  image: ...\n  ...\n", "output": "Vulnerability rule: writable-filesystem-service\nMessage: Service '$SERVICE' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/docker-compose/security/writable-filesystem-service.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: allow-privilege-escalation-true\nPattern:\nallowPrivilegeEscalation: $TRUE\n", "output": "Vulnerability rule: allow-privilege-escalation-true\nMessage: In Kubernetes, each pod runs in its own isolated environment with its own  set of security policies. However, certain container images may contain  `setuid` or `setgid` binaries that could allow an attacker to perform  privilege escalation and gain access to sensitive resources. To mitigate  this risk, it's recommended to add a `securityContext` to the container in  the pod, with the parameter `allowPrivilegeEscalation` set to `false`.  This will prevent the container from running any privileged processes and  limit the impact of any potential attacks.  In the container `$CONTAINER` this parameter is set to `true` which makes this container much more vulnerable to privelege escalation attacks.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/allow-privilege-escalation-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: run-as-non-root-container-level-missing-security-context\nPattern:\n- name: $CONTAINER\n  $IMAGE: $IMAGEVAL\n  ...\n", "output": "Vulnerability rule: run-as-non-root-container-level-missing-security-context\nMessage: When running containers in Kubernetes, it's important to ensure that they are properly secured to prevent privilege escalation attacks. One potential vulnerability is when a container is allowed to run applications as the root user, which could allow an attacker to gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container, with the parameter `runAsNonRoot` set to `true`. This will ensure that the container runs as a non-root user, limiting the damage that could be caused by any potential attacks. By adding a `securityContext` to the container in your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.\nSeverity: INFO\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/run-as-non-root-container-level-missing-security-context.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: legacy-api-clusterrole-excessive-permissions\nPattern:\n\"*\"\n", "output": "Vulnerability rule: legacy-api-clusterrole-excessive-permissions\nMessage: Semgrep detected a Kubernetes core API ClusterRole with excessive permissions. Attaching excessive permissions to a ClusterRole associated with the core namespace allows the V1 API to perform arbitrary actions on arbitrary resources attached to the cluster. Prefer explicit allowlists of verbs/resources when configuring the core API namespace. \nSeverity: WARNING\nCWE: ['CWE-269: Improper Privilege Management']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/legacy-api-clusterrole-excessive-permissions.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: skip-tls-verify-service\nPattern:\nspec:\n  ...\n  insecureSkipTLSVerify: true\n", "output": "Vulnerability rule: skip-tls-verify-service\nMessage: Service is disabling TLS certificate verification when communicating with the server. This makes your HTTPS connections insecure. Remove the 'insecureSkipTLSVerify: true' key to secure communication.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/skip-tls-verify-service.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: allow-privilege-escalation-no-securitycontext\nPattern:\nimage: ...\n...\n", "output": "Vulnerability rule: allow-privilege-escalation-no-securitycontext\nMessage: In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/allow-privilege-escalation-no-securitycontext.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: seccomp-confinement-disabled\nPattern:\nimage: ...\n...\nsecurityContext:\n  ...\n  seccompProfile: unconfined\n", "output": "Vulnerability rule: seccomp-confinement-disabled\nMessage: Container is explicitly disabling seccomp confinement. This runs the service in an unrestricted state. Remove 'seccompProfile: unconfined' to prevent this.\nSeverity: WARNING\nCWE: ['CWE-284: Improper Access Control']\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/seccomp-confinement-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: hostpid-pod\nPattern:\nhostPID: true\n", "output": "Vulnerability rule: hostpid-pod\nMessage: Pod is sharing the host process ID namespace. When paired with ptrace this can be used to escalate privileges outside of the container. Remove the 'hostPID' key to disable this functionality.\nSeverity: WARNING\nCWE: ['CWE-269: Improper Privilege Management']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/hostpid-pod.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: hostnetwork-pod\nPattern:\nhostNetwork: true\n", "output": "Vulnerability rule: hostnetwork-pod\nMessage: Pod may use the node network namespace. This gives the pod access to the loopback device, services listening on localhost, and could be used to snoop on network activity of other pods on the same node. Remove the 'hostNetwork' key to disable this functionality.\nSeverity: WARNING\nCWE: ['CWE-406: Insufficient Control of Network Message Volume (Network Amplification)']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/hostnetwork-pod.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: writable-filesystem-container\nPattern:\nimage: ...\n...\n", "output": "Vulnerability rule: writable-filesystem-container\nMessage: Container $CONTAINER is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'readOnlyRootFilesystem: true' to this container to prevent this.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/writable-filesystem-container.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: exposing-docker-socket-hostpath\nPattern:\nhostPath:\n  ...\n  path: /var/run/docker.sock\n", "output": "Vulnerability rule: exposing-docker-socket-hostpath\nMessage: Exposing host's Docker socket to containers via a volume. The owner of this socket is root. Giving someone access to it is equivalent to giving unrestricted root access to your host. Remove 'docker.sock' from hostpath to prevent this.\nSeverity: WARNING\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/exposing-docker-socket-hostpath.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: hostipc-pod\nPattern:\nhostIPC: true\n", "output": "Vulnerability rule: hostipc-pod\nMessage: Pod is sharing the host IPC namespace. This allows container processes to communicate with processes on the host which reduces isolation and bypasses container protection models. Remove the 'hostIPC' key to disable this functionality.\nSeverity: WARNING\nCWE: ['CWE-693: Protection Mechanism Failure']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/hostipc-pod.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: allow-privilege-escalation\nPattern:\nimage: ...\n...\n", "output": "Vulnerability rule: allow-privilege-escalation\nMessage: In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding the `allowPrivilegeEscalation` parameter to your the `securityContext`, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.\nSeverity: WARNING\nCWE: ['CWE-732: Incorrect Permission Assignment for Critical Resource']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/allow-privilege-escalation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: secrets-in-config-file\nPattern:\n$KEY: $VALUE\n", "output": "Vulnerability rule: secrets-in-config-file\nMessage: Secrets ($VALUE) should not be stored in infrastructure as code files. Use an alternative such as Bitnami Sealed Secrets or KSOPS to encrypt Kubernetes Secrets. \nSeverity: WARNING\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/secrets-in-config-file.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: skip-tls-verify-cluster\nPattern:\ncluster:\n  ...\n  insecure-skip-tls-verify: true\n", "output": "Vulnerability rule: skip-tls-verify-cluster\nMessage: Cluster is disabling TLS certificate verification when communicating with the server. This makes your HTTPS connections insecure. Remove the 'insecure-skip-tls-verify: true' key to secure communication.\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/skip-tls-verify-cluster.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: run-as-non-root-container-level\nPattern:\n- name: $CONTAINER\n  image: ...\n  ...\n  $SC:\n    ...\n", "output": "Vulnerability rule: run-as-non-root-container-level\nMessage: When running containers in Kubernetes, it's important to ensure that they are properly secured to prevent privilege escalation attacks. One potential vulnerability is when a container is allowed to run applications as the root user, which could allow an attacker to gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container, with the parameter `runAsNonRoot` set to `true`. This will ensure that the container runs as a non-root user, limiting the damage that could be caused by any potential attacks. By adding a `securityContext` to the container in your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.\nSeverity: INFO\nCWE: ['CWE-250: Execution with Unnecessary Privileges']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A06:2017 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/run-as-non-root-container-level.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: flask-debugging-enabled\nPattern:\n{name: FLASK_ENV, value: \"development\"}\n", "output": "Vulnerability rule: flask-debugging-enabled\nMessage: Do not set FLASK_ENV to \"development\" since that sets `debug=True` in Flask. Use \"dev\" or a similar term instead.\nSeverity: WARNING\nCWE: ['CWE-489: Active Debug Code']\nOWASP: A06:2017 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/security/env/flask-debugging-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: no-fractional-cpu-limits\nPattern:\ncpu: $CPU_LIMIT\n", "output": "Vulnerability rule: no-fractional-cpu-limits\nMessage: When you set a fractional CPU limit on a container, the CPU cycles available will be throttled, even though most nodes can handle processes alternating between using 100% of the CPU.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/kubernetes/best-practice/no-fractional-cpu-limits.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: curl-eval\nPattern:\nrun: $SHELL", "output": "Vulnerability rule: curl-eval\nMessage: Data is being eval'd from a `curl` command. An attacker with control of the server in the `curl` command could inject malicious code into the `eval`, resulting in a system comrpomise. Avoid eval'ing untrusted data if you can. If you must do this, consider checking the SHA sum of the content returned by the server to verify its integrity.\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/github-actions/security/curl-eval.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: pull-request-target-code-checkout\nPattern:\n...\nuses: \"$ACTION\"\nwith:\n  ...\n  ref: $EXPR\n", "output": "Vulnerability rule: pull-request-target-code-checkout\nMessage: This GitHub Actions workflow file uses `pull_request_target` and checks out code from the incoming pull request. When using `pull_request_target`, the Action runs in the context of the target repository, which includes access to all repository secrets. Normally, this is safe because the Action only runs code from the target repository, not the incoming PR. However, by checking out the incoming PR code, you're now using the incoming code for the rest of the action. You may be inadvertently executing arbitrary code from the incoming PR with access to repository secrets, which would let an attacker steal repository secrets. This normally happens by running build scripts (e.g., `npm build` and `make`) or dependency installation scripts (e.g., `python setup.py install`). Audit your workflow file to make sure no code from the incoming PR is executed. Please see https://securitylab.github.com/research/github-actions-preventing-pwn-requests/ for additional mitigations.\nSeverity: WARNING\nCWE: ['CWE-913: Improper Control of Dynamically-Managed Code Resources']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/github-actions/security/pull-request-target-code-checkout.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: workflow-run-target-code-checkout\nPattern:\n...\nuses: \"$ACTION\"\nwith:\n  ...\n  ref: $EXPR\n", "output": "Vulnerability rule: workflow-run-target-code-checkout\nMessage: This GitHub Actions workflow file uses `workflow_run` and checks out code from the incoming pull request. When using `workflow_run`, the Action runs in the context of the target repository, which includes access to all repository secrets. Normally, this is safe because the Action only runs code from the target repository, not the incoming PR. However, by checking out the incoming PR code, you're now using the incoming code for the rest of the action. You may be inadvertently executing arbitrary code from the incoming PR with access to repository secrets, which would let an attacker steal repository secrets. This normally happens by running build scripts (e.g., `npm build` and `make`) or dependency installation scripts (e.g., `python setup.py install`). Audit your workflow file to make sure no code from the incoming PR is executed. Please see https://securitylab.github.com/research/github-actions-preventing-pwn-requests/ for additional mitigations.\nSeverity: WARNING\nCWE: CWE-913: Improper Control of Dynamically-Managed Code Resources\nOWASP: A01:2017 - Injection\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/github-actions/security/workflow-run-target-code-checkout.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: run-shell-injection\nPattern:\nrun: $SHELL", "output": "Vulnerability rule: run-shell-injection\nMessage: Using variable interpolation `${{...}}` with `github` context data in a `run:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/github-actions/security/run-shell-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: github-script-injection\nPattern:\nscript: $SHELL", "output": "Vulnerability rule: github-script-injection\nMessage: Using variable interpolation `${{...}}` with `github` context data in a `actions/github-script`'s `script:` step could allow an attacker to inject their own code into the runner. This would allow them to steal secrets and code. `github` context data can have arbitrary user input and should be treated as untrusted. Instead, use an intermediate environment variable with `env:` to store the data and use the environment variable in the `run:` script. Be sure to use double-quotes the environment variable, like this: \"$ENVVAR\".\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: yaml/github-actions/security/github-script-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: invalid-base-url\nPattern:\nbaseURL = \"...\"", "output": "Vulnerability rule: invalid-base-url\nMessage: The 'baseURL' is invalid. This may cause links to not work if deployed. Include the scheme (e.g., http:// or https://).\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/hugo/best-practice/invalid-base-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: localhost-base-url\nPattern:\nbaseURL = \"...\"", "output": "Vulnerability rule: localhost-base-url\nMessage: The 'baseURL' is set to localhost. This may cause links to not work if deployed.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/hugo/best-practice/localhost-base-url.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-tag\nPattern:\n{{ ... }}", "output": "Vulnerability rule: var-in-script-tag\nMessage: Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI. For Django, you may also consider using the 'json_script' template tag and retrieving the data in your script by using the element ID (e.g., `document.getElementById`).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/html-templates/security/var-in-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-src\nPattern:\n{{ ... }}", "output": "Vulnerability rule: var-in-script-src\nMessage: Detected a template variable used as the 'src' in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent malicious URLs from being injected and could results in a cross-site scripting (XSS) vulnerability. Prefer not to dynamically generate the 'src' attribute and use static URLs instead. If you must do this, carefully check URLs against an allowlist and be sure to URL-encode the result.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/html-templates/security/var-in-script-src.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: unquoted-attribute-var\nPattern:\n{{ ... }}", "output": "Vulnerability rule: unquoted-attribute-var\nMessage: Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: \"{{ expr }}\".\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/html-templates/security/unquoted-attribute-var.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): dockerfile\nSemgrep rule id: missing-zypper-no-confirm-switch\nPattern:\nRUN ... zypper install ...\n", "output": "Vulnerability rule: missing-zypper-no-confirm-switch\nMessage: This 'zypper install' is missing the '-y' switch. This might stall builds because it requires human intervention. Add the '-y' switch.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/dockerfile/missing-zypper-no-confirm-switch.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: copy-from-own-alias\nPattern:\nFROM $IMAGE:$TAG as $REF\n...\nCOPY --from=$REF\n...\nFROM\n", "output": "Vulnerability rule: copy-from-own-alias\nMessage: COPY instructions cannot copy from its own alias. The '$REF' alias is used before switching to a new image. If you meant to switch to a new image, include a new 'FROM' statement. Otherwise, remove the '--from=$REF' from the COPY statement.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/dockerfile/correctness/copy-from-own-alias.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: copy-from-own-alias\nPattern:\nFROM $IMAGE:$TAG AS $REF\n...\nCOPY --from=$REF\n...\nFROM\n", "output": "Vulnerability rule: copy-from-own-alias\nMessage: COPY instructions cannot copy from its own alias. The '$REF' alias is used before switching to a new image. If you meant to switch to a new image, include a new 'FROM' statement. Otherwise, remove the '--from=$REF' from the COPY statement.\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/dockerfile/correctness/copy-from-own-alias.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: missing-yum-clean-all\nPattern:\nyum $COMMAND", "output": "Vulnerability rule: missing-yum-clean-all\nMessage: This yum command does not end with '&& yum clean all'. Running 'yum clean all' will remove cached data and reduce package size. (This must be performed in the same RUN step.)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/dockerfile/best-practice/missing-yum-clean-all.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: bash_reverse_shell\nPattern:\nsh -i >& /dev/udp/.../... 0>&1\n", "output": "Vulnerability rule: bash_reverse_shell\nMessage: Semgrep found a bash reverse shell\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/ci/security/bash-reverse-shell.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: bash_reverse_shell\nPattern:\n<...>/dev/tcp/.../...; sh <&... >&... 2>&\n", "output": "Vulnerability rule: bash_reverse_shell\nMessage: Semgrep found a bash reverse shell\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/ci/security/bash-reverse-shell.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: bash_reverse_shell\nPattern:\n<...>/dev/tcp/.../...; cat <&... | while read line; do $line 2>&... >&...;done\n", "output": "Vulnerability rule: bash_reverse_shell\nMessage: Semgrep found a bash reverse shell\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/ci/security/bash-reverse-shell.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: bash_reverse_shell\nPattern:\nsh -i ...<...> /dev/tcp/.../... ...<&... 1>&... 2>&\n", "output": "Vulnerability rule: bash_reverse_shell\nMessage: Semgrep found a bash reverse shell\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/ci/security/bash-reverse-shell.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-codeclimate\nPattern:\n(?i)codeclima.{0,50}[\"|'|`]?[0-9a-f]{64}[\"|'|`]?", "output": "Vulnerability rule: detected-codeclimate\nMessage: CodeClimate detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-codeclimate.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-outlook-team\nPattern:\nhttps://outlook\\.office\\.com/webhook/[0-9a-f-]{36}", "output": "Vulnerability rule: detected-outlook-team\nMessage: Outlook Team detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-outlook-team.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-sauce-token\nPattern:\n(?i)sauce.{0,50}(\\\\\\\"|'|`)?[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}(\\\\\\\"|'|`)?", "output": "Vulnerability rule: detected-sauce-token\nMessage: Sauce Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-sauce-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-sonarqube-docs-api-key\nPattern:\n(?i)sonar.{0,50}(\\\\\\\"|'|`)?[0-9a-f]{40}(\\\\\\\"|'|`)?", "output": "Vulnerability rule: detected-sonarqube-docs-api-key\nMessage: SonarQube Docs API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-sonarqube-docs-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-heroku-api-key\nPattern:\n[hH][eE][rR][oO][kK][uU].*[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}", "output": "Vulnerability rule: detected-heroku-api-key\nMessage: Heroku API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-heroku-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-bcrypt-hash\nPattern:\n\\$2[aby]?\\$[\\d]+\\$[./A-Za-z0-9]{53}", "output": "Vulnerability rule: detected-bcrypt-hash\nMessage: bcrypt hash detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-bcrypt-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-hockeyapp\nPattern:\n(?i)hockey.{0,50}(\\\\\\\"|'|`)?[0-9a-f]{32}(\\\\\\\"|'|`)?", "output": "Vulnerability rule: detected-hockeyapp\nMessage: HockeyApp detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-hockeyapp.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-amazon-mws-auth-token\nPattern:\namzn\\.mws\\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}", "output": "Vulnerability rule: detected-amazon-mws-auth-token\nMessage: Amazon MWS Auth Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-amazon-mws-auth-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-mailchimp-api-key\nPattern:\n[0-9a-f]{32}-us[0-9]{1,2}", "output": "Vulnerability rule: detected-mailchimp-api-key\nMessage: MailChimp API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-mailchimp-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-snyk-api-key\nPattern:\n(?i)snyk.{0,50}['|\"|`]?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}['\"\\s]?", "output": "Vulnerability rule: detected-snyk-api-key\nMessage: Snyk API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-snyk-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-square-oauth-secret\nPattern:\nsq0csp-[0-9A-Za-z\\\\\\-_]{43}", "output": "Vulnerability rule: detected-square-oauth-secret\nMessage: Square OAuth Secret detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-square-oauth-secret.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-paypal-braintree-access-token\nPattern:\naccess_token\\$production\\$[0-9a-z]{16}\\$[0-9a-z]{32}", "output": "Vulnerability rule: detected-paypal-braintree-access-token\nMessage: PayPal Braintree Access Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-paypal-braintree-access-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-pgp-private-key-block\nPattern:\n-----BEGIN PGP PRIVATE KEY BLOCK-----", "output": "Vulnerability rule: detected-pgp-private-key-block\nMessage: Something that looks like a PGP private key block is detected. This is a potential hardcoded secret that could be leaked if this code is committed. Instead, remove this code block from the commit.\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-pgp-private-key-block.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detected-npm-registry-auth-token\nPattern:\n$AUTHTOKEN = $VALUE", "output": "Vulnerability rule: detected-npm-registry-auth-token\nMessage: NPM registry authentication token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-npm-registry-auth-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-softlayer-api-key\nPattern:\n(?i)softlayer.{0,50}[\"|'|`]?[a-z0-9]{64}[\"|'|`]?", "output": "Vulnerability rule: detected-softlayer-api-key\nMessage: SoftLayer API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-softlayer-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-ssh-password\nPattern:\nsshpass -p\\s*['|\\\\\\\"][^%]", "output": "Vulnerability rule: detected-ssh-password\nMessage: SSH Password detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-ssh-password.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-google-gcm-service-account\nPattern:\n((\"|'|`)?type(\"|'|`)?\\s{0,50}(:|=>|=)\\s{0,50}(\"|'|`)?service_account(\"|'|`)?,?)", "output": "Vulnerability rule: detected-google-gcm-service-account\nMessage: Google (GCM) Service account detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-google-gcm-service-account.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-jwt-token\nPattern:\neyJ[A-Za-z0-9-_=]{14,}\\.[A-Za-z0-9-_=]{13,}\\.?[A-Za-z0-9-_.+/=]*?", "output": "Vulnerability rule: detected-jwt-token\nMessage: JWT token detected\nSeverity: ERROR\nCWE: ['CWE-321: Use of Hard-coded Cryptographic Key']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-jwt-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-kolide-api-key\nPattern:\nk2sk_v[0-9]_[0-9a-zA-Z]{24}", "output": "Vulnerability rule: detected-kolide-api-key\nMessage: Kolide API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-kolide-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-facebook-oauth\nPattern:\n[fF][aA][cC][eE][bB][oO][oO][kK].*[tT][oO][kK][eE][nN].*['|\"]?[0-9a-f]{32}['|\"]?", "output": "Vulnerability rule: detected-facebook-oauth\nMessage: Facebook OAuth detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-facebook-oauth.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-google-oauth-access-token\nPattern:\nya29\\.[0-9A-Za-z\\-_]+", "output": "Vulnerability rule: detected-google-oauth-access-token\nMessage: Google OAuth Access Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-google-oauth-access-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-sendgrid-api-key\nPattern:\nSG\\.[a-zA-Z0-9]{22}\\.[a-zA-Z0-9-]{43}\\b", "output": "Vulnerability rule: detected-sendgrid-api-key\nMessage: SendGrid API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-sendgrid-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-aws-appsync-graphql-key\nPattern:\nda2-[a-z0-9]{26}", "output": "Vulnerability rule: detected-aws-appsync-graphql-key\nMessage: AWS AppSync GraphQL Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-aws-appsync-graphql-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-stripe-api-key\nPattern:\nsk_live_[0-9a-zA-Z]{24}", "output": "Vulnerability rule: detected-stripe-api-key\nMessage: Stripe API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-stripe-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-google-cloud-api-key\nPattern:\nAIza[0-9A-Za-z\\\\-_]{35}", "output": "Vulnerability rule: detected-google-cloud-api-key\nMessage: Google Cloud API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-google-cloud-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: detected-username-and-password-in-uri\nPattern:\n$PROTOCOL://$...USERNAME:$...PASSWORD@$END", "output": "Vulnerability rule: detected-username-and-password-in-uri\nMessage: Username and password in URI detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-username-and-password-in-uri.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-square-access-token\nPattern:\nsq0atp-[0-9A-Za-z\\-_]{22}", "output": "Vulnerability rule: detected-square-access-token\nMessage: Square Access Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-square-access-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-onfido-live-api-token\nPattern:\n(?:api_live(?:_[a-zA-Z]{2})?\\.[a-zA-Z0-9-_]{11}\\.[-_a-zA-Z0-9]{32})", "output": "Vulnerability rule: detected-onfido-live-api-token\nMessage: Onfido live API Token detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-onfido-live-api-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-twilio-api-key\nPattern:\nSK[0-9a-fA-F]{32}", "output": "Vulnerability rule: detected-twilio-api-key\nMessage: Twilio API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-twilio-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-google-oauth-url\nPattern:\n[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com", "output": "Vulnerability rule: detected-google-oauth-url\nMessage: Google OAuth url detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-google-oauth.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-picatic-api-key\nPattern:\nsk_live_[0-9a-z]{32}", "output": "Vulnerability rule: detected-picatic-api-key\nMessage: Picatic API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-picatic-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-mailgun-api-key\nPattern:\nkey-[0-9a-zA-Z]{32}", "output": "Vulnerability rule: detected-mailgun-api-key\nMessage: Mailgun API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-mailgun-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: detected-stripe-restricted-api-key\nPattern:\nrk_live_[0-9a-zA-Z]{24}", "output": "Vulnerability rule: detected-stripe-restricted-api-key\nMessage: Stripe Restricted API Key detected\nSeverity: ERROR\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/secrets/security/detected-stripe-restricted-api-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: csp-header-attribute\nPattern:\n<apex:page...>...</apex:page>", "output": "Vulnerability rule: csp-header-attribute\nMessage: Visualforce Pages must have the cspHeader attribute set to true. This attribute is available in API version 55 or higher.\nSeverity: INFO\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/visualforce/security/ncino/xml/CSPHeaderAttribute.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: build-gradle-password-hardcoded\nPattern:\npassword = env[...] ?: \"$SECRET\"\n", "output": "Vulnerability rule: build-gradle-password-hardcoded\nMessage: A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. It is recommended to rotate the secret and retrieve them from a secure secret vault or Hardware Security Module (HSM), alternatively environment variables can be used if allowed by your company policy.\nSeverity: WARNING\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/gradle/security/build-gradle-password-hardcoded.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: request-host-used\nPattern:\n$http_host", "output": "Vulnerability rule: request-host-used\nMessage: '$http_host' and '$host' variables may contain a malicious value from attacker controlled 'Host' request header. Use an explicitly configured host value or a allow list for validation.\nSeverity: WARNING\nCWE: ['CWE-290: Authentication Bypass by Spoofing']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/request-host-used.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: request-host-used\nPattern:\n$host", "output": "Vulnerability rule: request-host-used\nMessage: '$http_host' and '$host' variables may contain a malicious value from attacker controlled 'Host' request header. Use an explicitly configured host value or a allow list for validation.\nSeverity: WARNING\nCWE: ['CWE-290: Authentication Bypass by Spoofing']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/request-host-used.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: header-redefinition\nPattern:\nadd_header ...;", "output": "Vulnerability rule: header-redefinition\nMessage: The 'add_header' directive is called in a 'location' block after headers have been set at the server block. Calling 'add_header' in the location block will actually overwrite the headers defined in the server block, no matter which headers are set. To fix this, explicitly set all headers or set all headers in the server block.\nSeverity: WARNING\nCWE: ['CWE-16: CWE CATEGORY: Configuration']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/header-redefinition.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: missing-ssl-version\nPattern:\nserver { ... listen $PORT ssl; ... }", "output": "Vulnerability rule: missing-ssl-version\nMessage: This server configuration is missing the 'ssl_protocols' directive. By default, this server will use 'ssl_protocols TLSv1 TLSv1.1 TLSv1.2', and versions older than TLSv1.2 are known to be broken. Explicitly specify 'ssl_protocols TLSv1.2 TLSv1.3' to use secure TLS versions.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/missing-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: header-injection\nPattern:\nlocation ... <$VARIABLE> ... {\n  ...\n  add_header ... $$VARIABLE\n  ...\n}\n", "output": "Vulnerability rule: header-injection\nMessage: The $$VARIABLE path parameter is added as a header in the response. This could allow an attacker to inject a newline and add a new header into the response. This is called HTTP response splitting. To fix, do not allow whitespace in the path parameter: '[^\\s]+'.\nSeverity: ERROR\nCWE: [\"CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request/Response Splitting')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/header-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: dynamic-proxy-scheme\nPattern:\nproxy_pass $$SCHEME:// ...;", "output": "Vulnerability rule: dynamic-proxy-scheme\nMessage: The protocol scheme for this proxy is dynamically determined. This can be dangerous if the scheme can be injected by an attacker because it may forcibly alter the connection scheme. Consider hardcoding a scheme for this proxy.\nSeverity: WARNING\nCWE: ['CWE-16: CWE CATEGORY: Configuration']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/dynamic-proxy-scheme.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: insecure-ssl-version\nPattern:\nssl_protocols ...;", "output": "Vulnerability rule: insecure-ssl-version\nMessage: Detected use of an insecure SSL version. Secure SSL versions are TLSv1.2 and TLS1.3; older versions are known to be broken and are susceptible to attacks. Prefer use of TLSv1.2 or later.\nSeverity: WARNING\nCWE: ['CWE-326: Inadequate Encryption Strength']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/insecure-ssl-version.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: alias-path-traversal\nPattern:\nlocation $...LOCATION {\n  ...\n  alias .../;\n  ...\n}\n", "output": "Vulnerability rule: alias-path-traversal\nMessage: The alias in this location block is subject to a path traversal because the location path does not end in a path separator (e.g., '/'). To fix, add a path separator to the end of the path.\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/alias-path-traversal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: dynamic-proxy-host\nPattern:\nproxy_pass $SCHEME://$$HOST ...;", "output": "Vulnerability rule: dynamic-proxy-host\nMessage: The host for this proxy URL is dynamically determined. This can be dangerous if the host can be injected by an attacker because it may forcibly alter destination of the proxy. Consider hardcoding acceptable destinations and retrieving them with 'map' or something similar.\nSeverity: WARNING\nCWE: [\"CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/dynamic-proxy-host.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: dynamic-proxy-host\nPattern:\nproxy_pass $$SCHEME://$$HOST ...;", "output": "Vulnerability rule: dynamic-proxy-host\nMessage: The host for this proxy URL is dynamically determined. This can be dangerous if the host can be injected by an attacker because it may forcibly alter destination of the proxy. Consider hardcoding acceptable destinations and retrieving them with 'map' or something similar.\nSeverity: WARNING\nCWE: [\"CWE-441: Unintended Proxy or Intermediary ('Confused Deputy')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/dynamic-proxy-host.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: missing-internal\nPattern:\nproxy_pass $...URL;", "output": "Vulnerability rule: missing-internal\nMessage: This location block contains a 'proxy_pass' directive but does not contain the 'internal' directive. The 'internal' directive restricts access to this location to internal requests. Without 'internal', an attacker could use your server for server-side request forgeries (SSRF). Include the 'internal' directive in this block to limit exposure.\nSeverity: WARNING\nCWE: ['CWE-16: CWE CATEGORY: Configuration']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/nginx/security/missing-internal.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: secure-parameter-for-secrets\nPattern:\nparam $NAME string", "output": "Vulnerability rule: secure-parameter-for-secrets\nMessage: Mark sensitive parameters with the @secure() decorator. This avoids logging the value or displaying it in the Azure portal, Azure CLI, or Azure PowerShell.\nSeverity: WARNING\nCWE: ['CWE-532: Insertion of Sensitive Information into Log File']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: generic/bicep/security/secure-parameter-for-secrets.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: use_weak_rsa_encryption_padding\nPattern:\n(RSAPKCS1KeyExchangeFormatter $FORMATER).CreateKeyExchange(...);", "output": "Vulnerability rule: use_weak_rsa_encryption_padding\nMessage: You are using the outdated PKCS#1 v1.5 encryption padding for your RSA key. Use the OAEP padding instead.\nSeverity: WARNING\nCWE: ['CWE-780: Use of RSA Algorithm without OAEP']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/use_weak_rsa_encryption_padding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: use_weak_rsa_encryption_padding\nPattern:\n(RSAPKCS1KeyExchangeDeformatter $DEFORMATER).DecryptKeyExchange(...);", "output": "Vulnerability rule: use_weak_rsa_encryption_padding\nMessage: You are using the outdated PKCS#1 v1.5 encryption padding for your RSA key. Use the OAEP padding instead.\nSeverity: WARNING\nCWE: ['CWE-780: Use of RSA Algorithm without OAEP']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/use_weak_rsa_encryption_padding.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: use_deprecated_cipher_algorithm\nPattern:\n$KEYTYPE.Create(...);", "output": "Vulnerability rule: use_deprecated_cipher_algorithm\nMessage: Usage of deprecated cipher algorithm detected. Use Aes or ChaCha20Poly1305 instead.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/use_deprecated_cipher_algorithm.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: mvc-missing-antiforgery\nPattern:\n[$HTTPMETHOD]\npublic IActionResult $METHOD(...){\n    ...\n}\n", "output": "Vulnerability rule: mvc-missing-antiforgery\nMessage: $METHOD is a state-changing MVC method that does not validate the antiforgery token or do strict content-type checking. State-changing controller methods should either enforce antiforgery tokens or do strict content-type checking to prevent simple HTTP request types from bypassing CORS preflight controls.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/mvc-missing-antiforgery.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: net-webconfig-debug\nPattern:\n<compilation ... debug = \"true\" ... />\n", "output": "Vulnerability rule: net-webconfig-debug\nMessage: ASP.NET applications built with `debug` set to true in production may leak debug information to attackers. Debug mode also affects performance and reliability. Set `debug` to `false` or remove it from `<compilation ... />`\nSeverity: WARNING\nCWE: ['CWE-11: ASP.NET Misconfiguration: Creating Debug Binary']\nOWASP: ['A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/net-webconfig-debug.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: net-webconfig-trace-enabled\nPattern:\n<trace ... enabled = \"true\" ... />\n", "output": "Vulnerability rule: net-webconfig-trace-enabled\nMessage: OWASP guidance recommends disabling tracing for production applications to prevent accidental leakage of sensitive application information.\nSeverity: WARNING\nCWE: ['CWE-1323: Improper Management of Sensitive Trace Data']\nOWASP: A05:2021 - Security Misconfiguration\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/net-webconfig-trace-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: missing-or-broken-authorization\nPattern:\npublic class $CLASS : Controller {\n  ...\n}\n", "output": "Vulnerability rule: missing-or-broken-authorization\nMessage: Anonymous access shouldn't be allowed unless explicit by design. Access control checks are missing and potentially can be bypassed. This finding violates the principle of least privilege or deny by default, where access should only be permitted for a specific set of roles or conforms to a custom policy or users.\nSeverity: INFO\nCWE: ['CWE-862: Missing Authorization']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/dotnet/security/audit/missing-or-broken-authorization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: stacktrace-disclosure\nPattern:\n$APP.UseDeveloperExceptionPage(...);", "output": "Vulnerability rule: stacktrace-disclosure\nMessage: Stacktrace information is displayed in a non-Development environment. Accidentally disclosing sensitive stack trace information in a production environment aids an attacker in reconnaissance and information gathering.\nSeverity: WARNING\nCWE: ['CWE-209: Generation of Error Message Containing Sensitive Information']\nOWASP: ['A06:2017 - Security Misconfiguration', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/stacktrace-disclosure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: memory-marshal-create-span\nPattern:\nMemoryMarshal.CreateSpan(...)", "output": "Vulnerability rule: memory-marshal-create-span\nMessage: MemoryMarshal.CreateSpan and MemoryMarshal.CreateReadOnlySpan should be used with caution, as the length argument is not checked.\nSeverity: WARNING\nCWE: ['CWE-125: Out-of-bounds Read']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/memory/memory-marshal-create-span.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: memory-marshal-create-span\nPattern:\nMemoryMarshal.CreateReadOnlySpan(...)", "output": "Vulnerability rule: memory-marshal-create-span\nMessage: MemoryMarshal.CreateSpan and MemoryMarshal.CreateReadOnlySpan should be used with caution, as the length argument is not checked.\nSeverity: WARNING\nCWE: ['CWE-125: Out-of-bounds Read']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/memory/memory-marshal-create-span.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: X509Certificate2-privkey\nPattern:\n$CERT.PrivateKey", "output": "Vulnerability rule: X509Certificate2-privkey\nMessage: X509Certificate2.PrivateKey is obsolete. Use a method such as GetRSAPrivateKey() or GetECDsaPrivateKey(). Alternatively, use the CopyWithPrivateKey() method to create a new instance with a private key. Further, if you set X509Certificate2.PrivateKey to `null` or set it to another key without deleting it first, the private key will be left on disk. \nSeverity: WARNING\nCWE: ['CWE-310: CWE CATEGORY: Cryptographic Issues']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/cryptography/X509Certificate2-privkey.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: unsigned-security-token\nPattern:\nRequireSignedTokens = false", "output": "Vulnerability rule: unsigned-security-token\nMessage: Accepting unsigned security tokens as valid security tokens allows an attacker to remove its signature and potentially forge an identity. As a fix, set RequireSignedTokens to be true.\nSeverity: ERROR\nCWE: ['CWE-347: Improper Verification of Cryptographic Signature']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/cryptography/unsigned-security-token.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-losformatter-deserialization\nPattern:\nnew LosFormatter();\n", "output": "Vulnerability rule: insecure-losformatter-deserialization\nMessage: The LosFormatter type is dangerous and is not recommended for data processing. Applications should stop using LosFormatter as soon as possible, even if they believe the data they're processing to be trustworthy. LosFormatter is insecure and can't be made secure\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/los-formatter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-binaryformatter-deserialization\nPattern:\nnew BinaryFormatter();\n", "output": "Vulnerability rule: insecure-binaryformatter-deserialization\nMessage: The BinaryFormatter type is dangerous and is not recommended for data processing. Applications should stop using BinaryFormatter as soon as possible, even if they believe the data they're processing to be trustworthy. BinaryFormatter is insecure and can't be made secure\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/binary-formatter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-fspickler-deserialization\nPattern:\nFsPickler.CreateJsonSerializer();\n", "output": "Vulnerability rule: insecure-fspickler-deserialization\nMessage: The FsPickler is dangerous and is not recommended for data processing. Default configuration tend to insecure deserialization vulnerability.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/fs-pickler.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-netdatacontract-deserialization\nPattern:\nnew NetDataContractSerializer();\n", "output": "Vulnerability rule: insecure-netdatacontract-deserialization\nMessage: The NetDataContractSerializer type is dangerous and is not recommended for data processing. Applications should stop using NetDataContractSerializer as soon as possible, even if they believe the data they're processing to be trustworthy. NetDataContractSerializer is insecure and can't be made secure\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/net-data-contract.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-fastjson-deserialization\nPattern:\nnew JSONParameters\n{\n  BadListTypeChecking = false\n}\n", "output": "Vulnerability rule: insecure-fastjson-deserialization\nMessage: $type extension has the potential to be unsafe, so use it with common sense and known json sources and not public facing ones to be safe\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/fast-json.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-javascriptserializer-deserialization\nPattern:\nnew JavaScriptSerializer((SimpleTypeResolver $RESOLVER))\n", "output": "Vulnerability rule: insecure-javascriptserializer-deserialization\nMessage: The SimpleTypeResolver class is insecure and should not be used. Using SimpleTypeResolver to deserialize JSON could allow the remote client to execute malicious code within the app and take control of the web server.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/javascript-serializer.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: data-contract-resolver\nPattern:\nclass $MYDCR : DataContractResolver { ... }\n", "output": "Vulnerability rule: data-contract-resolver\nMessage: Only use DataContractResolver if you are completely sure of what information is being serialized. Malicious types can cause unexpected behavior.\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/data-contract-resolver.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: insecure-soapformatter-deserialization\nPattern:\nnew SoapFormatter();\n", "output": "Vulnerability rule: insecure-soapformatter-deserialization\nMessage: The SoapFormatter type is dangerous and is not recommended for data processing. Applications should stop using SoapFormatter as soon as possible, even if they believe the data they're processing to be trustworthy. SoapFormatter is insecure and can't be made secure\nSeverity: WARNING\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/insecure-deserialization/soap-formatter.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): C#\nSemgrep rule id: http-listener-wildcard-bindings\nPattern:\n$LISTENER.Prefixes.Add(\"$PREFIX\")", "output": "Vulnerability rule: http-listener-wildcard-bindings\nMessage: The top level wildcard bindings $PREFIX leaves your application open to security vulnerabilities and give attackers more control over where traffic is routed. If you must use wildcards, consider using subdomain wildcard binding. For example, you can use \"*.asdf.gov\" if you own all of \"asdf.gov\".\nSeverity: WARNING\nCWE: ['CWE-706: Use of Incorrectly-Resolved Name or Reference']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/security/http/http-listener-wildcard-bindings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): csharp\nSemgrep rule id: correctness-double-epsilon-equality\nPattern:\n$V1 - $V2\n", "output": "Vulnerability rule: correctness-double-epsilon-equality\nMessage: Double.Epsilon is defined by .NET as the smallest value that can be added to or subtracted from a zero-value Double. It is unsuitable for equality comparisons of non-zero Double values. Furthermore, the value of Double.Epsilon is framework and processor architecture dependent. Wherever possible, developers should prefer the framework Equals() method over custom equality implementations.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: csharp/lang/correctness/double/double-epsilon-equality.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: wkhtmltopdf-injection\nPattern:\n$WK($INPUT,...)", "output": "Vulnerability rule: wkhtmltopdf-injection\nMessage: If unverified user data can reach the `wkhtmltopdf` it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/wkhtmltopdf/security/audit/wkhtmltopdf-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: puppeteer-setcontent-injection\nPattern:\n$PAGE.setContent($INPUT,...)", "output": "Vulnerability rule: puppeteer-setcontent-injection\nMessage: If unverified user data can reach the `setContent` method it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/puppeteer/security/audit/puppeteer-setcontent-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: puppeteer-goto-injection\nPattern:\n$PAGE.goto($INPUT,...)", "output": "Vulnerability rule: puppeteer-goto-injection\nMessage: If unverified user data can reach the `goto` method it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/puppeteer/security/audit/puppeteer-goto-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: grpc-nodejs-insecure-connection\nPattern:\nrequire('grpc');\n...\n$GRPC($ADDR,...,$CREDENTIALS.createInsecure(),...);\n", "output": "Vulnerability rule: grpc-nodejs-insecure-connection\nMessage: Found an insecure gRPC connection. This creates a connection without encryption to a gRPC client/server. A malicious attacker could tamper with the gRPC message, which could compromise the machine.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/grpc/security/grpc-nodejs-insecure-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: grpc-nodejs-insecure-connection\nPattern:\nrequire('grpc');\n...\nnew $GRPC($ADDR,...,$CREDENTIALS.createInsecure(),...);\n", "output": "Vulnerability rule: grpc-nodejs-insecure-connection\nMessage: Found an insecure gRPC connection. This creates a connection without encryption to a gRPC client/server. A malicious attacker could tamper with the gRPC message, which could compromise the machine.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/grpc/security/grpc-nodejs-insecure-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: grpc-nodejs-insecure-connection\nPattern:\nrequire('grpc');\n...\n$CREDS = <... $CREDENTIALS.createInsecure() ...>;\n...\n$GRPC($ADDR,...,$CREDS,...);", "output": "Vulnerability rule: grpc-nodejs-insecure-connection\nMessage: Found an insecure gRPC connection. This creates a connection without encryption to a gRPC client/server. A malicious attacker could tamper with the gRPC message, which could compromise the machine.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/grpc/security/grpc-nodejs-insecure-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: grpc-nodejs-insecure-connection\nPattern:\nrequire('grpc');\n...\n$CREDS = <... $CREDENTIALS.createInsecure() ...>;\n...\nnew $GRPC($ADDR,...,$CREDS,...);", "output": "Vulnerability rule: grpc-nodejs-insecure-connection\nMessage: Found an insecure gRPC connection. This creates a connection without encryption to a gRPC client/server. A malicious attacker could tamper with the gRPC message, which could compromise the machine.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/grpc/security/grpc-nodejs-insecure-connection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-default-name\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-default-name\nMessage: Dont use the default session cookie name Using the default session cookie name can open your app to attacks. The security issue posed is similar to X-Powered-By: a potential attacker can use it to fingerprint the server and target attacks accordingly.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-no-secure\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-no-secure\nMessage: Default session middleware settings: `secure` not set. It ensures the browser only sends the cookie over HTTPS.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-no-httponly\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-no-httponly\nMessage: Default session middleware settings: `httpOnly` not set. It ensures the cookie is sent only over HTTP(S), not client JavaScript, helping to protect against cross-site scripting attacks.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-no-domain\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-no-domain\nMessage: Default session middleware settings: `domain` not set. It indicates the domain of the cookie; use it to compare against the domain of the server in which the URL is being requested. If they match, then check the path attribute next.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-no-path\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-no-path\nMessage: Default session middleware settings: `path` not set. It indicates the path of the cookie; use it to compare against the request path. If this and domain match, then send the cookie in the request.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-cookie-session-no-expires\nPattern:\n$SESSION(...)", "output": "Vulnerability rule: express-cookie-session-no-expires\nMessage: Default session middleware settings: `expires` not set. Use it to set expiration date for persistent cookies.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-cookie-settings.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: unknown-value-in-redirect\nPattern:\n$RES.redirect(..., <... $UNK ...>, ...)", "output": "Vulnerability rule: unknown-value-in-redirect\nMessage: It looks like '$UNK' is read from user input and it is used to as a redirect. Ensure '$UNK' is not externally controlled, otherwise this is an open redirect.\nSeverity: WARNING\nCWE: [\"CWE-601: URL Redirection to Untrusted Site ('Open Redirect')\"]\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/possible-user-input-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-check-csurf-middleware-usage\nPattern:\n$APP = $EXPRESS()\n", "output": "Vulnerability rule: express-check-csurf-middleware-usage\nMessage: A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.\nSeverity: INFO\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-check-csurf-middleware-usage.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: express-jwt-not-revoked\nPattern:\n$JWT(...)", "output": "Vulnerability rule: express-jwt-not-revoked\nMessage: No token revoking configured for `express-jwt`. A leaked token could still be used and unable to be revoked. Consider using function as the `isRevoked` option.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/express-jwt-not-revoked.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: var-in-href\nPattern:\na\\(.*href=[^'\"].*\\)", "output": "Vulnerability rule: var-in-href\nMessage: Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: a(href='/'+url). You may also consider setting the Content Security Policy (CSP) header.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/pug/var-in-href.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-and-attributes\nPattern:\n.*&attributes.*", "output": "Vulnerability rule: template-and-attributes\nMessage: Detected a unescaped variables using '&attributes'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/pug/and-attributes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-tag\nPattern:\n<% ... >", "output": "Vulnerability rule: var-in-script-tag\nMessage: Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/ejs/var-in-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: var-in-href\nPattern:\n<a.*href\\s*=[^>]*?[^\\/&=]<%.*?%>.*?>", "output": "Vulnerability rule: var-in-href\nMessage: Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: href='/<%= link %>'. You may also consider setting the Content Security Policy (CSP) header.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/ejs/var-in-href.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-src\nPattern:\n<% ... >", "output": "Vulnerability rule: var-in-script-src\nMessage: Detected a template variable used as the 'src' in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent malicious URLs from being injected and could results in a cross-site scripting (XSS) vulnerability. Prefer not to dynamically generate the 'src' attribute and use static URLs instead. If you must do this, carefully check URLs against an allowlist and be sure to URL-encode the result.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/ejs/var-in-script-src.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: template-explicit-unescape\nPattern:\n<%-((?!include).)*?%>", "output": "Vulnerability rule: template-explicit-unescape\nMessage: Detected an explicit unescape in an EJS template, using '<%- ... %>' If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. Use '<%= ... %>' to escape this data. If you need escaping, ensure no external data can reach this location.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/ejs/explicit-unescape.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-tag\nPattern:\n{{ ... }}", "output": "Vulnerability rule: var-in-script-tag\nMessage: Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need this data on the rendered page, consider placing it in the HTML portion (outside of a script tag). Alternatively, use a JavaScript-specific encoder, such as the one available in OWASP ESAPI.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/mustache/var-in-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: escape-function-overwrite\nPattern:\nMustache.escape = ...", "output": "Vulnerability rule: escape-function-overwrite\nMessage: The Mustache escape function is being overwritten. This could bypass HTML escaping safety measures built into the rendering engine, exposing your application to cross-site scripting (XSS) vulnerabilities. If you need unescaped HTML, use the triple brace operator in your template: '{{{ ... }}}'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/express/security/audit/xss/mustache/escape-function-overwrite.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sax-xxe\nPattern:\nrequire('sax');\n...\n$PARSER.ondoctype = ...;\n", "output": "Vulnerability rule: sax-xxe\nMessage: Use of 'ondoctype' in 'sax' library detected. By default, 'sax' won't do anything with custom DTD entity definitions. If you're implementing a custom DTD entity definition, be sure not to introduce XML External Entity (XXE) vulnerabilities, or be absolutely sure that external entities received from a trusted source while processing XML.\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sax/security/audit/sax-xxe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sax-xxe\nPattern:\nrequire('sax');\n...\n$PARSER.on('doctype',...);", "output": "Vulnerability rule: sax-xxe\nMessage: Use of 'ondoctype' in 'sax' library detected. By default, 'sax' won't do anything with custom DTD entity definitions. If you're implementing a custom DTD entity definition, be sure not to introduce XML External Entity (XXE) vulnerabilities, or be absolutely sure that external entities received from a trusted source while processing XML.\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sax/security/audit/sax-xxe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: unsafe-serialize-javascript\nPattern:\n$S(..., {unsafe: true});\n", "output": "Vulnerability rule: unsafe-serialize-javascript\nMessage: `serialize-javascript` used with `unsafe` parameter, this could be vulnerable to XSS.\nSeverity: WARNING\nCWE: ['CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/serialize-javascript/security/audit/unsafe-serialize-javascript.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): regex\nSemgrep rule id: avoid-v-html\nPattern:\n<[^<>]*v-html=", "output": "Vulnerability rule: avoid-v-html\nMessage: Dynamically rendering arbitrary HTML on your website can be very dangerous because it can easily lead to XSS vulnerabilities. Only use HTML interpolation on trusted content and never on user-provided content.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/vue/security/audit/xss/templates/avoid-v-html.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-none-alg\nPattern:\n$JWT.verify($P, $X, {algorithms:[...,'none',...]},...)", "output": "Vulnerability rule: jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jsonwebtoken/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-decode-without-verify\nPattern:\n$JWT.decode($TOKEN, ...)", "output": "Vulnerability rule: jwt-decode-without-verify\nMessage: Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims. Call '.verify()' before using the token.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jsonwebtoken/security/audit/jwt-decode-without-verify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-exposed-data\nPattern:\n$JWT.sign($INPUT,...)", "output": "Vulnerability rule: jwt-exposed-data\nMessage: The object is passed strictly to jsonwebtoken.sign(...) Make sure that sensitive information is not exposed through JWT token payload.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jsonwebtoken/security/audit/jwt-exposed-data.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: prohibit-jquery-html\nPattern:\n$X.html(...)\n", "output": "Vulnerability rule: prohibit-jquery-html\nMessage: JQuery's `html` function is susceptible to Cross Site Scripting (XSS) attacks. If you're just passing text, consider `text` instead. Otherwise, use a function that escapes HTML such as edX's `HtmlUtils.setHtml()`.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jquery/security/audit/prohibit-jquery-html.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: shelljs-exec-injection\nPattern:\n$SHELL.exec($INPUT,...)", "output": "Vulnerability rule: shelljs-exec-injection\nMessage: If unverified user data can reach the `exec` method it can result in Remote Code Execution\nSeverity: ERROR\nCWE: [\"CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/shelljs/security/shelljs-exec-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-angular-resource-loading\nPattern:\n$sceDelegateProvider.resourceUrlWhitelist([...,'**',...]);\n", "output": "Vulnerability rule: detect-angular-resource-loading\nMessage: $sceDelegateProvider allowlisting can introduce security issues if wildcards are used.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/angular/security/detect-angular-resource-loading.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript\nSemgrep rule id: detect-angular-translateprovider-translations-method\nPattern:\n$translateProvider.translations(...,$SOURCE);\n", "output": "Vulnerability rule: detect-angular-translateprovider-translations-method\nMessage: The use of $translateProvider.translations method can be dangerous if user input is provided to this API.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/angular/security/detect-third-party-angular-translate.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-angular-sce-disabled\nPattern:\n$sceProvider.enabled(false);\n", "output": "Vulnerability rule: detect-angular-sce-disabled\nMessage: $sceProvider is set to false. Disabling Strict Contextual escaping (SCE) in an AngularJS application could provide additional attack surface for XSS vulnerabilities.\nSeverity: ERROR\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/angular/security/detect-angular-sce-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-angular-open-redirect\nPattern:\n$window.location.href = ...\n", "output": "Vulnerability rule: detect-angular-open-redirect\nMessage: Use of $window.location.href can lead to open-redirect if user input is used for redirection.\nSeverity: ERROR\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/angular/security/detect-angular-open-redirect.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-simple-noverify\nPattern:\n$JWT.decode($TOKEN, $SECRET, $NOVERIFY, ...)", "output": "Vulnerability rule: jwt-simple-noverify\nMessage: Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims. Set 'verify' to `true` before using the token.\nSeverity: ERROR\nCWE: ['CWE-287: Improper Authentication', 'CWE-345: Insufficient Verification of Data Authenticity', 'CWE-347: Improper Verification of Cryptographic Signature']\nOWASP: ['A05:2021 - Security Misconfiguration', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jwt-simple/security/jwt-simple-noverify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: playwright-setcontent-injection\nPattern:\n$PAGE.setContent($INPUT,...)", "output": "Vulnerability rule: playwright-setcontent-injection\nMessage: If unverified user data can reach the `setContent` method it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/playwright/security/audit/playwright-setcontent-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: playwright-addinitscript-code-injection\nPattern:\n$CONTEXT.addInitScript($INPUT,...)", "output": "Vulnerability rule: playwright-addinitscript-code-injection\nMessage: If unverified user data can reach the `addInitScript` method it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/playwright/security/audit/playwright-addinitscript-code-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: playwright-goto-injection\nPattern:\n$PAGE.goto($INPUT,...)", "output": "Vulnerability rule: playwright-goto-injection\nMessage: If unverified user data can reach the `goto` method it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/playwright/security/audit/playwright-goto-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-none-alg\nPattern:\nvar $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\nvar $T = JWT.verify($P, JWK.None,...);\n", "output": "Vulnerability rule: jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jose/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-none-alg\nPattern:\nvar $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\n$T = JWT.verify($P, JWK.None,...);\n", "output": "Vulnerability rule: jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jose/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: jwt-none-alg\nPattern:\nvar $JOSE = require(\"jose\");\n...\nvar { JWK, JWT } = $JOSE;\n...\nJWT.verify($P, JWK.None,...);\n", "output": "Vulnerability rule: jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/jose/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-buffer-noassert\nPattern:\n$OBJ.$API(..., true)", "output": "Vulnerability rule: detect-buffer-noassert\nMessage: Detected usage of noassert in Buffer API, which allows the offset the be beyond the end of the buffer. This could result in writing or reading beyond the end of the buffer.\nSeverity: WARNING\nCWE: ['CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/detect-buffer-noassert.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-no-csrf-before-method-override\nPattern:\nexpress.csrf();\n...\nexpress.methodOverride();\n", "output": "Vulnerability rule: detect-no-csrf-before-method-override\nMessage: Detected use of express.csrf() middleware before express.methodOverride(). This can allow GET requests (which are not checked by csrf) to turn into POST requests later.\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control', 'A05:2017 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/detect-no-csrf-before-method-override.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-disable-mustache-escape\nPattern:\n$OBJ.escapeMarkup = false", "output": "Vulnerability rule: detect-disable-mustache-escape\nMessage: Markup escaping disabled. This can be used with some template engines to escape disabling of HTML entities, which can lead to XSS attacks.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/detect-disable-mustache-escape.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: detect-pseudoRandomBytes\nPattern:\ncrypto.pseudoRandomBytes", "output": "Vulnerability rule: detect-pseudoRandomBytes\nMessage: Detected usage of crypto.pseudoRandomBytes, which does not produce secure random numbers.\nSeverity: WARNING\nCWE: ['CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/detect-pseudoRandomBytes.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: hardcoded-hmac-key\nPattern:\n$CRYPTO.createHmac($ALGO, '...')", "output": "Vulnerability rule: hardcoded-hmac-key\nMessage: Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such as reading the secret from a config file or using an environment variable.\nSeverity: WARNING\nCWE: ['CWE-798: Use of Hard-coded Credentials']\nOWASP: ['A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/audit/hardcoded-hmac-key.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: unknown-value-with-script-tag\nPattern:\n$OTHERFUNC(..., <... \"=~/.*<script.*/\" ...>, ...)", "output": "Vulnerability rule: unknown-value-with-script-tag\nMessage: Cannot determine what '$UNK' is and it is used with a '<script>' tag. This could be susceptible to cross-site scripting (XSS). Ensure '$UNK' is not externally controlled, or sanitize this data.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/audit/unknown-value-with-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: unknown-value-with-script-tag\nPattern:\n$UNK", "output": "Vulnerability rule: unknown-value-with-script-tag\nMessage: Cannot determine what '$UNK' is and it is used with a '<script>' tag. This could be susceptible to cross-site scripting (XSS). Ensure '$UNK' is not externally controlled, or sanitize this data.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/audit/unknown-value-with-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: incomplete-sanitization\nPattern:\n$STR.replace(($CHAR: string), ...)\n", "output": "Vulnerability rule: incomplete-sanitization\nMessage: `$STR.replace` method will only replace the first occurrence when used with a string argument ($CHAR). If this method is used for escaping of dangerous data then there is a possibility for a bypass. Try to use sanitization library instead or use a Regex with a global flag.\nSeverity: WARNING\nCWE: ['CWE-116: Improper Encoding or Escaping of Output']\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/audit/incomplete-sanitization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: prototype-pollution-assignment\nPattern:\n$X[$B] = ...\n", "output": "Vulnerability rule: prototype-pollution-assignment\nMessage: Possibility of prototype polluting assignment detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.\nSeverity: WARNING\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/security/audit/prototype-pollution/prototype-pollution-assignment.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: missing-template-string-indicator\nPattern:\n$STR", "output": "Vulnerability rule: missing-template-string-indicator\nMessage: This looks like a JavaScript template string. Are you missing a '$' in front of '{...}'?\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/correctness/missing-template-string-indicator.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: useless-assignment\nPattern:\n$X = $Y;\n$X = $Z;\n", "output": "Vulnerability rule: useless-assignment\nMessage: `$X` is assigned twice; the first assignment is useless\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/correctness/useless-assign.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: no-replaceall\nPattern:\n$STRING.replaceAll(\"...\",$NEW)", "output": "Vulnerability rule: no-replaceall\nMessage: The string method replaceAll is not supported in all versions of javascript, and is not supported by older browser versions. Consider using replace() with a regex as the first argument instead like mystring.replace(/bad/g, \"good\") instead of mystring.replaceAll(\"bad\", \"good\") (https://discourse.threejs.org/t/replaceall-is-not-a-function/14585)\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/correctness/no-replaceall.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: assigned-undefined\nPattern:\nundefined = $X;", "output": "Vulnerability rule: assigned-undefined\nMessage: `undefined` is not a reserved keyword in Javascript, so this is \"valid\" Javascript but highly confusing and likely to result in bugs.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/assigned-undefined.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: assigned-undefined\nPattern:\nvar undefined = $X;", "output": "Vulnerability rule: assigned-undefined\nMessage: `undefined` is not a reserved keyword in Javascript, so this is \"valid\" Javascript but highly confusing and likely to result in bugs.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/assigned-undefined.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: assigned-undefined\nPattern:\nlet undefined = $X;", "output": "Vulnerability rule: assigned-undefined\nMessage: `undefined` is not a reserved keyword in Javascript, so this is \"valid\" Javascript but highly confusing and likely to result in bugs.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/assigned-undefined.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: assigned-undefined\nPattern:\nconst undefined = $X;", "output": "Vulnerability rule: assigned-undefined\nMessage: `undefined` is not a reserved keyword in Javascript, so this is \"valid\" Javascript but highly confusing and likely to result in bugs.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/assigned-undefined.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: lazy-load-module\nPattern:\nrequire(...)", "output": "Vulnerability rule: lazy-load-module\nMessage: Lazy loading can complicate code bundling if care is not taken, also `require`s are run synchronously by Node.js. If they are called from within a function, it may block other requests from being handled at a more critical time. The best practice is to `require` modules at the beginning of each file, before and outside of any functions.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/lazy-load-module.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: zlib-async-loop\nPattern:\nzlib.$METHOD(...);", "output": "Vulnerability rule: zlib-async-loop\nMessage: Creating and using a large number of zlib objects simultaneously can cause significant memory fragmentation. It is strongly recommended that the results of compression operations be cached or made synchronous to avoid duplication of effort.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/zlib-async-loop.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-alert\nPattern:\nalert()", "output": "Vulnerability rule: javascript-alert\nMessage: found alert() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-alert\nPattern:\nalert($X)", "output": "Vulnerability rule: javascript-alert\nMessage: found alert() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-debugger\nPattern:\ndebugger;", "output": "Vulnerability rule: javascript-debugger\nMessage: found debugger call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-confirm\nPattern:\nconfirm(...)", "output": "Vulnerability rule: javascript-confirm\nMessage: found confirm() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-prompt\nPattern:\nprompt()", "output": "Vulnerability rule: javascript-prompt\nMessage: found prompt() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-prompt\nPattern:\nprompt($X)", "output": "Vulnerability rule: javascript-prompt\nMessage: found prompt() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: javascript-prompt\nPattern:\nprompt($X, $Y)", "output": "Vulnerability rule: javascript-prompt\nMessage: found prompt() call; should this be in production code?\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/lang/best-practice/leftover_debugging.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: insecure-innerhtml\nPattern:\n$EL.innerHTML = $HTML;\n", "output": "Vulnerability rule: insecure-innerhtml\nMessage: User controlled data in a `$EL.innerHTML` is an anti-pattern that can lead to XSS vulnerabilities\nSeverity: ERROR\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/browser/security/insecure-innerhtml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: wildcard-postmessage-configuration\nPattern:\n$OBJECT.postMessage(...,'*',...)", "output": "Vulnerability rule: wildcard-postmessage-configuration\nMessage: The target origin of the window.postMessage() API is set to \"*\". This could allow for information disclosure due to the possibility of any origin allowed to receive the message.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/browser/security/wildcard-postmessage-configuration.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: dom-based-xss\nPattern:\ndocument.write(<... document.location.$W ...>)", "output": "Vulnerability rule: dom-based-xss\nMessage: Detected possible DOM-based XSS. This occurs because a portion of the URL is being used to construct an element added directly to the page. For example, a malicious actor could send someone a link like this: http://www.some.site/page.html?default=<script>alert(document.cookie)</script> which would add the script to the page. Consider allowlisting appropriate values or using an approach which does not involve the URL.\nSeverity: ERROR\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/browser/security/dom-based-xss.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: dom-based-xss\nPattern:\ndocument.write(<... location.$W ...>)", "output": "Vulnerability rule: dom-based-xss\nMessage: Detected possible DOM-based XSS. This occurs because a portion of the URL is being used to construct an element added directly to the page. For example, a malicious actor could send someone a link like this: http://www.some.site/page.html?default=<script>alert(document.cookie)</script> which would add the script to the page. Consider allowlisting appropriate values or using an approach which does not involve the URL.\nSeverity: ERROR\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/browser/security/dom-based-xss.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: eval-detected\nPattern:\neval(...)", "output": "Vulnerability rule: eval-detected\nMessage: Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.\nSeverity: WARNING\nCWE: [\"CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/browser/security/eval-detected.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript\nSemgrep rule id: apollo-axios-ssrf\nPattern:\nconst $RESPONSE = await axios.request($INNERARG,...)", "output": "Vulnerability rule: apollo-axios-ssrf\nMessage: User-controllable argument $DATAVAL to $METHOD passed to Axios via internal handler $INNERFUNC. This could be a server-side request forgery. A user could call a restricted API or leak internal headers to an unauthorized party. Validate your user arguments against an allowlist of known URLs, or consider refactoring so that user-controlled data is not necessary.\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/apollo/security/apollo-axios-ssrf.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-enforce-tls\nPattern:\n{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT\n }\n", "output": "Vulnerability rule: sequelize-enforce-tls\nMessage: If TLS is disabled on server side (Postgresql server), Sequelize establishes connection without TLS and no error will be thrown. To prevent MITN (Man In The Middle) attack, TLS must be enforce by Sequelize. Set \"ssl: true\" or define settings \"ssl: {...}\"\nSeverity: WARNING\nCWE: ['CWE-319: Cleartext Transmission of Sensitive Information']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-enforce-tls.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-tls-disabled-cert-validation\nPattern:\n{\n  host: $HOST,\n  database: $DATABASE,\n  dialect: $DIALECT,\n  dialectOptions: {\n    ssl: {\n      rejectUnauthorized: false\n    }\n  }\n }\n", "output": "Vulnerability rule: sequelize-tls-disabled-cert-validation\nMessage: Set \"rejectUnauthorized\" to false is a convenient way to resolve certificate error. But this method is unsafe because it disables the server certificate verification, making the Node app open to MITM attack. \"rejectUnauthorized\" option must be alway set to True (default value). With self -signed certificate or custom CA, use \"ca\" option to define Root Certificate. This rule checks TLS configuration only for Postgresql, MariaDB and MySQL. SQLite is not really concerned by TLS configuration. This rule could be extended for MSSQL, but the dialectOptions is specific for Tedious.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-tls-disabled-cert-validation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$DATABASE.sequelize.query(`...${...}...`, ...)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$QUERY = `...${...}...`\n...\n$DATABASE.sequelize.query($QUERY, ...)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$DATABASE.sequelize.query($SQL + $VALUE, ...)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$QUERY = $SQL + $VALUE\n...\n$DATABASE.sequelize.query($QUERY, ...)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\nSequelize.literal(`...${...}...`)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$QUERY = `...${...}...`\n...\nSequelize.literal($QUERY)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\nSequelize.literal($SQL + $VALUE)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: sequelize-raw-query\nPattern:\n$QUERY = $SQL + $VALUE\n...\nSequelize.literal($QUERY)\n", "output": "Vulnerability rule: sequelize-raw-query\nMessage: Avoiding SQL string concatenation: untrusted input concatenated with raw SQL query can result in SQL Injection. Data replacement or data binding should be used. See https://sequelize.org/master/manual/raw-queries.html\nSeverity: WARNING\nCWE: [\"CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\"]\nOWASP: ['A01:2017 - Injection', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/sequelize/security/audit/sequelize-raw-query.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: xml2json-xxe\nPattern:\nvar $XML = require('xml2json');\n...\n$XML.toJson(...);\n", "output": "Vulnerability rule: xml2json-xxe\nMessage: If unverified user data can reach the XML Parser it can result in XML External or Internal Entity (XXE) Processing vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/xml2json/security/audit/xml2json-xxe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: wkhtmltoimage-injection\nPattern:\n$WK.generate($INPUT,...)", "output": "Vulnerability rule: wkhtmltoimage-injection\nMessage: If unverified user data can reach the `wkhtmltoimage` it can result in Server-Side Request Forgery vulnerabilities\nSeverity: WARNING\nCWE: ['CWE-918: Server-Side Request Forgery (SSRF)']\nOWASP: ['A10:2021 - Server-Side Request Forgery (SSRF)']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/wkhtmltoimage/security/audit/wkhtmltoimage-injection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript\nSemgrep rule id: calling-set-state-on-current-state\nPattern:\n$Y($X);", "output": "Vulnerability rule: calling-set-state-on-current-state\nMessage: Calling setState on the current state is always a no-op. Did you mean to change the state like $Y(!$X) instead?\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/react/correctness/hooks/set-state-no-op.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: ajv-allerrors-true\nPattern:\nnew Ajv({...,allErrors: true,...},...)\n", "output": "Vulnerability rule: ajv-allerrors-true\nMessage: By setting `allErrors: true` in `Ajv` library, all error objects will be allocated without limit. This allows the attacker to produce a huge number of errors which can lead to denial of service. Do not use `allErrors: true` in production.\nSeverity: WARNING\nCWE: ['CWE-400: Uncontrolled Resource Consumption']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/ajv/security/audit/ajv-allerrors-true.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: aead-no-final\nPattern:\n$DECIPHER = $CRYPTO.createDecipheriv('$ALGO', ...)\n...\n$DECIPHER.update(...)\n", "output": "Vulnerability rule: aead-no-final\nMessage: The 'final' call of a Decipher object checks the authentication tag in a mode for authenticated encryption. Failing to call 'final' will invalidate all integrity guarantees of the released ciphertext.\nSeverity: ERROR\nCWE: ['CWE-310: CWE CATEGORY: Cryptographic Issues']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/node-crypto/security/aead-no-final.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: gcm-no-tag-length\nPattern:\n$CRYPTO.createDecipheriv('$ALGO', $KEY, $IV)\n", "output": "Vulnerability rule: gcm-no-tag-length\nMessage: The call to 'createDecipheriv' with the Galois Counter Mode (GCM) mode of operation is missing an expected authentication tag length. If the expected authentication tag length is not specified or otherwise checked, the application might be tricked into verifying a shorter-than-expected authentication tag. This can be abused by an attacker to spoof ciphertexts or recover the implicit authentication key of GCM, allowing arbitrary forgeries.\nSeverity: ERROR\nCWE: ['CWE-310: CWE CATEGORY: Cryptographic Issues']\nOWASP: ['A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: javascript/node-crypto/security/gcm-no-tag-length.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: bypass-tls-verification\nPattern:\nprocess.env[\"NODE_TLS_REJECT_UNAUTHORIZED\"] = 0;\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: bypass-tls-verification\nPattern:\n{rejectUnauthorized:false}\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: disallow-old-tls-versions2\nPattern:\n$OPTIONS = {};\n...\n$HTTPS.createServer($OPTIONS, ...);\n", "output": "Vulnerability rule: disallow-old-tls-versions2\nMessage: Detects creations of $HTTPS servers from option objects that don't disallow SSL v2, SSL v3, and TLS v1. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/disallow-old-tls-versions2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: disallow-old-tls-versions1\nPattern:\n$HTTPS.createServer(...).$FUNC(...);\n", "output": "Vulnerability rule: disallow-old-tls-versions1\nMessage: Detects direct creations of $HTTPS servers that don't disallow SSL v2, SSL v3, and TLS v1. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/disallow-old-tls-versions1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript, typescript\nSemgrep rule id: ftp-request\nPattern:\n$C.connect($OPTIONS,...);\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for lack of usage of the \"secure: true\" option when sending ftp requests through the nodejs ftp module. This leads to unencrypted traffic being sent to the ftp server. There are other options such as \"implicit\" that still does not encrypt all traffic. ftp is the most utilized npm ftp module.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): javascript\nSemgrep rule id: using-http-server\nPattern:\n$HTTP", "output": "Vulnerability rule: using-http-server\nMessage: Checks for any usage of http servers instead of https servers. Encourages the usage of https protocol instead of http, which does not have TLS and is therefore unencrypted. Using http can lead to man-in-the-middle attacks in which the attacker is able to read sensitive information.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: ['A02:2021 - Cryptographic Failures', 'A03:2017 - Sensitive Data Exposure']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/js-node/using-http-server.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: telnet-request\nPattern:\ntelnet.DialToAndCall(...)\n", "output": "Vulnerability rule: telnet-request\nMessage: Checks for attempts to connect to an insecure telnet server using the package telnet. This is bad because it can lead to man in the middle attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/telnet-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: bypass-tls-verification\nPattern:\ntls.Config{..., InsecureSkipVerify: true, ...}\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for disabling of TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: bypass-tls-verification\nPattern:\n$CONFIG = &tls.Config{...}\n...\n$CONFIG.InsecureSkipVerify = true\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for disabling of TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: http-customized-request\nPattern:\nhttp.NewRequest(..., \"=~/[hH][tT][tT][pP]://.*/\", ...)\n", "output": "Vulnerability rule: http-customized-request\nMessage: Checks for requests sent via http.NewRequest to http:// URLS. This is dangerous because the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, send requests only to https:// URLS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/http-customized-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\nftp.Dial(\"=~/^[fF][tT][pP]://.*/\", ...)\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\nftp.DialTimeout(\"=~/^[fF][tT][pP]://.*/\", ...)\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\nftp.Connect(\"=~/^[fF][tT][pP]://.*/\")\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\n$URL = \"=~/^[fF][tT][pP]://.*/\"\n...\nftp.Dial($URL, ...)\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\n$URL = \"=~/^[fF][tT][pP]://.*/\"\n...\nftp.DialTimeout($URL, ...)\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): go\nSemgrep rule id: ftp-request\nPattern:\n$URL = \"=~/^[fF][tT][pP]://.*/\"\n...\nftp.Connect($URL)\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers with the ftp package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/go-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: bypass-tls-verification\nPattern:\nnew HostnameVerifier() {\n  ...\n  public boolean verify(String hostname, SSLSession session) {\n    ...\n  }\n  ...\n};\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for redefinitions of functions that check TLS/SSL certificate verification. This can lead to vulnerabilities, as simple errors in the code can result in lack of proper certificate validation. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-spring/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: bypass-tls-verification\nPattern:\npublic RestTemplate restTemplate() throws KeyStoreException, NoSuchAlgorithmException, KeyManagementException {\n  ...\n  TrustStrategy $FUNCNAME = (X509Certificate[] chain, String authType) -> ...;\n  ...\n}\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for redefinitions of functions that check TLS/SSL certificate verification. This can lead to vulnerabilities, as simple errors in the code can result in lack of proper certificate validation. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-spring/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: bypass-tls-verification\nPattern:\nTrustStrategy $FUNCNAME= new TrustStrategy() {\n  ...\n  public boolean isTrusted(X509Certificate[] x509Certificates, String s) throws CertificateException {\n    ...\n  }\n  ...\n};\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for redefinitions of functions that check TLS/SSL certificate verification. This can lead to vulnerabilities, as simple errors in the code can result in lack of proper certificate validation. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-spring/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-ftp-request\nPattern:\n$SF = new DefaultFtpSessionFactory(...);\n...\n$SF.setHost(\"=~/^[fF][tT][pP]://.*/\");\n...\n$SF.$FUNC(...);\n", "output": "Vulnerability rule: spring-ftp-request\nMessage: Checks for outgoing connections to ftp servers via Spring plugin ftpSessionFactory. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-spring/spring-ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: spring-ftp-request\nPattern:\n$SF = new DefaultFtpSessionFactory(...);\n...\nString $URL = \"=~/^[fF][tT][pP]://.*/\";\n...\n$SF.setHost($URL);\n...\n$SF.$FUNC(...);\n", "output": "Vulnerability rule: spring-ftp-request\nMessage: Checks for outgoing connections to ftp servers via Spring plugin ftpSessionFactory. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-spring/spring-ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: http-components-request\nPattern:\n$HTTPCLIENT = HttpClients.$CREATE(...);\n...\n$HTTPREQ = new $HTTPFUNC(\"=~/[hH][tT][tT][pP]://.*/\");\n...\n$RESPONSE = $HTTPCLIENT.execute($HTTPREQ);\n", "output": "Vulnerability rule: http-components-request\nMessage: Checks for requests sent via Apache HTTP Components to http:// URLS. This is dangerous because the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, send requests only to https:// URLS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/http-components-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: http-components-request\nPattern:\n$HTTPCLIENT = HttpClients.$CREATE(...);\n...\n$RESPONSE = $HTTPCLIENT.execute(new $HTTPFUNC(\"=~/[hH][tT][tT][pP]://.*/\"));\n", "output": "Vulnerability rule: http-components-request\nMessage: Checks for requests sent via Apache HTTP Components to http:// URLS. This is dangerous because the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, send requests only to https:// URLS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/http-components-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: telnet-request\nPattern:\n$TELNETCLIENT = new TelnetClient(...);\n...\n$TELNETCLIENT.connect(...);\n", "output": "Vulnerability rule: telnet-request\nMessage: Checks for attempts to connect through telnet. This is insecure as the telnet protocol supports no encryption, and data passes through unencrypted.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/telnet-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unirest-http-request\nPattern:\nUnirest.get(\"=~/[hH][tT][tT][pP]://.*/\")\n", "output": "Vulnerability rule: unirest-http-request\nMessage: Checks for requests sent via Unirest to http:// URLS. This is dangerous because the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, send requests only to https:// URLS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/unirest-http-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: unirest-http-request\nPattern:\nUnirest.post(\"=~/[hH][tT][tT][pP]://.*/\")\n", "output": "Vulnerability rule: unirest-http-request\nMessage: Checks for requests sent via Unirest to http:// URLS. This is dangerous because the server is attempting to connect to a website that does not encrypt traffic with TLS. Instead, send requests only to https:// URLS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/unirest-http-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: socket-request\nPattern:\n$SOCKET = new Socket(\"=~/[tT][eE][lL][nN][eE][tT]://.*/\", ...);\n...\n$OUT = new PrintWriter($SOCKET.getOutputStream(...), ...);\n...\n$OUT.$FUNC(...);\n", "output": "Vulnerability rule: socket-request\nMessage: Insecure transport rules to catch socket connections to http, telnet, and ftp servers. This is dangerous because these are protocols that do not encrypt traffic.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/socket-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: socket-request\nPattern:\n$SOCKET = new Socket(\"=~/^[fF][tT][pP]://.*/\", ...);\n...\n$OUT = new PrintWriter($SOCKET.getOutputStream(...), ...);\n...\n$OUT.$FUNC(...);\n", "output": "Vulnerability rule: socket-request\nMessage: Insecure transport rules to catch socket connections to http, telnet, and ftp servers. This is dangerous because these are protocols that do not encrypt traffic.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/socket-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: socket-request\nPattern:\n$SOCKET = new Socket(\"=~/[hH][tT][tT][pP]://.*/\", ...);\n...\n$OUT = new PrintWriter($SOCKET.getOutputStream(...), ...);\n...\n$OUT.$FUNC(...);\n", "output": "Vulnerability rule: socket-request\nMessage: Insecure transport rules to catch socket connections to http, telnet, and ftp servers. This is dangerous because these are protocols that do not encrypt traffic.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/socket-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: bypass-tls-verification\nPattern:\nnew X509TrustManager() {\n  ...\n  public void checkClientTrusted(X509Certificate[] certs, String authType) {...}\n  ...\n}\n", "output": "Vulnerability rule: bypass-tls-verification\nMessage: Checks for redefinitions of the checkServerTrusted function in the X509TrustManager class that disables TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/bypass-tls-verification.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: disallow-old-tls-versions2\nPattern:\n$VALUE. ... .setProperty(\"jdk.tls.client.protocols\", \"$PATTERNS\");", "output": "Vulnerability rule: disallow-old-tls-versions2\nMessage: Detects setting client protocols to insecure versions of TLS and SSL. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/disallow-old-tls-versions2.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: disallow-old-tls-versions1\nPattern:\nnew SSLConnectionSocketFactory(...);\n", "output": "Vulnerability rule: disallow-old-tls-versions1\nMessage: Detects direct creations of SSLConnectionSocketFactories that don't disallow SSL v2, SSL v3, and TLS v1. SSLSocketFactory can be used to validate the identity of the HTTPS server against a list of trusted certificates. These protocols are deprecated due to POODLE, man in the middle attacks, and other vulnerabilities.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/disallow-old-tls-versions1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: httpget-http-request\nPattern:\n\"=~/[Hh][Tt][Tt][Pp]://.*/\"\n", "output": "Vulnerability rule: httpget-http-request\nMessage: Detected an HTTP request sent via HttpGet. This could lead to sensitive information being sent  over an insecure channel. Instead, it is recommended to send requests over HTTPS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/httpget-http-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: tls-renegotiation\nPattern:\njava.lang.System.setProperty(\"sun.security.ssl.allowUnsafeRenegotiation\", true);\n", "output": "Vulnerability rule: tls-renegotiation\nMessage: Checks for cases where java applications are allowing unsafe renegotiation. This leaves the application vulnerable to a man-in-the-middle attack where chosen plain text is injected as prefix to a TLS connection.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/tls-renegotiation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ftp-request\nPattern:\nFTPClient $FTPCLIENT = new FTPClient();\n...\n$FTPCLIENT.connect(...);\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: ftp-request\nPattern:\nURL $URL = new URL(\"=~/^[fF][tT][pP]://.*/\");\n...\nURLConnection $CONN = $URL.openConnection(...);\n", "output": "Vulnerability rule: ftp-request\nMessage: Checks for outgoing connections to ftp servers. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): java\nSemgrep rule id: httpurlconnection-http-request\nPattern:\n\"=~/[Hh][Tt][Tt][Pp]://.*/\"\n", "output": "Vulnerability rule: httpurlconnection-http-request\nMessage: Detected an HTTP request sent via HttpURLConnection. This could lead to sensitive information being sent over an insecure channel. Instead, it is recommended to send requests over HTTPS.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/java-stdlib/httpurlconnection-http-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: net-telnet-request\nPattern:\nNet::Telnet::new(...)\n", "output": "Vulnerability rule: net-telnet-request\nMessage: Checks for creation of telnet servers or attempts to connect through telnet. This is insecure as the telnet protocol supports no encryption, and data passes through unencrypted.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/net-telnet-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: net-telnet-request\nPattern:\nNet::SSH::Telnet.new(...)\n", "output": "Vulnerability rule: net-telnet-request\nMessage: Checks for creation of telnet servers or attempts to connect through telnet. This is insecure as the telnet protocol supports no encryption, and data passes through unencrypted.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/net-telnet-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: openuri-request\nPattern:\nURI.open('=~/[hH][tT][tT][pP]://.*/', ...)\n", "output": "Vulnerability rule: openuri-request\nMessage: Checks for requests to http and ftp (unencrypted) sites using OpenURI.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/openuri-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: openuri-request\nPattern:\n$URI = URI.parse('=~/[hH][tT][tT][pP]://.*/', ...)\n...\n$URI.open\n", "output": "Vulnerability rule: openuri-request\nMessage: Checks for requests to http and ftp (unencrypted) sites using OpenURI.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/openuri-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: openuri-request\nPattern:\nURI.open('=~/^[fF][tT][pP]://.*/', ...)\n", "output": "Vulnerability rule: openuri-request\nMessage: Checks for requests to http and ftp (unencrypted) sites using OpenURI.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/openuri-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: openuri-request\nPattern:\n$URI = URI.parse('=~/^[fF][tT][pP]://.*/', ...)\n...\n$URI.open\n", "output": "Vulnerability rule: openuri-request\nMessage: Checks for requests to http and ftp (unencrypted) sites using OpenURI.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/openuri-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: http-client-requests\nPattern:\nHTTParty.$PARTYVERB(\"=~/[hH][tT][tT][pP]://.*/\", ...)\n", "output": "Vulnerability rule: http-client-requests\nMessage: Checks for requests to http (unencrypted) sites using some of ruby's most popular REST/HTTP libraries, including httparty and restclient.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/http-client-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: http-client-requests\nPattern:\n$STRING = \"=~/[hH][tT][tT][pP]://.*/\"\n...\nHTTParty.$PARTYVERB($STRING, ...)\n", "output": "Vulnerability rule: http-client-requests\nMessage: Checks for requests to http (unencrypted) sites using some of ruby's most popular REST/HTTP libraries, including httparty and restclient.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/http-client-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: http-client-requests\nPattern:\nRestClient.$RESTVERB \"=~/[hH][tT][tT][pP]://.*/\", ...\n", "output": "Vulnerability rule: http-client-requests\nMessage: Checks for requests to http (unencrypted) sites using some of ruby's most popular REST/HTTP libraries, including httparty and restclient.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/http-client-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: http-client-requests\nPattern:\nRestClient::Request.execute(..., url: \"=~/[hH][tT][tT][pP]://.*/\", ...)\n", "output": "Vulnerability rule: http-client-requests\nMessage: Checks for requests to http (unencrypted) sites using some of ruby's most popular REST/HTTP libraries, including httparty and restclient.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/http-client-requests.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: net-ftp-request\nPattern:\n$FTP = Net::FTP.new('...')\n...\n$FTP.login\n", "output": "Vulnerability rule: net-ftp-request\nMessage: Checks for outgoing connections to ftp servers with the 'net/ftp' package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/net-ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: net-ftp-request\nPattern:\nNet::FTP.open('...') do |ftp|\n  ...\n  ftp.login\nend\n", "output": "Vulnerability rule: net-ftp-request\nMessage: Checks for outgoing connections to ftp servers with the 'net/ftp' package. FTP does not encrypt traffic, possibly leading to PII being sent plaintext over the network. Instead, connect via the SFTP protocol.\nSeverity: WARNING\nCWE: CWE-319: Cleartext Transmission of Sensitive Information\nOWASP: A03:2017 - Sensitive Data Exposure\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: problem-based-packs/insecure-transport/ruby-stdlib/net-ftp-request.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-strcat-fn\nPattern:\nstrcat(...)", "output": "Vulnerability rule: insecure-use-strcat-fn\nMessage: Finding triggers whenever there is a strcat or strncat used. This is an issue because strcat or strncat can lead to buffer overflow vulns. Fix this by using strcat_s instead.\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-strcat-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-strcat-fn\nPattern:\nstrncat(...)", "output": "Vulnerability rule: insecure-use-strcat-fn\nMessage: Finding triggers whenever there is a strcat or strncat used. This is an issue because strcat or strncat can lead to buffer overflow vulns. Fix this by using strcat_s instead.\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-strcat-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-strtok-fn\nPattern:\nstrtok(...)", "output": "Vulnerability rule: insecure-use-strtok-fn\nMessage: Avoid using 'strtok()'. This function directly modifies the first argument buffer, permanently erasing the delimiter character. Use 'strtok_r()' instead.\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-strtok-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: info-leak-on-non-formated-string\nPattern:\nprintf(argv[$NUM]);", "output": "Vulnerability rule: info-leak-on-non-formated-string\nMessage: Use %s, %d, %c... to format your variables, otherwise this could leak information.\nSeverity: WARNING\nCWE: ['CWE-532: Insertion of Sensitive Information into Log File']\nOWASP: ['A09:2021 - Security Logging and Monitoring Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/info-leak-on-non-formatted-string.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-memset\nPattern:\nmemset($...VARS)", "output": "Vulnerability rule: insecure-use-memset\nMessage: When handling sensitive information in a buffer, it's important to ensure  that the data is securely erased before the buffer is deleted or reused.  While `memset()` is commonly used for this purpose, it can leave sensitive  information behind due to compiler optimizations or other factors.  To avoid this potential vulnerability, it's recommended to use the  `memset_s()` function instead. `memset_s()` is a standardized function  that securely overwrites the memory with a specified value, making it more  difficult for an attacker to recover any sensitive data that was stored in  the buffer. By using `memset_s()` instead of `memset()`, you can help to  ensure that your application is more secure and less vulnerable to exploits  that rely on residual data in memory.\nSeverity: WARNING\nCWE: ['CWE-14: Compiler Removal of Code to Clear Buffers']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-memset.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-string-copy-fn\nPattern:\nstrcpy(...)", "output": "Vulnerability rule: insecure-use-string-copy-fn\nMessage: Finding triggers whenever there is a strcpy or strncpy used. This is an issue because strcpy does not affirm the size of the destination array and strncpy will not automatically NULL-terminate strings. This can lead to buffer overflows, which can cause program crashes and potentially let an attacker inject code in the program. Fix this by using strcpy_s instead (although note that strcpy_s is an optional part of the C11 standard, and so may not be available).\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-string-copy-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-string-copy-fn\nPattern:\nstrncpy(...)", "output": "Vulnerability rule: insecure-use-string-copy-fn\nMessage: Finding triggers whenever there is a strcpy or strncpy used. This is an issue because strcpy does not affirm the size of the destination array and strncpy will not automatically NULL-terminate strings. This can lead to buffer overflows, which can cause program crashes and potentially let an attacker inject code in the program. Fix this by using strcpy_s instead (although note that strcpy_s is an optional part of the C11 standard, and so may not be available).\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-string-copy-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-scanf-fn\nPattern:\nscanf(...)", "output": "Vulnerability rule: insecure-use-scanf-fn\nMessage: Avoid using 'scanf()'. This function, when used improperly, does not consider buffer boundaries and can lead to buffer overflows. Use 'fgets()' instead for reading input.\nSeverity: WARNING\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-scanf-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: insecure-use-gets-fn\nPattern:\ngets(...)", "output": "Vulnerability rule: insecure-use-gets-fn\nMessage: Avoid 'gets()'. This function does not consider buffer boundaries and can lead to buffer overflows. Use 'fgets()' or 'gets_s()' instead.\nSeverity: ERROR\nCWE: ['CWE-676: Use of Potentially Dangerous Function']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/security/insecure-use-gets-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: incorrect-use-ato-fn\nPattern:\natoi(...)", "output": "Vulnerability rule: incorrect-use-ato-fn\nMessage: Avoid the 'ato*()' family of functions. Their use can lead to undefined behavior, integer overflows, and lack of appropriate error handling. Instead prefer the 'strtol*()' family of functions.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/incorrect-use-ato-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: incorrect-use-ato-fn\nPattern:\natol(...)", "output": "Vulnerability rule: incorrect-use-ato-fn\nMessage: Avoid the 'ato*()' family of functions. Their use can lead to undefined behavior, integer overflows, and lack of appropriate error handling. Instead prefer the 'strtol*()' family of functions.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/incorrect-use-ato-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: incorrect-use-ato-fn\nPattern:\natoll(...)", "output": "Vulnerability rule: incorrect-use-ato-fn\nMessage: Avoid the 'ato*()' family of functions. Their use can lead to undefined behavior, integer overflows, and lack of appropriate error handling. Instead prefer the 'strtol*()' family of functions.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/incorrect-use-ato-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: incorrect-use-sscanf-fn\nPattern:\nsscanf($STR, $FMT, $PTR);", "output": "Vulnerability rule: incorrect-use-sscanf-fn\nMessage: Avoid 'sscanf()' for number conversions. Its use can lead to undefined behavior, slow processing, and integer overflows. Instead prefer the 'strto*()' family of functions.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/incorrect-use-sscanf-fn.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: double_goto\nPattern:\nif ($COND)\n  goto $FAIL;\n  goto $FAIL;\n", "output": "Vulnerability rule: double_goto\nMessage: The second goto statement will always be executed.\nSeverity: WARNING\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/goto-fail.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): c\nSemgrep rule id: c-string-equality\nPattern:\n(char *$X) == (char *$Y)", "output": "Vulnerability rule: c-string-equality\nMessage: Using == on char* performs pointer comparison, use strcmp instead\nSeverity: ERROR\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: c/lang/correctness/c-string-equality.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ruby-jwt-exposed-credentials\nPattern:\n$PAYLOAD = {...,password:...,...}\n...\nJWT.encode($PAYLOAD,...)\n", "output": "Vulnerability rule: ruby-jwt-exposed-credentials\nMessage: Password is exposed through JWT token payload. This is not encrypted and the password could be compromised. Do not store passwords in JWT tokens.\nSeverity: ERROR\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/jwt/security/jwt-exposed-credentials.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ruby-jwt-none-alg\nPattern:\nJWT.encode($PAYLOAD, $SECRET, 'none', ...)\n", "output": "Vulnerability rule: ruby-jwt-none-alg\nMessage: Detected use of the 'none' algorithm in a JWT token. The 'none' algorithm assumes the integrity of the token has already been verified. This would allow a malicious actor to forge a JWT token that will automatically be verified. Do not explicitly use the 'none' algorithm. Instead, use an algorithm such as 'HS256'.\nSeverity: ERROR\nCWE: ['CWE-327: Use of a Broken or Risky Cryptographic Algorithm']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/jwt/security/jwt-none-alg.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ruby-jwt-decode-without-verify\nPattern:\nJWT.decode($PAYLOAD,$SECRET,false,...)", "output": "Vulnerability rule: ruby-jwt-decode-without-verify\nMessage: Detected the decoding of a JWT token without a verify step. JWT tokens must be verified before use, otherwise the token's integrity is unknown. This means a malicious actor could forge a JWT token with any claims.\nSeverity: WARNING\nCWE: ['CWE-345: Insufficient Verification of Data Authenticity']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/jwt/security/audit/jwt-decode-without-verify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ruby-jwt-exposed-data\nPattern:\nJWT.encode($INPUT,...)\n", "output": "Vulnerability rule: ruby-jwt-exposed-data\nMessage: The object is passed strictly to jsonwebtoken.sign(...) Make sure that sensitive information is not exposed through JWT token payload.\nSeverity: WARNING\nCWE: ['CWE-522: Insufficiently Protected Credentials']\nOWASP: ['A02:2017 - Broken Authentication', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/jwt/security/audit/jwt-exposed-data.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ssl-mode-no-verify\nPattern:\nOpenSSL::SSL::VERIFY_NONE", "output": "Vulnerability rule: ssl-mode-no-verify\nMessage: Detected SSL that will accept an unverified connection. This makes the connections susceptible to man-in-the-middle attacks. Use 'OpenSSL::SSL::VERIFY_PEER' instead.\nSeverity: WARNING\nCWE: ['CWE-295: Improper Certificate Validation']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A07:2021 - Identification and Authentication Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/ssl-mode-no-verify.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: dangerous-open3-pipeline\nPattern:\nOpen3.$PIPE(...)\n", "output": "Vulnerability rule: dangerous-open3-pipeline\nMessage: Detected non-static command inside $PIPE. Audit the input to '$PIPE'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/dangerous-open3-pipeline.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attributes-attr-accessible\nPattern:\nclass $CLASS < $TYPE\n...\nend\n...\n$CLASS.$FUNC(...)\n", "output": "Vulnerability rule: model-attributes-attr-accessible\nMessage: Checks for models that do not use attr_accessible. This means there is no limiting of which variables can be manipulated through mass assignment. For newer Rails applications, parameters should be allowlisted using strong parameters. For older Rails versions, they should be allowlisted using strong_attributes.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attributes-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: dangerous-open\nPattern:\nopen($CMD,...)\n", "output": "Vulnerability rule: dangerous-open\nMessage: Detected non-static command inside 'open'. Audit the input to 'open'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/dangerous-open.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: cookie-serialization\nPattern:\nRails.application.config.action_dispatch.cookies_serializer = :marshal\n", "output": "Vulnerability rule: cookie-serialization\nMessage: Checks if code allows cookies to be deserialized using Marshal. If the attacker can craft a valid cookie, this could lead to remote code execution. The hybrid check is just to warn users to migrate to :json for best practice.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/cookie-serialization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: cookie-serialization\nPattern:\nRails.application.config.action_dispatch.cookies_serializer = :hybrid\n", "output": "Vulnerability rule: cookie-serialization\nMessage: Checks if code allows cookies to be deserialized using Marshal. If the attacker can craft a valid cookie, this could lead to remote code execution. The hybrid check is just to warn users to migrate to :json for best practice.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/cookie-serialization.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: create-with\nPattern:\n$FUNC.create_with($PARAMSA)\n", "output": "Vulnerability rule: create-with\nMessage: Checks for strong parameter bypass through usage of create_with. Create_with bypasses strong parameter protection, which could allow attackers to set arbitrary attributes on models. To fix this vulnerability, either remove all create_with calls or use the permit function to specify tags that are allowed to be set.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/create-with.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: filter-skipping\nPattern:\n$CALL \"=~/.*(/:action.*).*/\"\n", "output": "Vulnerability rule: filter-skipping\nMessage: Checks for use of action in Ruby routes. This can cause Rails to render an arbitrary view if an attacker creates an URL accurately. Affects 3.0 applications. Can avoid the vulnerability by providing additional constraints.\nSeverity: ERROR\nCWE: ['CWE-1021: Improper Restriction of Rendered UI Layers or Frames']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/filter-skipping.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: bad-deserialization-yaml\nPattern:\nYAML.load($...ARGS)\n", "output": "Vulnerability rule: bad-deserialization-yaml\nMessage: Unsafe deserialization from YAML. Objects in Ruby can be serialized into strings, then later loaded from strings. However, uses of load and object_load can cause remote code execution. Loading user input with YAML can potentially be dangerous. Use JSON in a secure fashion instead. However, loading YAML from a static file is not dangerous and should not be flagged.\nSeverity: ERROR\nCWE: ['CWE-502: Deserialization of Untrusted Data']\nOWASP: ['A08:2017 - Insecure Deserialization', 'A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/bad-deserialization-yaml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: missing-csrf-protection\nPattern:\nclass $CONTROLLER < ActionController::Base\n  ...\nend\n", "output": "Vulnerability rule: missing-csrf-protection\nMessage: Detected controller which does not enable cross-site request forgery protections using 'protect_from_forgery'. Add 'protect_from_forgery :with => :exception' to your controller class.\nSeverity: ERROR\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/missing-csrf-protection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: dangerous-syscall\nPattern:\nsyscall\n", "output": "Vulnerability rule: dangerous-syscall\nMessage: 'syscall' is essentially unsafe and unportable. The DL (https://apidock.com/ruby/Fiddle) library is preferred for safer and a bit more portable programming.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/dangerous-syscall.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\n....permit(..., :admin, ...)\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\n....permit(..., :role, ...)\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\n....permit(..., :banned, ...)\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\n....permit(..., :account_id, ...)\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\nattr_accessible ..., :admin, ...\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\nattr_accessible ..., :role, ...\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\nattr_accessible ..., :banned, ...\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\nattr_accessible ..., :account_id, ...\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: model-attr-accessible\nPattern:\nparams.permit!\n", "output": "Vulnerability rule: model-attr-accessible\nMessage: Checks for dangerous permitted attributes that can lead to mass assignment vulnerabilities. Query parameters allowed using permit and attr_accessible are checked for allowance of dangerous attributes admin, banned, role, and account_id. Also checks for usages of params.permit!, which allows everything. Fix: don't allow admin, banned, role, and account_id using permit or attr_accessible.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/model-attr-accessible.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: force-ssl-false\nPattern:\nconfig.force_ssl = false", "output": "Vulnerability rule: force-ssl-false\nMessage: Checks for configuration setting of force_ssl to false. Force_ssl forces usage of HTTPS, which could lead to network interception of unencrypted application traffic. To fix, set config.force_ssl = true.\nSeverity: WARNING\nCWE: ['CWE-311: Missing Encryption of Sensitive Data']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/force-ssl-false.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: mass-assignment-protection-disabled\nPattern:\n$MODEL.new(params[...], ..., :without_protection => true, ...)", "output": "Vulnerability rule: mass-assignment-protection-disabled\nMessage: Mass assignment protection disabled for '$MODEL'. This could permit assignment to sensitive model fields without intention. Instead, use 'attr_accessible' for the model or disable mass assigment using 'config.active_record.whitelist_attributes = true'. ':without_protection => true' must be removed for this to take effect.\nSeverity: WARNING\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/mass-assignment-protection-disabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nDigest::MD5.base64digest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nDigest::MD5.hexdigest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nDigest::MD5.digest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nDigest::MD5.new", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nOpenSSL::Digest::MD5.base64digest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nOpenSSL::Digest::MD5.hexdigest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nOpenSSL::Digest::MD5.digest $X", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-md5\nPattern:\nOpenSSL::Digest::MD5.new", "output": "Vulnerability rule: weak-hashes-md5\nMessage: Should not use md5 to generate hashes. md5 is proven to be vulnerable through the use of brute-force attacks. Could also result in collisions, leading to potential collision attacks. Use SHA256 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-md5.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-sha1\nPattern:\nDigest::SHA1.$FUNC", "output": "Vulnerability rule: weak-hashes-sha1\nMessage: Should not use SHA1 to generate hashes. There is a proven SHA1 hash collision by Google, which could lead to vulnerabilities. Use SHA256, SHA3 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-sha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-sha1\nPattern:\nOpenSSL::Digest::SHA1.$FUNC", "output": "Vulnerability rule: weak-hashes-sha1\nMessage: Should not use SHA1 to generate hashes. There is a proven SHA1 hash collision by Google, which could lead to vulnerabilities. Use SHA256, SHA3 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-sha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: weak-hashes-sha1\nPattern:\nOpenSSL::HMAC.$FUNC(\"sha1\",...)", "output": "Vulnerability rule: weak-hashes-sha1\nMessage: Should not use SHA1 to generate hashes. There is a proven SHA1 hash collision by Google, which could lead to vulnerabilities. Use SHA256, SHA3 or other hashing functions instead.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/weak-hashes-sha1.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: bad-send\nPattern:\n$PARAM = params[...]\n...\n$RES = $MOD.send($PARAM.$FUNC)\n", "output": "Vulnerability rule: bad-send\nMessage: Checks for unsafe use of Object#send, try, __send__, and public_send. These only account for unsafe use of a method, not target. This can lead to arbitrary calling of exit, along with arbitrary code execution. Please be sure to sanitize input in order to avoid this.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/no-send.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: bad-send\nPattern:\n$PARAM = params[...]\n...\n$RES = $MOD.try($PARAM.$FUNC)\n", "output": "Vulnerability rule: bad-send\nMessage: Checks for unsafe use of Object#send, try, __send__, and public_send. These only account for unsafe use of a method, not target. This can lead to arbitrary calling of exit, along with arbitrary code execution. Please be sure to sanitize input in order to avoid this.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/no-send.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: bad-send\nPattern:\n$PARAM = params[...]\n...\n$RES = $MOD.__send__($PARAM.$FUNC)\n", "output": "Vulnerability rule: bad-send\nMessage: Checks for unsafe use of Object#send, try, __send__, and public_send. These only account for unsafe use of a method, not target. This can lead to arbitrary calling of exit, along with arbitrary code execution. Please be sure to sanitize input in order to avoid this.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/no-send.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: bad-send\nPattern:\n$PARAM = params[...]\n...\n$RES = $MOD.public_send($PARAM.$FUNC)", "output": "Vulnerability rule: bad-send\nMessage: Checks for unsafe use of Object#send, try, __send__, and public_send. These only account for unsafe use of a method, not target. This can lead to arbitrary calling of exit, along with arbitrary code execution. Please be sure to sanitize input in order to avoid this.\nSeverity: ERROR\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/no-send.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: file-disclosure\nPattern:\nconfig.serve_static_assets = true", "output": "Vulnerability rule: file-disclosure\nMessage: Special requests can determine whether a file exists on a filesystem that's outside the Rails app's root directory. To fix this, set config.serve_static_assets = false.\nSeverity: ERROR\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/file-disclosure.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: dangerous-subshell\nPattern:\n`...#{$VAL}...`\n", "output": "Vulnerability rule: dangerous-subshell\nMessage: Detected non-static command inside `...`. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.\nSeverity: WARNING\nCWE: [\"CWE-94: Improper Control of Generation of Code ('Code Injection')\"]\nOWASP: ['A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/dangerous-subshell.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: json-entity-escape\nPattern:\nActiveSupport.escape_html_entities_in_json = false\n", "output": "Vulnerability rule: json-entity-escape\nMessage: Checks if HTML escaping is globally disabled for JSON output. This could lead to XSS.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/json-entity-escape.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: json-entity-escape\nPattern:\nconfig.active_support.escape_html_entities_in_json = false\n", "output": "Vulnerability rule: json-entity-escape\nMessage: Checks if HTML escaping is globally disabled for JSON output. This could lead to XSS.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/json-entity-escape.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: sha224-hash\nPattern:\nDigest::SHA224.$FUNC", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: sha224-hash\nPattern:\nOpenSSL::Digest::SHA224.$FUNC", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: sha224-hash\nPattern:\nSHA3::Digest::SHA224(...)", "output": "Vulnerability rule: sha224-hash\nMessage: This code uses a 224-bit hash function, which is deprecated or disallowed in some security policies. Consider updating to a stronger hash function such as SHA-384 or higher to ensure compliance and security.\nSeverity: WARNING\nCWE: ['CWE-328: Use of Weak Hash']\nOWASP: ['A03:2017 - Sensitive Data Exposure', 'A02:2021 - Cryptographic Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/lang/security/audit/sha224-hash.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: check-reverse-tabnabbing\nPattern:\n_blank\n", "output": "Vulnerability rule: check-reverse-tabnabbing\nMessage: Setting an anchor target of `_blank` without the `noopener` or `noreferrer` attribute allows reverse tabnabbing on Internet Explorer, Opera, and Android Webview.\nSeverity: WARNING\nCWE: ['CWE-1022: Use of Web Link to Untrusted Target with window.opener Access']\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-reverse-tabnabbing.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: check-dynamic-render-local-file-include\nPattern:\nparams[...]\n", "output": "Vulnerability rule: check-dynamic-render-local-file-include\nMessage: Found request parameters in a call to `render` in a dynamic context. This can allow end users to request arbitrary local files which may result in leaking sensitive information persisted on disk.\nSeverity: WARNING\nCWE: [\"CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')\"]\nOWASP: ['A05:2017 - Broken Access Control', 'A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-dynamic-render-local-file-include.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: check-permit-attributes-medium\nPattern:\n$P.permit($ATTRIBUTE)", "output": "Vulnerability rule: check-permit-attributes-medium\nMessage: Calling `permit` on security-critical properties like `$ATTRIBUTE` may leave your application vulnerable to mass assignment.\nSeverity: WARNING\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-permit-attributes-medium.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: check-secrets\nPattern:\n$VAR = \"$VALUE\"", "output": "Vulnerability rule: check-secrets\nMessage: Found a Brakeman-style secret - a variable with the name password/secret/api_key/rest_auth_site_key and a non-empty string literal value.\nSeverity: WARNING\nCWE: ['CWE-200: Exposure of Sensitive Information to an Unauthorized Actor']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-secrets.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): yaml\nSemgrep rule id: check-rails-secret-yaml\nPattern:\nsecret_key_base: $VALUE\n", "output": "Vulnerability rule: check-rails-secret-yaml\nMessage: $VALUE Found a string literal assignment to a production Rails session secret in `secrets.yaml`. Do not commit secret values to source control! Any user in possession of this value may falsify arbitrary session data in your application. Read this value from an environment variable, KMS, or file on disk outside of source control.\nSeverity: WARNING\nCWE: ['CWE-540: Inclusion of Sensitive Information in Source Code']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-rails-secret-yaml.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: check-http-verb-confusion\nPattern:\nif request.get?\n  ...\nelse\n  ...\nend\n", "output": "Vulnerability rule: check-http-verb-confusion\nMessage: Found an improperly constructed control flow block with `request.get?`. Rails will route HEAD requests as GET requests but they will fail the `request.get?` check, potentially causing unexpected behavior unless an `elif` condition is used.\nSeverity: ERROR\nCWE: ['CWE-650: Trusting HTTP Permission Methods on the Server Side']\nOWASP: ['A04:2021 - Insecure Design']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-http-verb-confusion.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: check-permit-attributes-high\nPattern:\n$P.permit($ATTRIBUTE)", "output": "Vulnerability rule: check-permit-attributes-high\nMessage: Calling `permit` on security-critical properties like `$ATTRIBUTE` may leave your application vulnerable to mass assignment.\nSeverity: ERROR\nCWE: ['CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes']\nOWASP: ['A08:2021 - Software and Data Integrity Failures']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/brakeman/check-permit-attributes-high.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: rails-skip-forgery-protection\nPattern:\nskip_forgery_protection", "output": "Vulnerability rule: rails-skip-forgery-protection\nMessage: This call turns off CSRF protection allowing CSRF attacks against the application\nSeverity: WARNING\nCWE: ['CWE-352: Cross-Site Request Forgery (CSRF)']\nOWASP: ['A01:2021 - Broken Access Control']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/rails-skip-forgery-protection.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: libxml-backend\nPattern:\nActiveSupport::XmlMini.backend = \"LibXML\"", "output": "Vulnerability rule: libxml-backend\nMessage: This application is using LibXML as the XML backend. LibXML can be vulnerable to XML External Entities (XXE) vulnerabilities. Use the built-in Rails XML parser, REXML, instead.\nSeverity: WARNING\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xxe/libxml-backend.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: xml-external-entities-enabled\nPattern:\nXML.default_substitute_entities = true", "output": "Vulnerability rule: xml-external-entities-enabled\nMessage: This application is explicitly enabling external entities enabling an attacker to inject malicious XML to exploit an XML External Entities (XXE) vulnerability. This could let the attacker cause a denial-of-service by forcing the parser to parse large files, or at worst, let the attacker download sensitive files or user data. Use the built-in Rails XML parser, REXML, instead.\nSeverity: ERROR\nCWE: ['CWE-611: Improper Restriction of XML External Entity Reference']\nOWASP: ['A04:2017 - XML External Entities (XXE)', 'A05:2021 - Security Misconfiguration']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xxe/xml-external-entities-enabled.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-render-text\nPattern:\nrender text: ...", "output": "Vulnerability rule: avoid-render-text\nMessage: 'render text: ...' actually sets the content-type to 'text/html'. If external data can reach here, this exposes your application to cross-site scripting (XSS) attacks. Instead, use 'render plain: ...' to render non-HTML text.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-render-text.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-render-inline\nPattern:\nrender inline: ...", "output": "Vulnerability rule: avoid-render-inline\nMessage: 'render inline: ...' renders an entire ERB template inline and is dangerous. If external data can reach here, this exposes your application to server-side template injection (SSTI) or cross-site scripting (XSS) attacks. Instead, consider using a partial or another safe rendering method.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-render-inline.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-raw\nPattern:\nraw(...)", "output": "Vulnerability rule: avoid-raw\nMessage: 'raw()' bypasses HTML escaping. If external data can reach here, this exposes your application to cross-site scripting (XSS) attacks. If you must do this, construct individual strings and mark them as safe for HTML rendering with `html_safe()`.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-raw.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-html-safe\nPattern:\n$STR.html_safe", "output": "Vulnerability rule: avoid-html-safe\nMessage: 'html_safe()' does not make the supplied string safe. 'html_safe()' bypasses HTML escaping. If external data can reach here, this exposes your application to cross-site scripting (XSS) attacks. Ensure no external data reaches here.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-html-safe\nPattern:\n$STR.html_safe.$MORE", "output": "Vulnerability rule: avoid-html-safe\nMessage: 'html_safe()' does not make the supplied string safe. 'html_safe()' bypasses HTML escaping. If external data can reach here, this exposes your application to cross-site scripting (XSS) attacks. Ensure no external data reaches here.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: manual-template-creation\nPattern:\nERB.new(...)", "output": "Vulnerability rule: manual-template-creation\nMessage: Detected manual creation of an ERB template. Manual creation of templates may expose your application to server-side template injection (SSTI) or cross-site scripting (XSS) attacks if user input is used to create the template. Instead, create a '.erb' template file and use 'render'.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/manual-template-creation.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: avoid-content-tag\nPattern:\ncontent_tag(...)", "output": "Vulnerability rule: avoid-content-tag\nMessage: 'content_tag()' bypasses HTML escaping for some portion of the content. If external data can reach here, this exposes your application to cross-site scripting (XSS) attacks. Ensure no external data reaches here. If you must do this, create your HTML manually and use 'html_safe'. Ensure no external data enters the HTML-safe string!\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/avoid-content-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-script-tag\nPattern:\n<%= ... >", "output": "Vulnerability rule: var-in-script-tag\nMessage: Detected a template variable used in a script tag. Although template variables are HTML escaped, HTML escaping does not always prevent cross-site scripting (XSS) attacks when used directly in JavaScript. If you need to do this, use `escape_javascript` or its alias, `j`. However, this will not protect from XSS in all circumstances; see the references for more information. Consider placing this value in the HTML portion (outside of a script tag).\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/var-in-script-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: unquoted-attribute\nPattern:\n<%= ... %>", "output": "Vulnerability rule: unquoted-attribute\nMessage: Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: \"<%= expr %>\".\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/unquoted-attribute.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: avoid-raw\nPattern:\nraw", "output": "Vulnerability rule: avoid-raw\nMessage: 'raw' renders raw HTML, as the name implies. This means that normal HTML escaping is bypassed. If user data can be controlled here, this exposes your application to cross-site scripting (XSS). If you need to do this, be sure to correctly sanitize the data using a library such as DOMPurify.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/avoid-raw.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: dangerous-link-to\nPattern:\nlink_to ... @$VAR", "output": "Vulnerability rule: dangerous-link-to\nMessage: Detected a template variable used in 'link_to'. This will generate dynamic data in the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: 'link_to \"Here\", \"/\"+@link'. You may also consider setting the Content Security Policy (CSP) header.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/dangerous-link-to.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: avoid-html-safe\nPattern:\n$SOMETHING.html_safe", "output": "Vulnerability rule: avoid-html-safe\nMessage: 'html_safe' renders raw HTML. This means that normal HTML escaping is bypassed. If user data can be controlled here, this exposes your application to cross-site scripting (XSS). If you need to do this, be sure to correctly sanitize the data using a library such as DOMPurify.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/avoid-html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-href\nPattern:\n<a ... href = \"<%= ... %>\" ... >", "output": "Vulnerability rule: var-in-href\nMessage: Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: href='/<%= link =>'. You may also consider setting the Content Security Policy (CSP) header.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/var-in-href.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: var-in-href\nPattern:\n<a ... href = '<%= ... %>' ... >", "output": "Vulnerability rule: var-in-href\nMessage: Detected a template variable used in an anchor tag with the 'href' attribute. This allows a malicious actor to input the 'javascript:' URI and is subject to cross- site scripting (XSS) attacks. If using a relative URL, start with a literal forward slash and concatenate the URL, like this: href='/<%= link =>'. You may also consider setting the Content Security Policy (CSP) header.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/var-in-href.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: alias-for-html-safe\nPattern:\n<%== ... %>", "output": "Vulnerability rule: alias-for-html-safe\nMessage: The syntax `<%== ... %>` is an alias for `html_safe`. This means the content inside these tags will be rendered as raw HTML. This may expose your application to cross-site scripting. If you need raw HTML, prefer using the more explicit `html_safe` and be sure to correctly sanitize variables using a library such as DOMPurify.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/alias-for-html-safe.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): generic\nSemgrep rule id: avoid-content-tag\nPattern:\ncontent_tag", "output": "Vulnerability rule: avoid-content-tag\nMessage: 'content_tag' exhibits unintuitive escaping behavior and may accidentally expose your application to cross-site scripting. If using Rails 2, only attribute values are escaped. If using Rails 3, content and attribute values are escaped. Tag and attribute names are never escaped. Because of this, it is recommended to use 'html_safe' if you must render raw HTML data.\nSeverity: WARNING\nCWE: [\"CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\"]\nOWASP: ['A07:2017 - Cross-Site Scripting (XSS)', 'A03:2021 - Injection']\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/security/audit/xss/templates/avoid-content-tag.yaml"}
{"instruction": "You are a secure code reviewer. Identify and explain any security vulnerabilities in the given code pattern.", "input": "Language(s): ruby\nSemgrep rule id: ruby-rails-performance-indexes-are-beneficial\nPattern:\nadd_column $TABLE, $COLUMN, $TYPE, ...\n", "output": "Vulnerability rule: ruby-rails-performance-indexes-are-beneficial\nMessage: The $COLUMN column appears to be a foreign key. Would it benefit from an index? Having an index can improve performance.\nSeverity: INFO\nCWE: Unknown\nOWASP: Unknown\nExplanation: This pattern is associated with a potential security issue. Describe how the vulnerability may occur and how to fix it.\nSource rule file: ruby/rails/performance/ruby-rails-performance-indexes-are-really-beneficial.yaml"}
